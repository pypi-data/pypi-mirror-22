<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>View helpers &mdash; coaster 0.5.0-dev documentation</title>
    
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.5.0-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="coaster 0.5.0-dev documentation" href="index.html" />
    <link rel="next" title="SQLAlchemy patterns" href="sqlalchemy.html" />
    <link rel="prev" title="Assets" href="assets.html" />
   
  
  <link media="only screen and (max-device-width: 480px)" href="_static/small_flask.css" type= "text/css" rel="stylesheet" />

  </head>
  <body role="document">
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sqlalchemy.html" title="SQLAlchemy patterns"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="assets.html" title="Assets"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">coaster 0.5.0-dev documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="view-helpers">
<h1>View helpers<a class="headerlink" href="#view-helpers" title="Permalink to this headline">¶</a></h1>
<p>Coaster provides functions and decorators for common scenarios in view handlers.</p>
<span class="target" id="module-coaster.views"></span><dl class="exception">
<dt id="coaster.views.RequestTypeError">
<em class="property">exception </em><code class="descclassname">coaster.views.</code><code class="descname">RequestTypeError</code><span class="sig-paren">(</span><em>description=None</em>, <em>response=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coaster/views.html#RequestTypeError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coaster.views.RequestTypeError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception that combines TypeError with BadRequest. Used by <a class="reference internal" href="#coaster.views.requestargs" title="coaster.views.requestargs"><code class="xref py py-func docutils literal"><span class="pre">requestargs()</span></code></a>.</p>
</dd></dl>

<dl class="exception">
<dt id="coaster.views.RequestValueError">
<em class="property">exception </em><code class="descclassname">coaster.views.</code><code class="descname">RequestValueError</code><span class="sig-paren">(</span><em>description=None</em>, <em>response=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coaster/views.html#RequestValueError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coaster.views.RequestValueError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception that combines ValueError with BadRequest. Used by <a class="reference internal" href="#coaster.views.requestargs" title="coaster.views.requestargs"><code class="xref py py-func docutils literal"><span class="pre">requestargs()</span></code></a>.</p>
</dd></dl>

<dl class="function">
<dt id="coaster.views.get_current_url">
<code class="descclassname">coaster.views.</code><code class="descname">get_current_url</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/coaster/views.html#get_current_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coaster.views.get_current_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current URL including the query string as a relative path. If the app uses subdomains,
return an absolute path</p>
</dd></dl>

<dl class="function">
<dt id="coaster.views.get_next_url">
<code class="descclassname">coaster.views.</code><code class="descname">get_next_url</code><span class="sig-paren">(</span><em>referrer=False</em>, <em>external=False</em>, <em>session=False</em>, <em>default=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coaster/views.html#get_next_url"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coaster.views.get_next_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the next URL to redirect to. Don&#8217;t return external URLs unless
explicitly asked for. This is to protect the site from being an unwitting
redirector to external URLs. Subdomains are okay, however.</p>
<p>This function looks for a <code class="docutils literal"><span class="pre">next</span></code> parameter in the request or in the session
(depending on whether parameter <code class="docutils literal"><span class="pre">session</span></code> is True). If no <code class="docutils literal"><span class="pre">next</span></code> is present,
it checks the referrer (if enabled), and finally returns either the provided
default (which can be any value including <code class="docutils literal"><span class="pre">None</span></code>) or <code class="docutils literal"><span class="pre">url_for('index')</span></code>.
If your app does not have a URL endpoint named <code class="docutils literal"><span class="pre">index</span></code>, <code class="docutils literal"><span class="pre">/</span></code> is returned.</p>
</dd></dl>

<dl class="function">
<dt id="coaster.views.jsonp">
<code class="descclassname">coaster.views.</code><code class="descname">jsonp</code><span class="sig-paren">(</span><em>*args</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coaster/views.html#jsonp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coaster.views.jsonp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a JSON response with a callback wrapper, if asked for.</p>
</dd></dl>

<dl class="function">
<dt id="coaster.views.load_model">
<code class="descclassname">coaster.views.</code><code class="descname">load_model</code><span class="sig-paren">(</span><em>model</em>, <em>attributes=None</em>, <em>parameter=None</em>, <em>workflow=False</em>, <em>kwargs=False</em>, <em>permission=None</em>, <em>addlperms=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coaster/views.html#load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coaster.views.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to load a model given a query parameter.</p>
<p>Typical usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&lt;profile&gt;&#39;</span><span class="p">)</span>
<span class="nd">@load_model</span><span class="p">(</span><span class="n">Profile</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;profile&#39;</span><span class="p">},</span> <span class="s">&#39;profileob&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">profile_view</span><span class="p">(</span><span class="n">profileob</span><span class="p">):</span>
    <span class="c"># &#39;profileob&#39; is now a Profile model instance. The load_model decorator replaced this:</span>
    <span class="c"># profileob = Profile.query.filter_by(name=profile).first_or_404()</span>
    <span class="k">return</span> <span class="s">&quot;Hello, </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">profileob</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<p>Using the same name for request and parameter makes code easier to understand:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&lt;profile&gt;&#39;</span><span class="p">)</span>
<span class="nd">@load_model</span><span class="p">(</span><span class="n">Profile</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;profile&#39;</span><span class="p">},</span> <span class="s">&#39;profile&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">profile_view</span><span class="p">(</span><span class="n">profile</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&quot;Hello, </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">profile</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">load_model</span></code> aborts with a 404 if no instance is found. <code class="docutils literal"><span class="pre">load_model</span></code> also
recognizes queries to <code class="docutils literal"><span class="pre">url_name</span></code> of <a class="reference internal" href="sqlalchemy.html#coaster.sqlalchemy.BaseIdNameMixin" title="coaster.sqlalchemy.BaseIdNameMixin"><code class="xref py py-class docutils literal"><span class="pre">BaseIdNameMixin</span></code></a>
instances and will automatically load the model. TODO: that should be handled by
the model, not here.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> &#8211; The SQLAlchemy model to query. Must contain a <code class="docutils literal"><span class="pre">query</span></code> object
(which is the default with Flask-SQLAlchemy)</li>
<li><strong>attributes</strong> &#8211; A dict of attributes (from the URL request) that will be
used to query for the object. For each key:value pair, the key is the name of
the column on the model and the value is the name of the request parameter that
contains the data</li>
<li><strong>parameter</strong> &#8211; The name of the parameter to the decorated function via which
the result is passed. Usually the same as the attribute. If the parameter name
is prefixed with &#8216;g.&#8217;, the parameter is also made available as g.&lt;parameter&gt;</li>
<li><strong>workflow</strong> &#8211; If True, the method <code class="docutils literal"><span class="pre">workflow()</span></code> of the instance is
called and the resulting workflow object is passed to the decorated
function instead of the instance itself</li>
<li><strong>kwargs</strong> &#8211; If True, the original request parameters are passed to the decorated
function as a <code class="docutils literal"><span class="pre">kwargs</span></code> parameter</li>
<li><strong>permission</strong> &#8211; If present, <code class="docutils literal"><span class="pre">load_model</span></code> calls the
<a class="reference internal" href="sqlalchemy.html#coaster.sqlalchemy.PermissionMixin.permissions" title="coaster.sqlalchemy.PermissionMixin.permissions"><code class="xref py py-meth docutils literal"><span class="pre">permissions()</span></code></a> method of the
retrieved object with <code class="docutils literal"><span class="pre">g.user</span></code> as a parameter. If <code class="docutils literal"><span class="pre">permission</span></code> is not
present in the result, <code class="docutils literal"><span class="pre">load_model</span></code> aborts with a 403. <code class="docutils literal"><span class="pre">g</span></code> is the Flask
request context object and you are expected to setup a request environment
in which <code class="docutils literal"><span class="pre">g.user</span></code> is the currently logged in user. Flask-Lastuser does this
automatically for you. The permission may be a string or a list of strings,
in which case access is allowed if any of the listed permissions are available</li>
<li><strong>addlperms</strong> &#8211; Iterable or callable that returns an iterable containing additional
permissions available to the user, apart from those granted by the models. In an app
that uses Lastuser for authentication, passing <code class="docutils literal"><span class="pre">lastuser.permissions</span></code> will pass
through permissions granted via Lastuser</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coaster.views.load_models">
<code class="descclassname">coaster.views.</code><code class="descname">load_models</code><span class="sig-paren">(</span><em>*chain</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coaster/views.html#load_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coaster.views.load_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to load a chain of models from the given parameters. This works just like
<a class="reference internal" href="#coaster.views.load_model" title="coaster.views.load_model"><code class="xref py py-func docutils literal"><span class="pre">load_model()</span></code></a> and accepts the same parameters, with some small differences.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>chain</strong> &#8211; The chain is a list of tuples of (<code class="docutils literal"><span class="pre">model</span></code>, <code class="docutils literal"><span class="pre">attributes</span></code>, <code class="docutils literal"><span class="pre">parameter</span></code>).
Lists and tuples can be used interchangeably. All retrieved instances are passed as
parameters to the decorated function</li>
<li><strong>workflow</strong> &#8211; Like with <a class="reference internal" href="#coaster.views.load_model" title="coaster.views.load_model"><code class="xref py py-func docutils literal"><span class="pre">load_model()</span></code></a>, <code class="docutils literal"><span class="pre">workflow()</span></code> is called on the last
instance in the chain, and <em>only</em> the resulting workflow object is passed to the
decorated function</li>
<li><strong>permission</strong> &#8211; Same as in <a class="reference internal" href="#coaster.views.load_model" title="coaster.views.load_model"><code class="xref py py-func docutils literal"><span class="pre">load_model()</span></code></a>, except
<a class="reference internal" href="sqlalchemy.html#coaster.sqlalchemy.PermissionMixin.permissions" title="coaster.sqlalchemy.PermissionMixin.permissions"><code class="xref py py-meth docutils literal"><span class="pre">permissions()</span></code></a> is called on every instance
in the chain and the retrieved permissions are passed as the second parameter to the
next instance in the chain. This allows later instances to revoke permissions granted
by earlier instances. As an example, if a URL represents a hierarchy such as
<code class="docutils literal"><span class="pre">/&lt;page&gt;/&lt;comment&gt;</span></code>, the <code class="docutils literal"><span class="pre">page</span></code> can assign <code class="docutils literal"><span class="pre">edit</span></code> and <code class="docutils literal"><span class="pre">delete</span></code> permissions,
while the <code class="docutils literal"><span class="pre">comment</span></code> can revoke <code class="docutils literal"><span class="pre">edit</span></code> and retain <code class="docutils literal"><span class="pre">delete</span></code> if the current user
owns the page but not the comment</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>In the following example, load_models loads a Folder with a name matching the name in the
URL, then loads a Page with a matching name and with the just-loaded Folder as parent.
If the Page provides a &#8216;view&#8217; permission to the current user (<cite>g.user</cite>), the decorated
function is called:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/&lt;folder_name&gt;/&lt;page_name&gt;&#39;</span><span class="p">)</span>
<span class="nd">@load_models</span><span class="p">(</span>
    <span class="p">(</span><span class="n">Folder</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;folder_name&#39;</span><span class="p">},</span> <span class="s">&#39;folder&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="n">Page</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">&#39;page_name&#39;</span><span class="p">,</span> <span class="s">&#39;parent&#39;</span><span class="p">:</span> <span class="s">&#39;folder&#39;</span><span class="p">},</span> <span class="s">&#39;page&#39;</span><span class="p">),</span>
    <span class="n">permission</span><span class="o">=</span><span class="s">&#39;view&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_page</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">page</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">&#39;page.html&#39;</span><span class="p">,</span> <span class="n">folder</span><span class="o">=</span><span class="n">folder</span><span class="p">,</span> <span class="n">page</span><span class="o">=</span><span class="n">page</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="coaster.views.render_with">
<code class="descclassname">coaster.views.</code><code class="descname">render_with</code><span class="sig-paren">(</span><em>template</em>, <em>json=False</em>, <em>jsonp=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coaster/views.html#render_with"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coaster.views.render_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator to render the wrapped method with the given template (or dictionary
of mimetype keys to templates, where the template is a string name of a template
file or a callable that returns a Response). The method&#8217;s return value must be
a dictionary and is passed to the template as parameters. Callable templates get
a single parameter with the method&#8217;s return value. Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/myview&#39;</span><span class="p">)</span>
<span class="nd">@render_with</span><span class="p">(</span><span class="s">&#39;myview.html&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">myview</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;data&#39;</span><span class="p">:</span> <span class="s">&#39;value&#39;</span><span class="p">}</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/myview_with_json&#39;</span><span class="p">)</span>
<span class="nd">@render_with</span><span class="p">(</span><span class="s">&#39;myview.html&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">myview_no_json</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;data&#39;</span><span class="p">:</span> <span class="s">&#39;value&#39;</span><span class="p">}</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/otherview&#39;</span><span class="p">)</span>
<span class="nd">@render_with</span><span class="p">({</span>
    <span class="s">&#39;text/html&#39;</span><span class="p">:</span> <span class="s">&#39;otherview.html&#39;</span><span class="p">,</span>
    <span class="s">&#39;text/xml&#39;</span><span class="p">:</span> <span class="s">&#39;otherview.xml&#39;</span><span class="p">})</span>
<span class="k">def</span> <span class="nf">otherview</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;data&#39;</span><span class="p">:</span> <span class="s">&#39;value&#39;</span><span class="p">}</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/404view&#39;</span><span class="p">)</span>
<span class="nd">@render_with</span><span class="p">(</span><span class="s">&#39;myview.html&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">myview</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;error&#39;</span><span class="p">:</span> <span class="s">&#39;404 Not Found&#39;</span><span class="p">},</span> <span class="mi">404</span>

<span class="nd">@app.route</span><span class="p">(</span><span class="s">&#39;/headerview&#39;</span><span class="p">)</span>
<span class="nd">@render_with</span><span class="p">(</span><span class="s">&#39;myview.html&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">myview</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s">&#39;data&#39;</span><span class="p">:</span> <span class="s">&#39;value&#39;</span><span class="p">},</span> <span class="mi">200</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;X-Header&#39;</span><span class="p">:</span> <span class="s">&#39;Header value&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>When a mimetype is specified and the template is not a callable, the response is
returned with the same mimetype. Callable templates must return Response objects
to ensure the correct mimetype is set.</p>
<p>If a dictionary of templates is provided and does not include a handler for <code class="docutils literal"><span class="pre">*/*</span></code>,
render_with will attempt to use the handler for (in order) <code class="docutils literal"><span class="pre">text/html</span></code>, <code class="docutils literal"><span class="pre">text/plain</span></code>
and the various JSON types, falling back to rendering the value into a unicode string.</p>
<p>If the method is called outside a request context, the wrapped method&#8217;s original
return value is returned. This is meant to facilitate testing and should not be
used to call the method from within another view handler as the presence of a
request context will trigger template rendering.</p>
<p>Rendering may also be suspended by calling the view handler with <code class="docutils literal"><span class="pre">_render=False</span></code>.</p>
<p>render_with provides JSON and JSONP handlers for the <code class="docutils literal"><span class="pre">application/json</span></code>,
<code class="docutils literal"><span class="pre">text/json</span></code> and <code class="docutils literal"><span class="pre">text/x-json</span></code> mimetypes if <code class="docutils literal"><span class="pre">json</span></code> or <code class="docutils literal"><span class="pre">jsonp</span></code> is True
(default is False).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>template</strong> &#8211; Single template, or dictionary of MIME type to templates. If the
template is a callable, it is called with the output of the wrapped function</li>
<li><strong>json</strong> &#8211; Helper to add a JSON handler (default is False)</li>
<li><strong>jsonp</strong> &#8211; Helper to add a JSONP handler (if True, also provides JSON, default is False)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="coaster.views.requestargs">
<code class="descclassname">coaster.views.</code><code class="descname">requestargs</code><span class="sig-paren">(</span><em>*vars</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/coaster/views.html#requestargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#coaster.views.requestargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator that loads parameters from request.values if not specified in the
function&#8217;s keyword arguments. Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@requestargs</span><span class="p">(</span><span class="s">&#39;param1&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;param2&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s">&#39;param3[]&#39;</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">function</span><span class="p">(</span><span class="n">param1</span><span class="p">,</span> <span class="n">param2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">param3</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>requestargs takes a list of parameters to pass to the wrapped function, with
an optional filter (useful to convert incoming string request data into integers
and other common types). If a required parameter is missing and your function does
not specify a default value, Python will raise TypeError. requestargs recasts this
as <a class="reference internal" href="#coaster.views.RequestTypeError" title="coaster.views.RequestTypeError"><code class="xref py py-exc docutils literal"><span class="pre">RequestTypeError</span></code></a>, which returns HTTP 400 Bad Request.</p>
<p>If the parameter name ends in <code class="docutils literal"><span class="pre">[]</span></code>, requestargs will attempt to read a list from
the incoming data. Filters are applied to each member of the list, not to the whole
list.</p>
<p>If the filter raises a ValueError, this is recast as a <a class="reference internal" href="#coaster.views.RequestValueError" title="coaster.views.RequestValueError"><code class="xref py py-exc docutils literal"><span class="pre">RequestValueError</span></code></a>,
which also returns HTTP 400 Bad Request.</p>
<p>Tests:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@requestargs</span><span class="p">(</span><span class="s">&#39;p1&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s">&#39;p2&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;p3[]&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">))</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">p3</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(1, None, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(1, 2, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
<span class="go">(&#39;a&#39;, &#39;b&#39;, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">(</span><span class="s">&#39;/?p2=2&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">f</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="s">&#39;1&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">(&#39;1&#39;, 2, None)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">(</span><span class="s">&#39;/?p3=1&amp;p3=2&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">f</span><span class="p">(</span><span class="n">p1</span><span class="o">=</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="s">&#39;2&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">(&#39;1&#39;, &#39;2&#39;, [1, 2])</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="assets.html" title="previous chapter">Assets</a></li>
      <li>Next: <a href="sqlalchemy.html" title="next chapter">SQLAlchemy patterns</a></li>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/views.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2012-15, HasGeek.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  
  </body>
</html>