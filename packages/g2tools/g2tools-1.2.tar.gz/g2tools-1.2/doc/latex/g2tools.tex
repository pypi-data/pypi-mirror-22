% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\usepackage[utf8]{inputenc}
\DeclareUnicodeCharacter{00A0}{\nobreakspace}
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{longtable}
\usepackage{sphinx}
\usepackage{multirow}

\addto\captionsenglish{\renewcommand{\figurename}{Fig. }}
\addto\captionsenglish{\renewcommand{\tablename}{Table }}
\floatname{literal-block}{Listing }



\title{g2tools Documentation}
\date{May 25, 2017}
\release{1.2}
\author{G.P. Lepage}
\newcommand{\sphinxlogo}{}
\renewcommand{\releasename}{Release}
\makeindex

\makeatletter
\def\PYG@reset{\let\PYG@it=\relax \let\PYG@bf=\relax%
    \let\PYG@ul=\relax \let\PYG@tc=\relax%
    \let\PYG@bc=\relax \let\PYG@ff=\relax}
\def\PYG@tok#1{\csname PYG@tok@#1\endcsname}
\def\PYG@toks#1+{\ifx\relax#1\empty\else%
    \PYG@tok{#1}\expandafter\PYG@toks\fi}
\def\PYG@do#1{\PYG@bc{\PYG@tc{\PYG@ul{%
    \PYG@it{\PYG@bf{\PYG@ff{#1}}}}}}}
\def\PYG#1#2{\PYG@reset\PYG@toks#1+\relax+\PYG@do{#2}}

\expandafter\def\csname PYG@tok@gd\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@gu\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@gt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PYG@tok@gs\endcsname{\let\PYG@bf=\textbf}
\expandafter\def\csname PYG@tok@gr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PYG@tok@cm\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@vg\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@m\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@mh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@cs\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\colorbox[rgb]{1.00,0.94,0.94}{\strut ##1}}}
\expandafter\def\csname PYG@tok@ge\endcsname{\let\PYG@it=\textit}
\expandafter\def\csname PYG@tok@vc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@il\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@go\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.20,0.20,0.20}{##1}}}
\expandafter\def\csname PYG@tok@cp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@gi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PYG@tok@gh\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PYG@tok@ni\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.84,0.33,0.22}{##1}}}
\expandafter\def\csname PYG@tok@nl\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.13,0.44}{##1}}}
\expandafter\def\csname PYG@tok@nn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@no\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.38,0.68,0.84}{##1}}}
\expandafter\def\csname PYG@tok@na\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@nb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.05,0.52,0.71}{##1}}}
\expandafter\def\csname PYG@tok@nd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.33,0.33,0.33}{##1}}}
\expandafter\def\csname PYG@tok@ne\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@nf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.49}{##1}}}
\expandafter\def\csname PYG@tok@si\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.44,0.63,0.82}{##1}}}
\expandafter\def\csname PYG@tok@s2\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@vi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@nt\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.02,0.16,0.45}{##1}}}
\expandafter\def\csname PYG@tok@nv\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.38,0.84}{##1}}}
\expandafter\def\csname PYG@tok@s1\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@gp\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@sh\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@ow\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@sx\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.78,0.36,0.04}{##1}}}
\expandafter\def\csname PYG@tok@bp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c1\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@kc\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@c\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.50,0.56}{##1}}}
\expandafter\def\csname PYG@tok@mf\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@err\endcsname{\def\PYG@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PYG@tok@mb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@ss\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.32,0.47,0.09}{##1}}}
\expandafter\def\csname PYG@tok@sr\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.14,0.33,0.53}{##1}}}
\expandafter\def\csname PYG@tok@mo\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@kd\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@mi\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.13,0.50,0.31}{##1}}}
\expandafter\def\csname PYG@tok@kn\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@o\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PYG@tok@kr\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@s\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@kp\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@w\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PYG@tok@kt\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.56,0.13,0.00}{##1}}}
\expandafter\def\csname PYG@tok@sc\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@sb\endcsname{\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@k\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.00,0.44,0.13}{##1}}}
\expandafter\def\csname PYG@tok@se\endcsname{\let\PYG@bf=\textbf\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}
\expandafter\def\csname PYG@tok@sd\endcsname{\let\PYG@it=\textit\def\PYG@tc##1{\textcolor[rgb]{0.25,0.44,0.63}{##1}}}

\def\PYGZbs{\char`\\}
\def\PYGZus{\char`\_}
\def\PYGZob{\char`\{}
\def\PYGZcb{\char`\}}
\def\PYGZca{\char`\^}
\def\PYGZam{\char`\&}
\def\PYGZlt{\char`\<}
\def\PYGZgt{\char`\>}
\def\PYGZsh{\char`\#}
\def\PYGZpc{\char`\%}
\def\PYGZdl{\char`\$}
\def\PYGZhy{\char`\-}
\def\PYGZsq{\char`\'}
\def\PYGZdq{\char`\"}
\def\PYGZti{\char`\~}
% for compatibility with earlier versions
\def\PYGZat{@}
\def\PYGZlb{[}
\def\PYGZrb{]}
\makeatother

\renewcommand\PYGZsq{\textquotesingle}

\begin{document}

\maketitle
\tableofcontents
\phantomsection\label{index::doc}


Contents:


\chapter{Muon g-2 from Lattice QCD using \texttt{g2tools}}
\label{overview:g2tools-documentation}\label{overview:muon-g-2-from-lattice-qcd-using-g2tools}\label{overview::doc}
Module {\hyperref[g2tools:module-g2tools]{\emph{\code{g2tools}}}} contains a small number of tools useful for analyzing
contributions to the muon's magnetic moment from (lattice) QCD vacuum
polarization. These tools were developed by G.P. Lepage to implement the
analysis presented in Chakraborty \emph{et al}, Phys.Rev. D89 (2014) no.11, 114501
(arXiv:1403.1778) and subsequent papers by the same authors.

A typical application, illustrating the most important tools, is
provided by the following code:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{g2tools} \PYG{k+kn}{as} \PYG{n+nn}{g2}
\PYG{k+kn}{import} \PYG{n+nn}{gvar} \PYG{k+kn}{as} \PYG{n+nn}{gv}

\PYG{k}{def} \PYG{n+nf}{main}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{c}{\PYGZsh{} data}
    \PYG{n}{Z} \PYG{o}{=} \PYG{n}{gv}\PYG{o}{.}\PYG{n}{gvar}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.9938(17)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{)}           \PYG{c}{\PYGZsh{} current Z factor}
    \PYG{n}{Q} \PYG{o}{=} \PYG{l+m+mf}{1.} \PYG{o}{/} \PYG{l+m+mf}{3.}                         \PYG{c}{\PYGZsh{} charge of quark (units of proton charge)}
    \PYG{n}{ainv} \PYG{o}{=} \PYG{n}{gv}\PYG{o}{.}\PYG{n}{gvar}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.6280(86)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{)}        \PYG{c}{\PYGZsh{} inverse lattice spacing (in GeV)}

    \PYG{n}{G} \PYG{o}{=} \PYG{n}{gv}\PYG{o}{.}\PYG{n}{gvar}\PYG{p}{(}\PYG{p}{[}                       \PYG{c}{\PYGZsh{} G(t) for t=0..63 (in lattice units)}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.0870904(11)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.0435138(14)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.00509859(48)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.00305614(43)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.00069516(19)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.00045466(15)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.000166972(80)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.000102219(58)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.000045284(34)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.000026213(22)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.000012630(14)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{7.0635(91)e\PYGZhy{}06}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{3.5569(57)e\PYGZhy{}06}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.9469(37)e\PYGZhy{}06}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.0027(24)e\PYGZhy{}06}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{5.421(16)e\PYGZhy{}07}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{2.834(10)e\PYGZhy{}07}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.5174(67)e\PYGZhy{}07}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{7.943(43)e\PYGZhy{}08}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{4.253(28)e\PYGZhy{}08}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{2.221(19)e\PYGZhy{}08}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.183(12)e\PYGZhy{}08}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{6.132(81)e\PYGZhy{}09}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{3.292(51)e\PYGZhy{}09}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.727(34)e\PYGZhy{}09}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{9.19(22)e\PYGZhy{}10}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{4.81(14)e\PYGZhy{}10}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{2.643(96)e\PYGZhy{}10}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.385(64)e\PYGZhy{}10}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{7.61(44)e\PYGZhy{}11}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{3.92(31)e\PYGZhy{}11}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{2.67(24)e\PYGZhy{}11}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{2.07(21)e\PYGZhy{}11}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{2.90(23)e\PYGZhy{}11}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{4.12(31)e\PYGZhy{}11}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{8.20(42)e\PYGZhy{}11}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.380(65)e\PYGZhy{}10}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{2.788(98)e\PYGZhy{}10}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{5.01(15)e\PYGZhy{}10}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{9.72(23)e\PYGZhy{}10}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.782(34)e\PYGZhy{}09}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{3.406(53)e\PYGZhy{}09}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{6.333(78)e\PYGZhy{}09}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.212(12)e\PYGZhy{}08}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{2.249(18)e\PYGZhy{}08}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{4.283(28)e\PYGZhy{}08}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{8.016(44)e\PYGZhy{}08}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.5263(67)e\PYGZhy{}07}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{2.843(10)e\PYGZhy{}07}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{5.420(16)e\PYGZhy{}07}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.0062(25)e\PYGZhy{}06}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{1.9453(39)e\PYGZhy{}06}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{3.5611(58)e\PYGZhy{}06}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{7.0675(93)e\PYGZhy{}06}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.000012647(14)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.000026240(22)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.000045282(32)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.000102285(56)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.000166993(79)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.00045479(15)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,}
        \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.00069503(19)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.00305647(42)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.00509870(47)}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{0.0435158(14)}\PYG{l+s}{\PYGZsq{}}
        \PYG{p}{]}\PYG{p}{)}
    \PYG{c}{\PYGZsh{} N.B.: In general would construct G so that correlations from one t}
    \PYG{c}{\PYGZsh{}   to the next are included. Don\PYGZsq{}t bother here since this is meant}
    \PYG{c}{\PYGZsh{}   just to illustrate g2tools.}

    \PYG{c}{\PYGZsh{} compute moments, converting to physical units from lattice units}
    \PYG{n}{mom} \PYG{o}{=} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{moments}\PYG{p}{(}\PYG{n}{G}\PYG{p}{,} \PYG{n}{ainv}\PYG{o}{=}\PYG{n}{ainv}\PYG{p}{,} \PYG{n}{Z}\PYG{o}{=}\PYG{n}{Z}\PYG{p}{,} \PYG{n}{periodic}\PYG{o}{=}\PYG{n+nb+bp}{True}\PYG{p}{,} \PYG{n}{nlist}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mi}{6}\PYG{p}{,} \PYG{l+m+mi}{8}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{print}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{Taylor coefficients:}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{mom2taylor}\PYG{p}{(}\PYG{n}{mom}\PYG{p}{)}\PYG{p}{)}
    \PYG{k}{print}\PYG{p}{(}\PYG{p}{)}

    \PYG{c}{\PYGZsh{} construct subtracted vac pol function using [2,2] Padé}
    \PYG{n}{vpol} \PYG{o}{=} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{vacpol}\PYG{p}{(}\PYG{n}{mom}\PYG{p}{,} \PYG{n}{order}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}

    \PYG{c}{\PYGZsh{} integrate vpol to get a\PYGZus{}mu and print result}
    \PYG{n}{amu} \PYG{o}{=} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{a\PYGZus{}mu}\PYG{p}{(}\PYG{n}{vpol}\PYG{p}{,} \PYG{n}{Q}\PYG{o}{=}\PYG{n}{Q}\PYG{p}{)}
    \PYG{k}{print}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{a\PYGZus{}mu contribution =}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{amu}\PYG{p}{)}
    \PYG{k}{print}\PYG{p}{(}\PYG{p}{)}

    \PYG{c}{\PYGZsh{} error budget for a\PYGZus{}mu}
    \PYG{k}{print}\PYG{p}{(}\PYG{n}{gv}\PYG{o}{.}\PYG{n}{fmt\PYGZus{}errorbudget}\PYG{p}{(}
        \PYG{n}{outputs}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{a\PYGZus{}mu}\PYG{o}{=}\PYG{n}{amu}\PYG{p}{,} \PYG{n}{mom4}\PYG{o}{=}\PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,}
        \PYG{n}{inputs}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{G}\PYG{o}{=}\PYG{n}{G}\PYG{p}{,} \PYG{n}{Z}\PYG{o}{=}\PYG{n}{Z}\PYG{p}{,} \PYG{n}{ainv}\PYG{o}{=}\PYG{n}{ainv}\PYG{p}{)}\PYG{p}{,}
        \PYG{p}{)}\PYG{p}{)}

\PYG{k}{if} \PYG{n}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s}{\PYGZsq{}}\PYG{l+s}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s}{\PYGZsq{}}\PYG{p}{:}
    \PYG{n}{main}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

In this code, we first read the simulation data for the \emph{jj} correlator into
array \code{G}, where \code{G{[}i{]}} is the correlator for (Euclidean) time  \code{i/ainv}
where \code{i=0,1..63}. We then use {\hyperref[g2tools:g2tools.moments]{\emph{\code{g2tools.moments()}}}} to calculate
temporal moments of the correlator, while also converting from lattice units
to physical units (using the inverse lattice spacing \code{ainv})  and
renormalizing the current (\code{Z}).

\code{vpol(q2)} is the vacuum polarization function at Euclidean \emph{q}$^{\text{2}}$
equal to \code{q2}. Object \code{vpol} has type {\hyperref[g2tools:g2tools.vacpol]{\emph{\code{g2tools.vacpol}}}}. It
constructs a  {[}2,2{]} Padé approximant from the moments,
and uses that approximant to  approximate the exact function.
The approximants converge to the exact result as the order
increases provided the momentum is space-like (\code{q2} non-negative).
Using a {[}1,1{]} Padé instead of {[}2,2{]} gives almost identical results here, so the
approximants have converged for the present application.

We calculate the contribution from vacuum polarization \code{vpol}
to the muon's anomalous magnetic moment a$_{\text{µ}}$ using
\code{g2tools.a\_mu()}. We also use \code{gvar.fmt\_errorbudget()}
to produce an error budget for it and the 4th moment.

Running this code gives the following output:

\begin{Verbatim}[commandchars=\\\{\}]
Taylor coefficients: [0.06629(74) \PYGZhy{}0.0527(11) 0.0472(15) \PYGZhy{}0.0435(18)]

a\PYGZus{}mu contribution = 5.412(57)e\PYGZhy{}09

Partial \PYGZpc{} Errors:
                a\PYGZus{}mu      mom4
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
     ainv:      1.00      1.06
        Z:      0.34      0.34
        G:      0.01      0.01
\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}\PYGZhy{}
    total:      1.06      1.11
\end{Verbatim}

The contribution to the muon's anomalous magnetic moment is
54.12(57)x10$^{\text{-10}}$. The error budget shows that the final
uncertainty is dominated by the uncertainty in the inverse
lattice spacing \code{ainv}; statistical errors from \code{G} are
completely negligible in this example.

An alternative to using moments is to Fourier transform the
correlator to obtain \code{vpol(q2)} directly. Moments are particularly
useful for analyzing finite-volume and other systematic errors, but
the Fourier method is simpler to code:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{c}{\PYGZsh{} compute a\PYGZus{}mu from the Fourier transform of G(t)}
\PYG{n}{vpol} \PYG{o}{=} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{fourier\PYGZus{}vacpol}\PYG{p}{(}\PYG{n}{G}\PYG{p}{,} \PYG{n}{ainv}\PYG{o}{=}\PYG{n}{ainv}\PYG{p}{,} \PYG{n}{Z}\PYG{o}{=}\PYG{n}{Z}\PYG{p}{,} \PYG{n}{periodic}\PYG{o}{=}\PYG{n+nb+bp}{True}\PYG{p}{)}
\PYG{n}{amu} \PYG{o}{=} \PYG{n}{g2}\PYG{o}{.}\PYG{n}{a\PYGZus{}mu}\PYG{p}{(}\PYG{n}{vpol}\PYG{p}{,} \PYG{n}{Q}\PYG{o}{=}\PYG{n}{Q}\PYG{p}{)}
\PYG{k}{print}\PYG{p}{(}\PYG{l+s}{\PYGZsq{}}\PYG{l+s}{a\PYGZus{}mu contribution =}\PYG{l+s}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{amu}\PYG{p}{)}
\PYG{k}{print}\PYG{p}{(}\PYG{p}{)}

\PYG{c}{\PYGZsh{} error budget for a\PYGZus{}mu}
\PYG{k}{print}\PYG{p}{(}\PYG{n}{gv}\PYG{o}{.}\PYG{n}{fmt\PYGZus{}errorbudget}\PYG{p}{(}
    \PYG{n}{outputs}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{a\PYGZus{}mu}\PYG{o}{=}\PYG{n}{amu}\PYG{p}{)}\PYG{p}{,}
    \PYG{n}{inputs}\PYG{o}{=}\PYG{n+nb}{dict}\PYG{p}{(}\PYG{n}{G}\PYG{o}{=}\PYG{n}{G}\PYG{p}{,} \PYG{n}{Z}\PYG{o}{=}\PYG{n}{Z}\PYG{p}{,} \PYG{n}{ainv}\PYG{o}{=}\PYG{n}{ainv}\PYG{p}{)}\PYG{p}{,}
    \PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

This code gives identical results to that above.

{\hyperref[g2tools:module-g2tools]{\emph{\code{g2tools}}}} is designed to work with module \code{gvar} which we use here
to represent the statistical and systematic uncertainties in
the correlator values, inverse lattice spacing, and \code{Z} factor. Each of these
quantities is an object of type \code{gvar.GVar}, which represents
a Gaussian random variable. \code{gvar.GVar}s describe not only
means and standard deviations, but also statistical correlations between
different objects. These correlations are propagated through arbitrary
arithmetic statements. Adding the following code to the end of \code{main()},
for example,

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{k}{print}\PYG{p}{(}\PYG{n}{gv}\PYG{o}{.}\PYG{n}{evalcorr}\PYG{p}{(}\PYG{p}{[}\PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{,} \PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{6}\PYG{p}{]}\PYG{p}{,} \PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{p}{,} \PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

prints out the correlation matrix for the moments, showing that they
are highly correlated (as expected):

\begin{Verbatim}[commandchars=\\\{\}]
[[ 1.          0.98833867  0.9787737   0.97262094]
 [ 0.98833867  1.          0.99853653  0.99646438]
 [ 0.9787737   0.99853653  1.          0.99949934]
 [ 0.97262094  0.99646438  0.99949934  1.        ]]
\end{Verbatim}

The moments are also highly correlated with the final results \code{a\_mu}: for
example, adding the following to the end of \code{main()}

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{k}{print}\PYG{p}{(}\PYG{n}{gv}\PYG{o}{.}\PYG{n}{evalcorr}\PYG{p}{(}\PYG{p}{[}\PYG{n}{a\PYGZus{}mu}\PYG{p}{,} \PYG{n}{mom}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
\end{Verbatim}

gives:

\begin{Verbatim}[commandchars=\\\{\}]
[[ 1.          0.96864247]
 [ 0.96864247  1.        ]]
\end{Verbatim}

This kind of correlation information is used by \code{gvar.fmt\_errorbudget(...)}
to create the error budget. See \code{gvar}`s documentation
for more information.


\chapter{\texttt{g2tools} Module}
\label{g2tools:g2tools-module}\label{g2tools::doc}\label{g2tools:module-g2tools}\index{g2tools (module)}

\section{Moments}
\label{g2tools:moments}
The main tools for creating and manipulating moments are:
\index{moments() (in module g2tools)}

\begin{fulllineitems}
\phantomsection\label{g2tools:g2tools.moments}\pysiglinewithargsret{\code{g2tools.}\bfcode{moments}}{\emph{G, Z=1.0, ainv=1.0, periodic=True, nlist={[}4, 6, 8, 10, 12, 14, 16, 18, 20{]}}}{}
Compute t**n moments of correlator G.

Compute \code{sum\_t t**n G(t)} for \code{n} in \code{nlist}, where both positive and
negative \code{t} are included.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\textbf{\texttt{G}} -- Array of correlator values \code{G{[}t{]}} for \code{t=0,1...}.

\item {} 
\textbf{\texttt{Z}} -- Renormalization factor for current (moments multiplied by \code{Z**2}).
Defaul is 1.

\item {} 
\textbf{\texttt{ainv}} -- Inverse lattice spacing used to convert moments to
physical units (n-th moment multiplied by \code{1/ainv**(n-2)}).
Default is 1.

\item {} 
\textbf{\texttt{periodic}} -- \code{periodic=True} implies \code{G{[}-t{]} = G{[}t{]}} (default);
\code{periodic=False} implies no periodicity in array \code{G{[}t{]}}
(and results doubled to account for negative \code{t}).

\item {} 
\textbf{\texttt{nlist}} -- List of moments to calculate. Default is
\code{nlist={[}4,6,8...20{]}}.

\end{itemize}

\item[{Returns}] \leavevmode
Dictionary \code{Gmom} where \code{Gmom{[}n{]}} is the \code{n-th} moment.

\end{description}\end{quote}

\end{fulllineitems}

\index{mom2taylor() (in module g2tools)}

\begin{fulllineitems}
\phantomsection\label{g2tools:g2tools.mom2taylor}\pysiglinewithargsret{\code{g2tools.}\bfcode{mom2taylor}}{\emph{mom}}{}
Convert moments in dictionary \code{mom} into Taylor series coefficients.

\end{fulllineitems}

\index{taylor2mom() (in module g2tools)}

\begin{fulllineitems}
\phantomsection\label{g2tools:g2tools.taylor2mom}\pysiglinewithargsret{\code{g2tools.}\bfcode{taylor2mom}}{\emph{tayl}}{}
Convert Taylor coefficients in array \code{tayl} to moments.

\end{fulllineitems}



\section{Subtracted Vacuum Polarization}
\label{g2tools:subtracted-vacuum-polarization}
A subtracted vacuum polarization function (\code{Pi-hat}) is
represented by the following classes:
\index{vacpol (class in g2tools)}

\begin{fulllineitems}
\phantomsection\label{g2tools:g2tools.vacpol}\pysiglinewithargsret{\strong{class }\code{g2tools.}\bfcode{vacpol}}{\emph{g}, \emph{order=None}, \emph{scale=None}, \emph{rtol=None}, \emph{warn=False}}{}
Subtracted vac. pol'n (\code{Pi-hat(q2)}) from correlator moments \code{Gmon{[}n{]}}.

The vacuum polarization function is a Pade approximant to the Taylor
series corresponding to the moments \code{g{[}n{]}}.  The code estimates the
precision of the moments and sets the tolerance for the Pade determination
accordingly. The order \code{(m,n)} of the Pade can be specified, but might
be reduced by the code if the data are noisy.

{\hyperref[g2tools:g2tools.vacpol]{\emph{\code{vacpol}}}} objects are used primarily as functions (of \emph{q}$^{\text{2}}$)
but also have several attributes. Attribute \code{pseries} is a dictionary
containing various powerseries (see \code{gvar.powerseries}) describing the
function: the vacuum polarization function is \code{q2} times a Pade
approximant  with a numerator given by \code{pseries{[}'num'{]}} and a
denominator  given by \code{pseries{[}'den'{]}}. The Taylor series for this
function  is given by \code{q2} times \code{pseries{[}'taylor'{]}}.

{\hyperref[g2tools:g2tools.vacpol]{\emph{\code{vacpol}}}} objects also have a method \code{vacpol.badpoles()} that
tests the poles in the denomator of the Pade. \code{badpoles(qth)} returns
\code{False} if any of the poles is complex or if any are located above
\code{-(qth ** 2)}. \code{qth} should be set equal to the threshold energy for
the correlator. If it is unset, \code{qth=0} is used.

{\hyperref[g2tools:g2tools.vacpol]{\emph{\code{vacpol}}}} has several static methods for creating specialized
examples of vacuum polarizations (e.g., for testing):
\begin{itemize}
\item {} 
\code{vacpol.fermion(m)} -- 1-loop fermion (mass \code{m}) contribution;

\item {} 
\code{vacpol.scalar(m)} -- 1-loop scalar (mass \code{m}) contribution;

\item {} \begin{description}
\item[{\code{vacpol.vector(m, f)} -- tree-level contribution from vector}] \leavevmode
with mass \code{m} and decay constant \code{f}.

\end{description}

\end{itemize}
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\textbf{\texttt{g}} -- Dictionary containing moments where \code{g{[}n{]} = sum\_t t**n G(t)},
or array containing Taylor coefficients where
\code{Pi-hat(q2) = q2 * sum\_j q2**j * g{[}j{]}}.

\item {} 
\textbf{\texttt{order}} -- Tuple \code{(m,n)} specifying the order of the Pade
approximant used to approximate the function. The order may
be reduced (automatically) if the data are too noisy.
If the order is not specified, it is set automatically
according to the number of entries in \code{G}.

\item {} 
\textbf{\texttt{scale}} -- Scale factor used to rescale \code{q2} so that
the Taylor coefficients are more uniform in size. This is
normally set automatically (from the first two moments),
but the automatic value is overridden if \code{scale} is set.

\item {} 
\textbf{\texttt{rtol}} -- Relative tolerance assumed when determining the
Pade approximant. This is normally set automatically
(from the standard deviations of the moments), but the
automatic value is overridden if \code{rtol} is specified.

\item {} 
\textbf{\texttt{warn}} -- \code{warn=True} causes a warning to be issued when there are
bad poles in the Pade or when the order has been reduced
automatically. \code{warn=False} (default) suppresses the warnings.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{fourier\_vacpol (class in g2tools)}

\begin{fulllineitems}
\phantomsection\label{g2tools:g2tools.fourier_vacpol}\pysiglinewithargsret{\strong{class }\code{g2tools.}\bfcode{fourier\_vacpol}}{\emph{G}, \emph{Z=1.0}, \emph{ainv=1.0}, \emph{periodic=True}}{}
Subtracted vac. pol'n (\code{Pi-hat(q2)}) from correlator \code{G(t)}.

The correlator is Fourier transformed to produce a function \code{Pi\_hat}
of (Euclidean) \emph{q}$^{\text{2}}$ suitable for use in \code{g2tools.a\_mu()}.

See Bernecker \& Meyer, EPJA47 (2011) 148 , arXiv:1107.4388 for details
on the Fouier transformation.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\textbf{\texttt{G}} (\emph{array}) -- Current-current correlator in an array whose elements
are \code{{[}G(0),G(a),G(2*a),...,G(-2*a),G(-a){]}} if
\code{periodic=True} or \code{{[}G(0),G(a),...,G(T*a-1){]}}
otherwise.

\item {} 
\textbf{\texttt{Z}} -- Renormalization factor for current (moments multiplied by \code{Z**2}).
Defaul is 1.

\item {} 
\textbf{\texttt{ainv}} -- Inverse lattice spacing used to convert moments to
physical units (n-th moment multiplied by \code{1/ainv**(n-2)}).
Default is 1.

\item {} 
\textbf{\texttt{periodic}} -- \code{periodic=True} implies \code{G{[}-t{]} = G{[}t{]}} (default);
\code{periodic=False} implies no periodicity in array \code{G{[}t{]}}
(and results doubled to account for negative \code{t}).

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\section{Padé Approximants}
\label{g2tools:pade-approximants}
The following two functions are used for calculating Padé approximants from
the Taylor coefficients of an arbitrary function. The first
({\hyperref[g2tools:g2tools.pade_svd]{\emph{\code{g2tools.pade\_svd()}}}}) implements an algorithm that uses \emph{svd} cuts to
address instabilities caused  by uncertainties in the Taylor coefficients. The
second function ({\hyperref[g2tools:g2tools.pade_gvar]{\emph{\code{g2tools.pade\_gvar()}}}}) is built on the first but allows
Taylor coefficients to have uncertainties (\code{gvar.GVar}s). The statistical
uncertainties and correlations between different coefficients are propagated
through the analysis.
\index{pade\_svd() (in module g2tools)}

\begin{fulllineitems}
\phantomsection\label{g2tools:g2tools.pade_svd}\pysiglinewithargsret{\code{g2tools.}\bfcode{pade\_svd}}{\emph{f}, \emph{m}, \emph{n}, \emph{rtol=1e-14}}{}
\code{{[}m,n{]}} Pade approximant to \code{sum\_i f{[}i{]} x**i}.

The \code{{[}m,n{]}} Pade approximant to a series given by
\code{sum\_i f{[}i{]} * x**i} is the ratio of  polynomials of order \code{m}
(numerator) and \code{n} (denominator) whose  Taylor expansion agrees
with that of the original series up to order \code{m+n}.

This code is adapted from P. Gonnet,  S. Guttel, L. N. Trefethen, SIAM
Review Vol 55, No. 1, 101 (2013). It uses an \emph{svd} algorithm to deal with
imprecision in the input data,  here specified by the relative tolerance
\code{rtol} for the  input coefficients \code{f{[}i{]}}. It automatically reduces
the order of the approximant if the extraction of Pade coefficients
is too unstable given tolerance \code{rtol}.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\textbf{\texttt{f}} -- Array \code{f{[}i{]}} of power series coefficients for \code{i=0...n+m}.

\item {} 
\textbf{\texttt{m}} -- Maximum order of polynomial in numerator of Pade
approximant (\code{m\textgreater{}=0}).

\item {} 
\textbf{\texttt{n}} -- Maximum order of polynomial in denominator of Pade
approximant (\code{m\textgreater{}=0}).

\item {} 
\textbf{\texttt{rtol}} -- Relative accuracy of input coefficients.

\end{itemize}

\item[{Returns}] \leavevmode
Tuple of power series coefficients \code{(p, q)} such that
\code{sum\_i p{[}i{]} x**i} is the numerator of the approximant,
and \code{sum\_i q{[}i{]} x**i} is the denominator. \code{q{[}0{]}} is
normalized to 1.

\end{description}\end{quote}

\end{fulllineitems}

\index{pade\_gvar() (in module g2tools)}

\begin{fulllineitems}
\phantomsection\label{g2tools:g2tools.pade_gvar}\pysiglinewithargsret{\code{g2tools.}\bfcode{pade\_gvar}}{\emph{f}, \emph{m}, \emph{n}, \emph{rtol=None}}{}
\code{{[}m,n{]}} Pade approximant to \code{sum\_i f{[}i{]} x**i} for \code{GVar}s.

The \code{{[}m,n{]}} Pade approximant to a series given by
\code{sum\_i f{[}i{]} * x**i} is the ratio of  polynomials of order \code{m}
(numerator) and \code{n} (denominator) whose  Taylor expansion agrees
with that of the original series up to order \code{m+n}.

This code uses an \emph{svd} algorithm (see {\hyperref[g2tools:g2tools.pade_svd]{\emph{\code{pade\_svd()}}}}) to deal with
imprecision in the input data. It automatically reduces
the order of the approximant if the extraction of Pade coefficients
is too unstable given noise in the input data.
\begin{quote}\begin{description}
\item[{Parameters}] \leavevmode\begin{itemize}
\item {} 
\textbf{\texttt{f}} -- Array \code{f{[}i{]}} of power series coefficients for \code{i=0...n+m}.

\item {} 
\textbf{\texttt{m}} -- Maximum order of polynomial in numerator of Pade
approximant (\code{m\textgreater{}=0}).

\item {} 
\textbf{\texttt{n}} -- Maximum order of polynomial in denominator of Pade
approximant (\code{m\textgreater{}=0}).

\item {} 
\textbf{\texttt{rtol}} -- Relative accuracy of input coefficients. Overrides
default estimate from the \code{f{[}i{]}} unless set equal to \code{None}.

\end{itemize}

\item[{Returns}] \leavevmode
Tuple of power series coefficients \code{(p, q)} such that
\code{sum\_i p{[}i{]} x**i} is the numerator of the approximant,
and \code{sum\_i q{[}i{]} x**i} is the denominator. \code{q{[}0{]}} is
normalized to 1.

\end{description}\end{quote}

\end{fulllineitems}



\chapter{Indices and tables}
\label{index:indices-and-tables}\begin{itemize}
\item {} 
\DUspan{xref,std,std-ref}{genindex}

\item {} 
\DUspan{xref,std,std-ref}{modindex}

\item {} 
\DUspan{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{theindex}
\def\bigletter#1{{\Large\sffamily#1}\nopagebreak\vspace{1mm}}
\bigletter{g}
\item {\texttt{g2tools}}, \pageref{g2tools:module-g2tools}
\end{theindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}
