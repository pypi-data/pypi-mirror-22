THEANO_FLAGS=floatX=float32,device=gpu,nvcc.fastmath=True
/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-29 15:30:47,515 train: TRAINING OPTIONS
2016-11-29 15:30:47,516 train: stopping_criterion: no-improvement
2016-11-29 15:30:47,516 train: max_epochs: 15
2016-11-29 15:30:47,516 train: sequence_length: 25
2016-11-29 15:30:47,516 train: max_annealing_count: 0
2016-11-29 15:30:47,516 train: validation_frequency: 1
2016-11-29 15:30:47,516 train: min_epochs: 1
2016-11-29 15:30:47,516 train: patience: 0
2016-11-29 15:30:47,516 train: batch_size: 24
2016-11-29 15:30:47,516 train: OPTIMIZATION OPTIONS
2016-11-29 15:30:47,516 train: gradient_decay_rate: 0.9
2016-11-29 15:30:47,516 train: max_gradient_norm: 5.0
2016-11-29 15:30:47,516 train: learning_rate: 1.0
2016-11-29 15:30:47,516 train: unk_penalty: None
2016-11-29 15:30:47,516 train: ignore_unk: False
2016-11-29 15:30:47,516 train: momentum: 0.9
2016-11-29 15:30:47,517 train: weights: [ 1.]
2016-11-29 15:30:47,517 train: method: adagrad
2016-11-29 15:30:47,517 train: sqr_gradient_decay_rate: 0.999
2016-11-29 15:30:47,517 train: num_noise_samples: 100
2016-11-29 15:30:47,517 train: noise_sharing: batch
2016-11-29 15:30:47,517 train: cost_function: blackout
2016-11-29 15:30:47,517 train: epsilon: 1e-06
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-29 15:30:48,745 __init__: One epoch of training data contains 2371 mini-batch updates.
2016-11-29 15:30:48,745 __init__: Class unigram probabilities are in the range [0.00000103, 0.05232915].
2016-11-29 15:30:48,746 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-29 15:30:48,770 _reset: Generating a random order of input lines.
Building neural network.
2016-11-29 15:30:48,778 __init__: Creating layers.
2016-11-29 15:30:48,779 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-29 15:30:48,779 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-29 15:30:48,819 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-29 15:30:49,031 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-29 15:30:49,158 __init__: Initializing parameters.
2016-11-29 15:30:49,158 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-29 15:30:49,159 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-29 15:30:49,159 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-29 15:30:49,159 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-29 15:30:49,159 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-29 15:30:49,159 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-29 15:30:49,159 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2016-11-29 15:31:37,317 _log_update: [200] (8.4 %) of epoch 1 -- lr = 1, cost = 4.75, duration = 7.2 ms
2016-11-29 15:31:52,202 _log_update: [400] (16.9 %) of epoch 1 -- lr = 1, cost = 4.56, duration = 7.2 ms
2016-11-29 15:32:07,082 _log_update: [600] (25.3 %) of epoch 1 -- lr = 1, cost = 4.39, duration = 7.2 ms
2016-11-29 15:32:21,958 _log_update: [800] (33.7 %) of epoch 1 -- lr = 1, cost = 4.21, duration = 7.4 ms
2016-11-29 15:32:36,810 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 1, cost = 3.97, duration = 7.2 ms
2016-11-29 15:32:52,138 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 1, cost = 3.83, duration = 7.3 ms
2016-11-29 15:33:07,094 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 1, cost = 4.26, duration = 7.3 ms
2016-11-29 15:33:21,784 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 1, cost = 4.03, duration = 7.4 ms
2016-11-29 15:33:36,538 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 1, cost = 3.97, duration = 7.3 ms
2016-11-29 15:33:51,328 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 1, cost = 3.82, duration = 7.2 ms
2016-11-29 15:34:06,062 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 1, cost = 3.71, duration = 7.2 ms
2016-11-29 15:34:25,266 _validate: [2365] First validation sample, perplexity 157.54.
2016-11-29 15:34:46,481 _validate: [2368] Center of validation, perplexity 158.43.
2016-11-29 15:35:07,257 _validate: [2371] Last validation sample, perplexity 158.83.
2016-11-29 15:35:07,286 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-29 15:35:07,286 _log_validation: [2371] Validation set cost history: [158.0]
2016-11-29 15:35:07,287 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 3.7 minutes. Best validation perplexity 158.03.
2016-11-29 15:35:09,467 _log_update: [29] (1.2 %) of epoch 2 -- lr = 1, cost = 3.53, duration = 7.3 ms
2016-11-29 15:35:24,216 _log_update: [229] (9.7 %) of epoch 2 -- lr = 1, cost = 3.55, duration = 7.2 ms
2016-11-29 15:35:38,934 _log_update: [429] (18.1 %) of epoch 2 -- lr = 1, cost = 3.74, duration = 7.2 ms
2016-11-29 15:35:53,595 _log_update: [629] (26.5 %) of epoch 2 -- lr = 1, cost = 3.41, duration = 7.4 ms
2016-11-29 15:36:08,294 _log_update: [829] (35.0 %) of epoch 2 -- lr = 1, cost = 3.59, duration = 7.2 ms
2016-11-29 15:36:22,956 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 1, cost = 3.72, duration = 7.3 ms
2016-11-29 15:36:37,614 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 1, cost = 3.80, duration = 7.2 ms
2016-11-29 15:36:52,309 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 1, cost = 3.53, duration = 7.3 ms
2016-11-29 15:37:06,905 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 1, cost = 3.82, duration = 7.2 ms
2016-11-29 15:37:21,733 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 1, cost = 3.56, duration = 7.3 ms
2016-11-29 15:37:36,510 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 1, cost = 3.55, duration = 7.2 ms
2016-11-29 15:37:51,313 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 1, cost = 3.43, duration = 7.2 ms
2016-11-29 15:38:08,255 _validate: [2365] First validation sample, perplexity 135.83.
2016-11-29 15:38:29,545 _validate: [2368] Center of validation, perplexity 135.87.
2016-11-29 15:38:50,217 _validate: [2371] Last validation sample, perplexity 136.02.
2016-11-29 15:38:50,255 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-29 15:38:50,256 _log_validation: [2371] Validation set cost history: 158.0 [135.9]
2016-11-29 15:38:50,258 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 3.7 minutes. Best validation perplexity 135.87.
2016-11-29 15:38:54,500 _log_update: [58] (2.4 %) of epoch 3 -- lr = 1, cost = 3.33, duration = 7.2 ms
2016-11-29 15:39:09,127 _log_update: [258] (10.9 %) of epoch 3 -- lr = 1, cost = 2.92, duration = 7.3 ms
2016-11-29 15:39:23,763 _log_update: [458] (19.3 %) of epoch 3 -- lr = 1, cost = 3.32, duration = 7.2 ms
2016-11-29 15:39:38,377 _log_update: [658] (27.8 %) of epoch 3 -- lr = 1, cost = 3.32, duration = 7.2 ms
2016-11-29 15:39:52,979 _log_update: [858] (36.2 %) of epoch 3 -- lr = 1, cost = 2.95, duration = 7.2 ms
2016-11-29 15:40:07,676 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 1, cost = 3.30, duration = 7.1 ms
2016-11-29 15:40:22,309 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 1, cost = 3.18, duration = 7.3 ms
2016-11-29 15:40:36,997 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 1, cost = 3.30, duration = 7.2 ms
2016-11-29 15:40:51,825 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 1, cost = 3.26, duration = 7.2 ms
2016-11-29 15:41:06,622 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 1, cost = 3.23, duration = 7.2 ms
2016-11-29 15:41:21,498 _log_update: [2058] (86.8 %) of epoch 3 -- lr = 1, cost = 2.82, duration = 7.2 ms
2016-11-29 15:41:36,037 _log_update: [2258] (95.2 %) of epoch 3 -- lr = 1, cost = 3.28, duration = 7.2 ms
2016-11-29 15:41:50,930 _validate: [2365] First validation sample, perplexity 131.40.
2016-11-29 15:42:12,058 _validate: [2368] Center of validation, perplexity 131.55.
2016-11-29 15:42:32,647 _validate: [2371] Last validation sample, perplexity 131.93.
2016-11-29 15:42:32,670 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-29 15:42:32,670 _log_validation: [2371] Validation set cost history: 158.0 135.9 [131.6]
2016-11-29 15:42:32,672 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 3.7 minutes. Best validation perplexity 131.55.
2016-11-29 15:42:39,017 _log_update: [87] (3.7 %) of epoch 4 -- lr = 1, cost = 2.95, duration = 7.2 ms
2016-11-29 15:42:53,596 _log_update: [287] (12.1 %) of epoch 4 -- lr = 1, cost = 3.18, duration = 7.2 ms
2016-11-29 15:43:08,248 _log_update: [487] (20.5 %) of epoch 4 -- lr = 1, cost = 3.01, duration = 7.2 ms
2016-11-29 15:43:23,039 _log_update: [687] (29.0 %) of epoch 4 -- lr = 1, cost = 3.12, duration = 9.0 ms
2016-11-29 15:43:37,618 _log_update: [887] (37.4 %) of epoch 4 -- lr = 1, cost = 2.99, duration = 7.2 ms
2016-11-29 15:43:52,333 _log_update: [1087] (45.8 %) of epoch 4 -- lr = 1, cost = 3.29, duration = 7.3 ms
2016-11-29 15:44:07,046 _log_update: [1287] (54.3 %) of epoch 4 -- lr = 1, cost = 2.98, duration = 7.3 ms
2016-11-29 15:44:21,739 _log_update: [1487] (62.7 %) of epoch 4 -- lr = 1, cost = 3.34, duration = 7.2 ms
2016-11-29 15:44:36,361 _log_update: [1687] (71.2 %) of epoch 4 -- lr = 1, cost = 3.16, duration = 7.1 ms
2016-11-29 15:44:50,992 _log_update: [1887] (79.6 %) of epoch 4 -- lr = 1, cost = 3.16, duration = 7.1 ms
2016-11-29 15:45:06,003 _log_update: [2087] (88.0 %) of epoch 4 -- lr = 1, cost = 3.09, duration = 7.5 ms
2016-11-29 15:45:21,229 _log_update: [2287] (96.5 %) of epoch 4 -- lr = 1, cost = 3.07, duration = 7.5 ms
2016-11-29 15:45:33,695 _validate: [2365] First validation sample, perplexity 134.60.
2016-11-29 15:45:54,245 _validate: [2368] Center of validation, perplexity 134.56.
2016-11-29 15:46:15,098 _validate: [2371] Last validation sample, perplexity 134.93.
2016-11-29 15:46:15,098 _log_validation: [2371] Validation set cost history: 158.0 135.9 [131.6] 134.7
2016-11-29 15:46:15,099 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-29 15:46:15,100 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-29 15:46:15,103 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-29 15:46:15,104 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-29 15:46:15,105 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-29 15:46:15,105 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-29 15:46:15,106 _reset_state: [2368] (99.87 %) of epoch 3
2016-11-29 15:46:15,106 _log_validation: [2368] Validation set cost history: 158.0 135.9 [131.6]
2016-11-29 15:46:15,107 set_state: Restored iterator to line 42022 of 42068.
2016-11-29 15:46:15,107 set_state: layers/output_layer/input/b_sum_sqr_gradient <- array(10001,)
2016-11-29 15:46:15,108 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-29 15:46:15,108 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-29 15:46:15,109 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-29 15:46:15,109 set_state: layers/hidden_layer/layer_input/b_sum_sqr_gradient <- array(1024,)
2016-11-29 15:46:15,111 set_state: layers/projection_layer/W_sum_sqr_gradient <- array(10001, 100)
2016-11-29 15:46:15,111 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-29 15:46:15,112 set_state: layers/hidden_layer/layer_input/W_sum_sqr_gradient <- array(100, 1024)
2016-11-29 15:46:15,112 set_state: layers/hidden_layer/step_input/W_sum_sqr_gradient <- array(256, 1024)
2016-11-29 15:46:15,113 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-29 15:46:15,117 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-29 15:46:15,120 set_state: layers/output_layer/input/W_sum_sqr_gradient <- array(256, 10001)
Model performance stopped improving. Decreasing learning rate from 1.0 to 0.5 and resetting state to 100 % of epoch 3.
2016-11-29 15:46:15,122 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 3.7 minutes. Best validation perplexity 131.55.
2016-11-29 15:46:23,753 _log_update: [116] (4.9 %) of epoch 4 -- lr = 0.5, cost = 3.03, duration = 7.3 ms
2016-11-29 15:46:38,652 _log_update: [316] (13.3 %) of epoch 4 -- lr = 0.5, cost = 2.74, duration = 7.1 ms
2016-11-29 15:46:53,467 _log_update: [516] (21.8 %) of epoch 4 -- lr = 0.5, cost = 3.03, duration = 7.2 ms
2016-11-29 15:47:08,376 _log_update: [716] (30.2 %) of epoch 4 -- lr = 0.5, cost = 2.87, duration = 8.0 ms
2016-11-29 15:47:23,476 _log_update: [916] (38.6 %) of epoch 4 -- lr = 0.5, cost = 2.97, duration = 7.9 ms
2016-11-29 15:47:38,937 _log_update: [1116] (47.1 %) of epoch 4 -- lr = 0.5, cost = 2.98, duration = 7.7 ms
2016-11-29 15:47:54,057 _log_update: [1316] (55.5 %) of epoch 4 -- lr = 0.5, cost = 2.64, duration = 7.4 ms
2016-11-29 15:48:08,785 _log_update: [1516] (63.9 %) of epoch 4 -- lr = 0.5, cost = 3.05, duration = 7.2 ms
2016-11-29 15:48:23,549 _log_update: [1716] (72.4 %) of epoch 4 -- lr = 0.5, cost = 2.80, duration = 7.3 ms
2016-11-29 15:48:38,386 _log_update: [1916] (80.8 %) of epoch 4 -- lr = 0.5, cost = 3.11, duration = 7.3 ms
2016-11-29 15:48:53,420 _log_update: [2116] (89.2 %) of epoch 4 -- lr = 0.5, cost = 2.70, duration = 7.3 ms
2016-11-29 15:49:08,543 _log_update: [2316] (97.7 %) of epoch 4 -- lr = 0.5, cost = 2.89, duration = 7.4 ms
2016-11-29 15:49:19,175 _validate: [2365] First validation sample, perplexity 130.49.
2016-11-29 15:49:39,897 _validate: [2368] Center of validation, perplexity 130.40.
2016-11-29 15:50:00,758 _validate: [2371] Last validation sample, perplexity 130.47.
2016-11-29 15:50:00,780 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-29 15:50:00,780 _log_validation: [2371] Validation set cost history: 158.0 135.9 131.6 [130.5]
2016-11-29 15:50:00,782 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 3.8 minutes. Best validation perplexity 130.47.
2016-11-29 15:50:11,427 _log_update: [145] (6.1 %) of epoch 5 -- lr = 0.5, cost = 2.69, duration = 7.3 ms
2016-11-29 15:50:26,307 _log_update: [345] (14.6 %) of epoch 5 -- lr = 0.5, cost = 2.81, duration = 7.2 ms
2016-11-29 15:50:41,365 _log_update: [545] (23.0 %) of epoch 5 -- lr = 0.5, cost = 3.07, duration = 7.4 ms
2016-11-29 15:50:56,302 _log_update: [745] (31.4 %) of epoch 5 -- lr = 0.5, cost = 3.04, duration = 7.6 ms
2016-11-29 15:51:11,293 _log_update: [945] (39.9 %) of epoch 5 -- lr = 0.5, cost = 3.16, duration = 7.3 ms
2016-11-29 15:51:26,330 _log_update: [1145] (48.3 %) of epoch 5 -- lr = 0.5, cost = 2.82, duration = 7.4 ms
2016-11-29 15:51:41,156 _log_update: [1345] (56.7 %) of epoch 5 -- lr = 0.5, cost = 2.51, duration = 7.4 ms
2016-11-29 15:51:56,021 _log_update: [1545] (65.2 %) of epoch 5 -- lr = 0.5, cost = 3.23, duration = 7.3 ms
2016-11-29 15:52:10,895 _log_update: [1745] (73.6 %) of epoch 5 -- lr = 0.5, cost = 2.98, duration = 7.5 ms
2016-11-29 15:52:25,690 _log_update: [1945] (82.0 %) of epoch 5 -- lr = 0.5, cost = 3.12, duration = 7.3 ms
2016-11-29 15:52:40,374 _log_update: [2145] (90.5 %) of epoch 5 -- lr = 0.5, cost = 2.66, duration = 7.3 ms
2016-11-29 15:52:55,236 _log_update: [2345] (98.9 %) of epoch 5 -- lr = 0.5, cost = 2.72, duration = 7.3 ms
2016-11-29 15:53:03,460 _validate: [2365] First validation sample, perplexity 135.12.
2016-11-29 15:53:24,131 _validate: [2368] Center of validation, perplexity 135.34.
2016-11-29 15:53:44,638 _validate: [2371] Last validation sample, perplexity 135.48.
2016-11-29 15:53:44,638 _log_validation: [2371] Validation set cost history: 158.0 135.9 131.6 [130.5] 135.3
2016-11-29 15:53:44,638 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-29 15:53:44,640 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-29 15:53:44,643 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-29 15:53:44,644 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-29 15:53:44,644 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-29 15:53:44,644 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-29 15:53:44,646 _reset_state: [2368] (99.87 %) of epoch 4
2016-11-29 15:53:44,646 _log_validation: [2368] Validation set cost history: 158.0 135.9 131.6 [130.5]
2016-11-29 15:53:44,646 set_state: Restored iterator to line 42020 of 42068.
2016-11-29 15:53:44,647 set_state: layers/output_layer/input/b_sum_sqr_gradient <- array(10001,)
2016-11-29 15:53:44,647 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-29 15:53:44,647 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-29 15:53:44,648 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-29 15:53:44,648 set_state: layers/hidden_layer/layer_input/b_sum_sqr_gradient <- array(1024,)
2016-11-29 15:53:44,650 set_state: layers/projection_layer/W_sum_sqr_gradient <- array(10001, 100)
2016-11-29 15:53:44,650 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-29 15:53:44,651 set_state: layers/hidden_layer/layer_input/W_sum_sqr_gradient <- array(100, 1024)
2016-11-29 15:53:44,651 set_state: layers/hidden_layer/step_input/W_sum_sqr_gradient <- array(256, 1024)
2016-11-29 15:53:44,652 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-29 15:53:44,656 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-29 15:53:44,659 set_state: layers/output_layer/input/W_sum_sqr_gradient <- array(256, 10001)
Model performance stopped improving. Decreasing learning rate from 0.5 to 0.25 and resetting state to 100 % of epoch 4.
2016-11-29 15:53:44,660 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 3.7 minutes. Best validation perplexity 130.47.
2016-11-29 15:53:57,539 _log_update: [174] (7.3 %) of epoch 5 -- lr = 0.2, cost = 2.64, duration = 7.3 ms
2016-11-29 15:54:12,345 _log_update: [374] (15.8 %) of epoch 5 -- lr = 0.2, cost = 3.07, duration = 7.4 ms
2016-11-29 15:54:27,088 _log_update: [574] (24.2 %) of epoch 5 -- lr = 0.2, cost = 2.67, duration = 7.3 ms
2016-11-29 15:54:42,157 _log_update: [774] (32.6 %) of epoch 5 -- lr = 0.2, cost = 2.88, duration = 7.2 ms
2016-11-29 15:54:56,917 _log_update: [974] (41.1 %) of epoch 5 -- lr = 0.2, cost = 2.84, duration = 7.4 ms
2016-11-29 15:55:12,232 _log_update: [1174] (49.5 %) of epoch 5 -- lr = 0.2, cost = 2.70, duration = 7.9 ms
2016-11-29 15:55:27,328 _log_update: [1374] (58.0 %) of epoch 5 -- lr = 0.2, cost = 2.75, duration = 7.4 ms
2016-11-29 15:55:42,132 _log_update: [1574] (66.4 %) of epoch 5 -- lr = 0.2, cost = 2.84, duration = 7.4 ms
2016-11-29 15:55:57,156 _log_update: [1774] (74.8 %) of epoch 5 -- lr = 0.2, cost = 2.74, duration = 7.3 ms
2016-11-29 15:56:12,632 _log_update: [1974] (83.3 %) of epoch 5 -- lr = 0.2, cost = 3.05, duration = 8.8 ms
2016-11-29 15:56:28,192 _log_update: [2174] (91.7 %) of epoch 5 -- lr = 0.2, cost = 2.88, duration = 7.4 ms
2016-11-29 15:56:49,126 _validate: [2365] First validation sample, perplexity 133.87.
2016-11-29 15:57:09,564 _validate: [2368] Center of validation, perplexity 133.78.
2016-11-29 15:57:29,917 _validate: [2371] Last validation sample, perplexity 133.86.
2016-11-29 15:57:29,917 _log_validation: [2371] Validation set cost history: 158.0 135.9 131.6 [130.5] 133.9
2016-11-29 15:57:29,918 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-29 15:57:29,919 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-29 15:57:29,922 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-29 15:57:29,923 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-29 15:57:29,924 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-29 15:57:29,924 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-29 15:57:29,925 _reset_state: [2368] (99.87 %) of epoch 4
2016-11-29 15:57:29,926 _log_validation: [2368] Validation set cost history: 158.0 135.9 131.6 [130.5]
2016-11-29 15:57:29,926 set_state: Restored iterator to line 42020 of 42068.
2016-11-29 15:57:29,927 set_state: layers/output_layer/input/b_sum_sqr_gradient <- array(10001,)
2016-11-29 15:57:29,927 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-29 15:57:29,927 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-29 15:57:29,928 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-29 15:57:29,928 set_state: layers/hidden_layer/layer_input/b_sum_sqr_gradient <- array(1024,)
2016-11-29 15:57:29,929 set_state: layers/projection_layer/W_sum_sqr_gradient <- array(10001, 100)
2016-11-29 15:57:29,930 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-29 15:57:29,930 set_state: layers/hidden_layer/layer_input/W_sum_sqr_gradient <- array(100, 1024)
2016-11-29 15:57:29,931 set_state: layers/hidden_layer/step_input/W_sum_sqr_gradient <- array(256, 1024)
2016-11-29 15:57:29,932 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-29 15:57:29,936 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-29 15:57:29,939 set_state: layers/output_layer/input/W_sum_sqr_gradient <- array(256, 10001)
Model performance stopped improving. Decreasing learning rate from 0.25 to 0.125 and resetting state to 100 % of epoch 4.
Finished training epoch 4 in 0 hours 3.8 minutes. Best validation perplexity 130.47.
Training finished in 0 hours 26.1 minutes.
2016-11-29 15:57:29,941 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-29 15:57:29,942 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-29 15:57:29,945 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-29 15:57:29,946 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-29 15:57:29,946 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-29 15:57:29,947 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
Best validation set perplexity: 130.396843107
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of predicted probabilities: 82430
Cross entropy (base e): 4.82417422073879
Perplexity: 124.48362992815271
