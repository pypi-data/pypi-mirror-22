THEANO_FLAGS=floatX=float32,device=gpu,nvcc.fastmath=True
/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-27 04:25:06,680 train: TRAINING OPTIONS
2016-11-27 04:25:06,680 train: max_annealing_count: 0
2016-11-27 04:25:06,680 train: min_epochs: 1
2016-11-27 04:25:06,680 train: batch_size: 24
2016-11-27 04:25:06,680 train: max_epochs: 15
2016-11-27 04:25:06,681 train: stopping_criterion: no-improvement
2016-11-27 04:25:06,681 train: validation_frequency: 1
2016-11-27 04:25:06,681 train: sequence_length: 25
2016-11-27 04:25:06,681 train: patience: 0
2016-11-27 04:25:06,681 train: OPTIMIZATION OPTIONS
2016-11-27 04:25:06,681 train: noise_sharing: batch
2016-11-27 04:25:06,681 train: num_noise_samples: 100
2016-11-27 04:25:06,681 train: unk_penalty: None
2016-11-27 04:25:06,681 train: weights: [ 1.]
2016-11-27 04:25:06,681 train: epsilon: 1e-06
2016-11-27 04:25:06,681 train: max_gradient_norm: 5.0
2016-11-27 04:25:06,681 train: gradient_decay_rate: 0.9
2016-11-27 04:25:06,681 train: learning_rate: 5.0
2016-11-27 04:25:06,682 train: ignore_unk: False
2016-11-27 04:25:06,682 train: sqr_gradient_decay_rate: 0.999
2016-11-27 04:25:06,682 train: cost_function: nce
2016-11-27 04:25:06,682 train: method: sgd
2016-11-27 04:25:06,682 train: momentum: 0.9
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-27 04:25:07,873 __init__: One epoch of training data contains 2371 mini-batch updates.
2016-11-27 04:25:07,874 __init__: Class unigram probabilities are in the range [0.00000103, 0.05232915].
2016-11-27 04:25:07,876 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-27 04:25:07,900 _reset: Generating a random order of input lines.
Building neural network.
2016-11-27 04:25:07,907 __init__: Creating layers.
2016-11-27 04:25:07,907 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-27 04:25:07,907 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-27 04:25:07,946 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-27 04:25:08,126 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-27 04:25:08,246 __init__: Initializing parameters.
2016-11-27 04:25:08,246 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-27 04:25:08,246 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-27 04:25:08,246 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-27 04:25:08,246 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-27 04:25:08,247 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-27 04:25:08,247 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-27 04:25:08,247 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2016-11-27 04:25:33,701 _log_update: [200] (8.4 %) of epoch 1 -- lr = 5, cost = 10.40, duration = 6.6 ms
2016-11-27 04:25:46,989 _log_update: [400] (16.9 %) of epoch 1 -- lr = 5, cost = 6.05, duration = 6.6 ms
2016-11-27 04:26:00,318 _log_update: [600] (25.3 %) of epoch 1 -- lr = 5, cost = 5.36, duration = 6.6 ms
2016-11-27 04:26:13,629 _log_update: [800] (33.7 %) of epoch 1 -- lr = 5, cost = 5.88, duration = 6.6 ms
2016-11-27 04:26:26,922 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 5, cost = 5.30, duration = 6.6 ms
2016-11-27 04:26:40,222 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 5, cost = 5.23, duration = 6.5 ms
2016-11-27 04:26:53,505 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 5, cost = 4.85, duration = 6.6 ms
2016-11-27 04:27:06,804 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 5, cost = 4.81, duration = 6.9 ms
2016-11-27 04:27:20,103 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 5, cost = 4.84, duration = 6.6 ms
2016-11-27 04:27:33,399 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 5, cost = 4.78, duration = 6.5 ms
2016-11-27 04:27:46,695 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 5, cost = 4.44, duration = 6.6 ms
2016-11-27 04:28:04,666 _validate: [2365] First validation sample, perplexity 347.37.
2016-11-27 04:28:25,844 _validate: [2368] Center of validation, perplexity 395.00.
2016-11-27 04:28:47,083 _validate: [2371] Last validation sample, perplexity 344.81.
2016-11-27 04:28:47,111 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 04:28:47,111 _log_validation: [2371] Validation set cost history: [344.8]
2016-11-27 04:28:47,112 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 3.4 minutes. Best validation perplexity 344.81.
2016-11-27 04:28:49,053 _log_update: [29] (1.2 %) of epoch 2 -- lr = 5, cost = 4.58, duration = 6.6 ms
2016-11-27 04:29:02,352 _log_update: [229] (9.7 %) of epoch 2 -- lr = 5, cost = 4.58, duration = 6.6 ms
2016-11-27 04:29:15,643 _log_update: [429] (18.1 %) of epoch 2 -- lr = 5, cost = 4.86, duration = 6.5 ms
2016-11-27 04:29:28,931 _log_update: [629] (26.5 %) of epoch 2 -- lr = 5, cost = 4.44, duration = 6.6 ms
2016-11-27 04:29:42,221 _log_update: [829] (35.0 %) of epoch 2 -- lr = 5, cost = 4.71, duration = 6.5 ms
2016-11-27 04:29:55,508 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 5, cost = 4.59, duration = 6.6 ms
2016-11-27 04:30:08,805 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 5, cost = 4.53, duration = 6.6 ms
2016-11-27 04:30:22,097 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 5, cost = 4.30, duration = 6.6 ms
2016-11-27 04:30:35,399 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 5, cost = 4.66, duration = 6.6 ms
2016-11-27 04:30:48,696 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 5, cost = 4.32, duration = 6.6 ms
2016-11-27 04:31:02,014 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 5, cost = 4.28, duration = 6.9 ms
2016-11-27 04:31:15,324 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 5, cost = 4.20, duration = 6.6 ms
2016-11-27 04:31:31,330 _validate: [2365] First validation sample, perplexity 240.49.
2016-11-27 04:31:52,508 _validate: [2368] Center of validation, perplexity 252.62.
2016-11-27 04:32:13,694 _validate: [2371] Last validation sample, perplexity 244.60.
2016-11-27 04:32:13,712 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 04:32:13,712 _log_validation: [2371] Validation set cost history: 344.8 [244.6]
2016-11-27 04:32:13,713 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 3.4 minutes. Best validation perplexity 244.60.
2016-11-27 04:32:17,575 _log_update: [58] (2.4 %) of epoch 3 -- lr = 5, cost = 4.25, duration = 6.6 ms
2016-11-27 04:32:30,871 _log_update: [258] (10.9 %) of epoch 3 -- lr = 5, cost = 3.99, duration = 6.7 ms
2016-11-27 04:32:44,160 _log_update: [458] (19.3 %) of epoch 3 -- lr = 5, cost = 4.46, duration = 6.6 ms
2016-11-27 04:32:57,452 _log_update: [658] (27.8 %) of epoch 3 -- lr = 5, cost = 4.19, duration = 6.9 ms
2016-11-27 04:33:10,741 _log_update: [858] (36.2 %) of epoch 3 -- lr = 5, cost = 3.94, duration = 6.6 ms
2016-11-27 04:33:24,035 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 5, cost = 4.07, duration = 6.6 ms
2016-11-27 04:33:37,321 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 5, cost = 4.05, duration = 6.6 ms
2016-11-27 04:33:50,602 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 5, cost = 3.99, duration = 6.6 ms
2016-11-27 04:34:03,893 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 5, cost = 3.94, duration = 6.6 ms
2016-11-27 04:34:17,193 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 5, cost = 4.01, duration = 6.9 ms
2016-11-27 04:34:30,482 _log_update: [2058] (86.8 %) of epoch 3 -- lr = 5, cost = 3.76, duration = 6.6 ms
2016-11-27 04:34:43,766 _log_update: [2258] (95.2 %) of epoch 3 -- lr = 5, cost = 4.08, duration = 6.6 ms
2016-11-27 04:34:57,844 _validate: [2365] First validation sample, perplexity 206.75.
2016-11-27 04:35:19,002 _validate: [2368] Center of validation, perplexity 212.20.
2016-11-27 04:35:40,207 _validate: [2371] Last validation sample, perplexity 208.02.
2016-11-27 04:35:40,223 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 04:35:40,224 _log_validation: [2371] Validation set cost history: 344.8 244.6 [201.0]
2016-11-27 04:35:40,225 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 3.4 minutes. Best validation perplexity 200.96.
2016-11-27 04:35:46,012 _log_update: [87] (3.7 %) of epoch 4 -- lr = 5, cost = 3.94, duration = 6.6 ms
2016-11-27 04:35:59,320 _log_update: [287] (12.1 %) of epoch 4 -- lr = 5, cost = 4.20, duration = 6.6 ms
2016-11-27 04:36:12,617 _log_update: [487] (20.5 %) of epoch 4 -- lr = 5, cost = 3.95, duration = 6.9 ms
2016-11-27 04:36:25,910 _log_update: [687] (29.0 %) of epoch 4 -- lr = 5, cost = 3.95, duration = 6.6 ms
2016-11-27 04:36:39,265 _log_update: [887] (37.4 %) of epoch 4 -- lr = 5, cost = 3.95, duration = 6.5 ms
2016-11-27 04:36:52,565 _log_update: [1087] (45.8 %) of epoch 4 -- lr = 5, cost = 4.13, duration = 6.5 ms
2016-11-27 04:37:05,865 _log_update: [1287] (54.3 %) of epoch 4 -- lr = 5, cost = 3.90, duration = 6.6 ms
2016-11-27 04:37:19,158 _log_update: [1487] (62.7 %) of epoch 4 -- lr = 5, cost = 4.18, duration = 6.6 ms
2016-11-27 04:37:32,449 _log_update: [1687] (71.2 %) of epoch 4 -- lr = 5, cost = 4.00, duration = 6.6 ms
2016-11-27 04:37:45,725 _log_update: [1887] (79.6 %) of epoch 4 -- lr = 5, cost = 3.94, duration = 6.6 ms
2016-11-27 04:37:59,006 _log_update: [2087] (88.0 %) of epoch 4 -- lr = 5, cost = 3.93, duration = 6.6 ms
2016-11-27 04:38:12,297 _log_update: [2287] (96.5 %) of epoch 4 -- lr = 5, cost = 3.82, duration = 6.6 ms
2016-11-27 04:38:24,427 _validate: [2365] First validation sample, perplexity 174.23.
2016-11-27 04:38:45,569 _validate: [2368] Center of validation, perplexity 182.11.
2016-11-27 04:39:06,740 _validate: [2371] Last validation sample, perplexity 191.39.
2016-11-27 04:39:06,756 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 04:39:06,756 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 [185.5]
2016-11-27 04:39:06,757 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 3.4 minutes. Best validation perplexity 185.47.
2016-11-27 04:39:14,470 _log_update: [116] (4.9 %) of epoch 5 -- lr = 5, cost = 4.09, duration = 6.6 ms
2016-11-27 04:39:27,757 _log_update: [316] (13.3 %) of epoch 5 -- lr = 5, cost = 3.71, duration = 6.6 ms
2016-11-27 04:39:41,057 _log_update: [516] (21.8 %) of epoch 5 -- lr = 5, cost = 4.08, duration = 6.5 ms
2016-11-27 04:39:54,347 _log_update: [716] (30.2 %) of epoch 5 -- lr = 5, cost = 4.04, duration = 6.6 ms
2016-11-27 04:40:07,654 _log_update: [916] (38.6 %) of epoch 5 -- lr = 5, cost = 3.84, duration = 6.6 ms
2016-11-27 04:40:20,950 _log_update: [1116] (47.1 %) of epoch 5 -- lr = 5, cost = 3.87, duration = 6.6 ms
2016-11-27 04:40:34,254 _log_update: [1316] (55.5 %) of epoch 5 -- lr = 5, cost = 3.71, duration = 6.8 ms
2016-11-27 04:40:47,539 _log_update: [1516] (63.9 %) of epoch 5 -- lr = 5, cost = 4.01, duration = 6.8 ms
2016-11-27 04:41:00,904 _log_update: [1716] (72.4 %) of epoch 5 -- lr = 5, cost = 3.68, duration = 6.7 ms
2016-11-27 04:41:14,187 _log_update: [1916] (80.8 %) of epoch 5 -- lr = 5, cost = 3.82, duration = 6.6 ms
2016-11-27 04:41:27,472 _log_update: [2116] (89.2 %) of epoch 5 -- lr = 5, cost = 3.80, duration = 6.5 ms
2016-11-27 04:41:40,759 _log_update: [2316] (97.7 %) of epoch 5 -- lr = 5, cost = 3.68, duration = 6.5 ms
2016-11-27 04:41:50,991 _validate: [2365] First validation sample, perplexity 166.04.
2016-11-27 04:42:12,187 _validate: [2368] Center of validation, perplexity 173.40.
2016-11-27 04:42:33,352 _validate: [2371] Last validation sample, perplexity 167.30.
2016-11-27 04:42:33,368 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 04:42:33,368 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 [167.3]
2016-11-27 04:42:33,369 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 3.4 minutes. Best validation perplexity 167.30.
2016-11-27 04:42:43,000 _log_update: [145] (6.1 %) of epoch 6 -- lr = 5, cost = 3.67, duration = 6.6 ms
2016-11-27 04:42:56,283 _log_update: [345] (14.6 %) of epoch 6 -- lr = 5, cost = 3.76, duration = 6.6 ms
2016-11-27 04:43:09,575 _log_update: [545] (23.0 %) of epoch 6 -- lr = 5, cost = 3.87, duration = 6.6 ms
2016-11-27 04:43:22,852 _log_update: [745] (31.4 %) of epoch 6 -- lr = 5, cost = 4.07, duration = 6.5 ms
2016-11-27 04:43:36,195 _log_update: [945] (39.9 %) of epoch 6 -- lr = 5, cost = 4.02, duration = 6.9 ms
2016-11-27 04:43:49,485 _log_update: [1145] (48.3 %) of epoch 6 -- lr = 5, cost = 3.74, duration = 6.6 ms
2016-11-27 04:44:02,815 _log_update: [1345] (56.7 %) of epoch 6 -- lr = 5, cost = 3.44, duration = 6.6 ms
2016-11-27 04:44:16,113 _log_update: [1545] (65.2 %) of epoch 6 -- lr = 5, cost = 4.05, duration = 6.6 ms
2016-11-27 04:44:29,409 _log_update: [1745] (73.6 %) of epoch 6 -- lr = 5, cost = 4.03, duration = 6.6 ms
2016-11-27 04:44:42,696 _log_update: [1945] (82.0 %) of epoch 6 -- lr = 5, cost = 3.97, duration = 6.5 ms
2016-11-27 04:44:56,015 _log_update: [2145] (90.5 %) of epoch 6 -- lr = 5, cost = 3.53, duration = 6.7 ms
2016-11-27 04:45:09,417 _log_update: [2345] (98.9 %) of epoch 6 -- lr = 5, cost = 3.66, duration = 6.7 ms
2016-11-27 04:45:17,975 _validate: [2365] First validation sample, perplexity 174.71.
2016-11-27 04:45:39,116 _validate: [2368] Center of validation, perplexity 165.99.
2016-11-27 04:46:00,319 _validate: [2371] Last validation sample, perplexity 156.08.
2016-11-27 04:46:00,334 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 04:46:00,334 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 [160.1]
2016-11-27 04:46:00,335 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 3.4 minutes. Best validation perplexity 160.14.
2016-11-27 04:46:11,926 _log_update: [174] (7.3 %) of epoch 7 -- lr = 5, cost = 3.38, duration = 6.5 ms
2016-11-27 04:46:25,213 _log_update: [374] (15.8 %) of epoch 7 -- lr = 5, cost = 3.92, duration = 6.6 ms
2016-11-27 04:46:38,507 _log_update: [574] (24.2 %) of epoch 7 -- lr = 5, cost = 3.55, duration = 6.6 ms
2016-11-27 04:46:51,796 _log_update: [774] (32.6 %) of epoch 7 -- lr = 5, cost = 3.82, duration = 6.9 ms
2016-11-27 04:47:05,087 _log_update: [974] (41.1 %) of epoch 7 -- lr = 5, cost = 3.54, duration = 6.5 ms
2016-11-27 04:47:18,369 _log_update: [1174] (49.5 %) of epoch 7 -- lr = 5, cost = 3.59, duration = 6.6 ms
2016-11-27 04:47:31,661 _log_update: [1374] (58.0 %) of epoch 7 -- lr = 5, cost = 3.61, duration = 6.6 ms
2016-11-27 04:47:44,962 _log_update: [1574] (66.4 %) of epoch 7 -- lr = 5, cost = 3.65, duration = 6.6 ms
2016-11-27 04:47:58,245 _log_update: [1774] (74.8 %) of epoch 7 -- lr = 5, cost = 3.62, duration = 6.6 ms
2016-11-27 04:48:11,555 _log_update: [1974] (83.3 %) of epoch 7 -- lr = 5, cost = 3.74, duration = 6.6 ms
2016-11-27 04:48:24,846 _log_update: [2174] (91.7 %) of epoch 7 -- lr = 5, cost = 3.91, duration = 6.6 ms
2016-11-27 04:48:44,504 _validate: [2365] First validation sample, perplexity 207.57.
2016-11-27 04:49:05,651 _validate: [2368] Center of validation, perplexity 169.61.
2016-11-27 04:49:26,809 _validate: [2371] Last validation sample, perplexity 155.82.
2016-11-27 04:49:26,809 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 [160.1] 169.6
2016-11-27 04:49:26,810 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-27 04:49:26,810 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-27 04:49:26,811 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-27 04:49:26,812 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-27 04:49:26,815 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-27 04:49:26,816 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-27 04:49:26,817 _reset_state: [2368] (99.87 %) of epoch 6
2016-11-27 04:49:26,817 _log_validation: [2368] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 [160.1]
2016-11-27 04:49:26,817 set_state: Restored iterator to line 42029 of 42068.
2016-11-27 04:49:26,821 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-27 04:49:26,821 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-27 04:49:26,822 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-27 04:49:26,822 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-27 04:49:26,823 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-27 04:49:26,824 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 6.
2016-11-27 04:49:26,825 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 3.4 minutes. Best validation perplexity 160.14.
2016-11-27 04:49:27,031 _log_update: [3] (0.1 %) of epoch 7 -- lr = 2, cost = 3.49, duration = 6.6 ms
2016-11-27 04:49:40,301 _log_update: [203] (8.6 %) of epoch 7 -- lr = 2, cost = 3.70, duration = 6.6 ms
2016-11-27 04:49:53,590 _log_update: [403] (17.0 %) of epoch 7 -- lr = 2, cost = 3.58, duration = 6.6 ms
2016-11-27 04:50:06,882 _log_update: [603] (25.4 %) of epoch 7 -- lr = 2, cost = 3.62, duration = 6.6 ms
2016-11-27 04:50:20,168 _log_update: [803] (33.9 %) of epoch 7 -- lr = 2, cost = 3.67, duration = 6.9 ms
2016-11-27 04:50:33,463 _log_update: [1003] (42.3 %) of epoch 7 -- lr = 2, cost = 3.43, duration = 6.7 ms
2016-11-27 04:50:46,749 _log_update: [1203] (50.7 %) of epoch 7 -- lr = 2, cost = 3.65, duration = 6.6 ms
2016-11-27 04:51:00,039 _log_update: [1403] (59.2 %) of epoch 7 -- lr = 2, cost = 3.80, duration = 6.6 ms
2016-11-27 04:51:13,332 _log_update: [1603] (67.6 %) of epoch 7 -- lr = 2, cost = 3.39, duration = 6.5 ms
2016-11-27 04:51:26,621 _log_update: [1803] (76.0 %) of epoch 7 -- lr = 2, cost = 3.39, duration = 6.6 ms
2016-11-27 04:51:39,904 _log_update: [2003] (84.5 %) of epoch 7 -- lr = 2, cost = 3.43, duration = 6.5 ms
2016-11-27 04:51:53,179 _log_update: [2203] (92.9 %) of epoch 7 -- lr = 2, cost = 3.61, duration = 6.6 ms
2016-11-27 04:52:10,932 _validate: [2365] First validation sample, perplexity 142.02.
2016-11-27 04:52:32,027 _validate: [2368] Center of validation, perplexity 144.86.
2016-11-27 04:52:53,148 _validate: [2371] Last validation sample, perplexity 166.55.
2016-11-27 04:52:53,163 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 04:52:53,163 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 [144.9]
2016-11-27 04:52:53,164 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 3.4 minutes. Best validation perplexity 144.86.
2016-11-27 04:52:55,299 _log_update: [32] (1.3 %) of epoch 8 -- lr = 2, cost = 3.51, duration = 6.6 ms
2016-11-27 04:53:08,598 _log_update: [232] (9.8 %) of epoch 8 -- lr = 2, cost = 3.42, duration = 6.6 ms
2016-11-27 04:53:21,893 _log_update: [432] (18.2 %) of epoch 8 -- lr = 2, cost = 3.45, duration = 6.5 ms
2016-11-27 04:53:35,175 _log_update: [632] (26.7 %) of epoch 8 -- lr = 2, cost = 3.53, duration = 6.7 ms
2016-11-27 04:53:48,455 _log_update: [832] (35.1 %) of epoch 8 -- lr = 2, cost = 3.23, duration = 6.5 ms
2016-11-27 04:54:01,747 _log_update: [1032] (43.5 %) of epoch 8 -- lr = 2, cost = 3.63, duration = 6.6 ms
2016-11-27 04:54:15,042 _log_update: [1232] (52.0 %) of epoch 8 -- lr = 2, cost = 3.23, duration = 6.7 ms
2016-11-27 04:54:28,335 _log_update: [1432] (60.4 %) of epoch 8 -- lr = 2, cost = 3.54, duration = 6.7 ms
2016-11-27 04:54:41,614 _log_update: [1632] (68.8 %) of epoch 8 -- lr = 2, cost = 3.50, duration = 6.6 ms
2016-11-27 04:54:54,895 _log_update: [1832] (77.3 %) of epoch 8 -- lr = 2, cost = 3.28, duration = 6.5 ms
2016-11-27 04:55:08,181 _log_update: [2032] (85.7 %) of epoch 8 -- lr = 2, cost = 3.68, duration = 6.6 ms
2016-11-27 04:55:21,469 _log_update: [2232] (94.1 %) of epoch 8 -- lr = 2, cost = 3.60, duration = 6.9 ms
2016-11-27 04:55:37,294 _validate: [2365] First validation sample, perplexity 147.92.
2016-11-27 04:55:58,451 _validate: [2368] Center of validation, perplexity 145.48.
2016-11-27 04:56:19,673 _validate: [2371] Last validation sample, perplexity 141.41.
2016-11-27 04:56:19,688 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 04:56:19,688 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 [142.0]
2016-11-27 04:56:19,689 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 3.4 minutes. Best validation perplexity 142.02.
2016-11-27 04:56:23,751 _log_update: [61] (2.6 %) of epoch 9 -- lr = 2, cost = 3.51, duration = 6.6 ms
2016-11-27 04:56:37,035 _log_update: [261] (11.0 %) of epoch 9 -- lr = 2, cost = 3.46, duration = 6.6 ms
2016-11-27 04:56:50,318 _log_update: [461] (19.4 %) of epoch 9 -- lr = 2, cost = 3.36, duration = 6.5 ms
2016-11-27 04:57:03,621 _log_update: [661] (27.9 %) of epoch 9 -- lr = 2, cost = 3.49, duration = 6.6 ms
2016-11-27 04:57:16,910 _log_update: [861] (36.3 %) of epoch 9 -- lr = 2, cost = 3.55, duration = 6.9 ms
2016-11-27 04:57:30,197 _log_update: [1061] (44.7 %) of epoch 9 -- lr = 2, cost = 3.41, duration = 6.6 ms
2016-11-27 04:57:43,478 _log_update: [1261] (53.2 %) of epoch 9 -- lr = 2, cost = 3.46, duration = 6.6 ms
2016-11-27 04:57:56,760 _log_update: [1461] (61.6 %) of epoch 9 -- lr = 2, cost = 3.75, duration = 6.5 ms
2016-11-27 04:58:10,064 _log_update: [1661] (70.1 %) of epoch 9 -- lr = 2, cost = 3.60, duration = 6.5 ms
2016-11-27 04:58:23,348 _log_update: [1861] (78.5 %) of epoch 9 -- lr = 2, cost = 3.30, duration = 6.5 ms
2016-11-27 04:58:36,630 _log_update: [2061] (86.9 %) of epoch 9 -- lr = 2, cost = 3.23, duration = 6.9 ms
2016-11-27 04:58:49,919 _log_update: [2261] (95.4 %) of epoch 9 -- lr = 2, cost = 3.42, duration = 6.5 ms
2016-11-27 04:59:03,813 _validate: [2365] First validation sample, perplexity 141.00.
2016-11-27 04:59:24,953 _validate: [2368] Center of validation, perplexity 138.42.
2016-11-27 04:59:46,115 _validate: [2371] Last validation sample, perplexity 145.27.
2016-11-27 04:59:46,131 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 04:59:46,131 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 [139.5]
2016-11-27 04:59:46,132 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 3.4 minutes. Best validation perplexity 139.54.
2016-11-27 04:59:52,125 _log_update: [90] (3.8 %) of epoch 10 -- lr = 2, cost = 3.21, duration = 6.6 ms
2016-11-27 05:00:05,421 _log_update: [290] (12.2 %) of epoch 10 -- lr = 2, cost = 3.19, duration = 6.6 ms
2016-11-27 05:00:18,697 _log_update: [490] (20.7 %) of epoch 10 -- lr = 2, cost = 3.34, duration = 6.6 ms
2016-11-27 05:00:31,973 _log_update: [690] (29.1 %) of epoch 10 -- lr = 2, cost = 3.31, duration = 6.5 ms
2016-11-27 05:00:45,267 _log_update: [890] (37.5 %) of epoch 10 -- lr = 2, cost = 3.31, duration = 6.8 ms
2016-11-27 05:00:58,582 _log_update: [1090] (46.0 %) of epoch 10 -- lr = 2, cost = 2.98, duration = 6.6 ms
2016-11-27 05:01:11,887 _log_update: [1290] (54.4 %) of epoch 10 -- lr = 2, cost = 3.64, duration = 6.6 ms
2016-11-27 05:01:25,184 _log_update: [1490] (62.8 %) of epoch 10 -- lr = 2, cost = 3.32, duration = 6.6 ms
2016-11-27 05:01:38,470 _log_update: [1690] (71.3 %) of epoch 10 -- lr = 2, cost = 3.29, duration = 6.6 ms
2016-11-27 05:01:51,757 _log_update: [1890] (79.7 %) of epoch 10 -- lr = 2, cost = 3.52, duration = 6.6 ms
2016-11-27 05:02:05,053 _log_update: [2090] (88.1 %) of epoch 10 -- lr = 2, cost = 3.41, duration = 6.6 ms
2016-11-27 05:02:18,354 _log_update: [2290] (96.6 %) of epoch 10 -- lr = 2, cost = 3.46, duration = 6.6 ms
2016-11-27 05:02:30,309 _validate: [2365] First validation sample, perplexity 138.28.
2016-11-27 05:02:51,448 _validate: [2368] Center of validation, perplexity 138.65.
2016-11-27 05:03:12,622 _validate: [2371] Last validation sample, perplexity 140.35.
2016-11-27 05:03:12,638 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 05:03:12,638 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 139.5 [138.6]
2016-11-27 05:03:12,639 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 3.4 minutes. Best validation perplexity 138.65.
2016-11-27 05:03:20,562 _log_update: [119] (5.0 %) of epoch 11 -- lr = 2, cost = 3.05, duration = 6.6 ms
2016-11-27 05:03:33,849 _log_update: [319] (13.5 %) of epoch 11 -- lr = 2, cost = 3.24, duration = 6.6 ms
2016-11-27 05:03:47,141 _log_update: [519] (21.9 %) of epoch 11 -- lr = 2, cost = 3.49, duration = 6.6 ms
2016-11-27 05:04:00,439 _log_update: [719] (30.3 %) of epoch 11 -- lr = 2, cost = 3.10, duration = 6.5 ms
2016-11-27 05:04:13,741 _log_update: [919] (38.8 %) of epoch 11 -- lr = 2, cost = 3.27, duration = 6.5 ms
2016-11-27 05:04:27,036 _log_update: [1119] (47.2 %) of epoch 11 -- lr = 2, cost = 3.30, duration = 6.5 ms
2016-11-27 05:04:40,321 _log_update: [1319] (55.6 %) of epoch 11 -- lr = 2, cost = 3.42, duration = 6.5 ms
2016-11-27 05:04:53,606 _log_update: [1519] (64.1 %) of epoch 11 -- lr = 2, cost = 3.41, duration = 6.6 ms
2016-11-27 05:05:06,895 _log_update: [1719] (72.5 %) of epoch 11 -- lr = 2, cost = 3.27, duration = 6.5 ms
2016-11-27 05:05:20,200 _log_update: [1919] (80.9 %) of epoch 11 -- lr = 2, cost = 3.30, duration = 6.9 ms
2016-11-27 05:05:33,491 _log_update: [2119] (89.4 %) of epoch 11 -- lr = 2, cost = 3.13, duration = 6.6 ms
2016-11-27 05:05:46,788 _log_update: [2319] (97.8 %) of epoch 11 -- lr = 2, cost = 3.58, duration = 6.5 ms
2016-11-27 05:05:56,830 _validate: [2365] First validation sample, perplexity 138.88.
2016-11-27 05:06:18,015 _validate: [2368] Center of validation, perplexity 142.18.
2016-11-27 05:06:39,186 _validate: [2371] Last validation sample, perplexity 143.88.
2016-11-27 05:06:39,187 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 139.5 [138.6] 141.5
2016-11-27 05:06:39,187 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-27 05:06:39,188 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-27 05:06:39,189 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-27 05:06:39,189 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-27 05:06:39,192 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-27 05:06:39,193 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-27 05:06:39,194 _reset_state: [2368] (99.87 %) of epoch 10
2016-11-27 05:06:39,194 _log_validation: [2368] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 139.5 [138.6]
2016-11-27 05:06:39,195 set_state: Restored iterator to line 42027 of 42068.
2016-11-27 05:06:39,198 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-27 05:06:39,199 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-27 05:06:39,199 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-27 05:06:39,200 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-27 05:06:39,200 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-27 05:06:39,201 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 10.
2016-11-27 05:06:39,203 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 3.4 minutes. Best validation perplexity 138.65.
2016-11-27 05:06:49,044 _log_update: [148] (6.2 %) of epoch 11 -- lr = 1, cost = 3.20, duration = 6.5 ms
2016-11-27 05:07:02,347 _log_update: [348] (14.7 %) of epoch 11 -- lr = 1, cost = 3.41, duration = 6.9 ms
2016-11-27 05:07:15,624 _log_update: [548] (23.1 %) of epoch 11 -- lr = 1, cost = 3.17, duration = 6.8 ms
2016-11-27 05:07:28,937 _log_update: [748] (31.5 %) of epoch 11 -- lr = 1, cost = 3.20, duration = 6.5 ms
2016-11-27 05:07:42,234 _log_update: [948] (40.0 %) of epoch 11 -- lr = 1, cost = 3.29, duration = 6.5 ms
2016-11-27 05:07:55,536 _log_update: [1148] (48.4 %) of epoch 11 -- lr = 1, cost = 3.01, duration = 6.6 ms
2016-11-27 05:08:08,889 _log_update: [1348] (56.9 %) of epoch 11 -- lr = 1, cost = 3.44, duration = 6.9 ms
2016-11-27 05:08:22,184 _log_update: [1548] (65.3 %) of epoch 11 -- lr = 1, cost = 3.31, duration = 6.6 ms
2016-11-27 05:08:35,465 _log_update: [1748] (73.7 %) of epoch 11 -- lr = 1, cost = 3.19, duration = 6.6 ms
2016-11-27 05:08:48,751 _log_update: [1948] (82.2 %) of epoch 11 -- lr = 1, cost = 3.43, duration = 6.5 ms
2016-11-27 05:09:02,038 _log_update: [2148] (90.6 %) of epoch 11 -- lr = 1, cost = 3.56, duration = 6.5 ms
2016-11-27 05:09:15,322 _log_update: [2348] (99.0 %) of epoch 11 -- lr = 1, cost = 3.10, duration = 6.5 ms
2016-11-27 05:09:23,414 _validate: [2365] First validation sample, perplexity 135.18.
2016-11-27 05:09:44,554 _validate: [2368] Center of validation, perplexity 137.81.
2016-11-27 05:10:05,738 _validate: [2371] Last validation sample, perplexity 138.21.
2016-11-27 05:10:05,753 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 05:10:05,753 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 139.5 138.6 [137.8]
2016-11-27 05:10:05,754 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 3.4 minutes. Best validation perplexity 137.81.
2016-11-27 05:10:17,524 _log_update: [177] (7.5 %) of epoch 12 -- lr = 1, cost = 3.21, duration = 6.8 ms
2016-11-27 05:10:30,820 _log_update: [377] (15.9 %) of epoch 12 -- lr = 1, cost = 3.10, duration = 6.6 ms
2016-11-27 05:10:44,114 _log_update: [577] (24.3 %) of epoch 12 -- lr = 1, cost = 3.41, duration = 6.5 ms
2016-11-27 05:10:57,417 _log_update: [777] (32.8 %) of epoch 12 -- lr = 1, cost = 3.13, duration = 6.5 ms
2016-11-27 05:11:10,717 _log_update: [977] (41.2 %) of epoch 12 -- lr = 1, cost = 3.08, duration = 6.5 ms
2016-11-27 05:11:24,007 _log_update: [1177] (49.6 %) of epoch 12 -- lr = 1, cost = 3.39, duration = 6.5 ms
2016-11-27 05:11:37,295 _log_update: [1377] (58.1 %) of epoch 12 -- lr = 1, cost = 3.53, duration = 6.5 ms
2016-11-27 05:11:50,580 _log_update: [1577] (66.5 %) of epoch 12 -- lr = 1, cost = 3.47, duration = 6.6 ms
2016-11-27 05:12:03,877 _log_update: [1777] (74.9 %) of epoch 12 -- lr = 1, cost = 3.47, duration = 6.5 ms
2016-11-27 05:12:17,178 _log_update: [1977] (83.4 %) of epoch 12 -- lr = 1, cost = 3.23, duration = 6.6 ms
2016-11-27 05:12:30,467 _log_update: [2177] (91.8 %) of epoch 12 -- lr = 1, cost = 3.27, duration = 6.6 ms
2016-11-27 05:12:49,919 _validate: [2365] First validation sample, perplexity 138.45.
2016-11-27 05:13:11,011 _validate: [2368] Center of validation, perplexity 138.33.
2016-11-27 05:13:32,103 _validate: [2371] Last validation sample, perplexity 137.57.
2016-11-27 05:13:32,104 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 139.5 138.6 [137.8] 138.5
2016-11-27 05:13:32,104 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-27 05:13:32,105 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-27 05:13:32,106 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-27 05:13:32,106 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-27 05:13:32,109 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-27 05:13:32,110 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-27 05:13:32,111 _reset_state: [2368] (99.87 %) of epoch 11
2016-11-27 05:13:32,111 _log_validation: [2368] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 139.5 138.6 [137.8]
2016-11-27 05:13:32,112 set_state: Restored iterator to line 42021 of 42068.
2016-11-27 05:13:32,115 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-27 05:13:32,116 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-27 05:13:32,116 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-27 05:13:32,116 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-27 05:13:32,117 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-27 05:13:32,118 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 11.
2016-11-27 05:13:32,119 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 3.4 minutes. Best validation perplexity 137.81.
2016-11-27 05:13:32,525 _log_update: [6] (0.3 %) of epoch 12 -- lr = 0.6, cost = 3.22, duration = 6.5 ms
2016-11-27 05:13:45,798 _log_update: [206] (8.7 %) of epoch 12 -- lr = 0.6, cost = 3.34, duration = 6.5 ms
2016-11-27 05:13:59,060 _log_update: [406] (17.1 %) of epoch 12 -- lr = 0.6, cost = 3.42, duration = 6.5 ms
2016-11-27 05:14:12,336 _log_update: [606] (25.6 %) of epoch 12 -- lr = 0.6, cost = 3.10, duration = 6.5 ms
2016-11-27 05:14:25,593 _log_update: [806] (34.0 %) of epoch 12 -- lr = 0.6, cost = 3.07, duration = 6.5 ms
2016-11-27 05:14:38,849 _log_update: [1006] (42.4 %) of epoch 12 -- lr = 0.6, cost = 3.06, duration = 6.5 ms
2016-11-27 05:14:52,092 _log_update: [1206] (50.9 %) of epoch 12 -- lr = 0.6, cost = 3.12, duration = 6.5 ms
2016-11-27 05:15:05,349 _log_update: [1406] (59.3 %) of epoch 12 -- lr = 0.6, cost = 3.10, duration = 6.5 ms
2016-11-27 05:15:18,603 _log_update: [1606] (67.7 %) of epoch 12 -- lr = 0.6, cost = 3.02, duration = 6.5 ms
2016-11-27 05:15:31,853 _log_update: [1806] (76.2 %) of epoch 12 -- lr = 0.6, cost = 3.38, duration = 6.5 ms
2016-11-27 05:15:45,124 _log_update: [2006] (84.6 %) of epoch 12 -- lr = 0.6, cost = 3.15, duration = 6.5 ms
2016-11-27 05:15:58,384 _log_update: [2206] (93.0 %) of epoch 12 -- lr = 0.6, cost = 3.26, duration = 6.5 ms
2016-11-27 05:16:15,876 _validate: [2365] First validation sample, perplexity 134.13.
2016-11-27 05:16:36,905 _validate: [2368] Center of validation, perplexity 134.07.
2016-11-27 05:16:58,019 _validate: [2371] Last validation sample, perplexity 135.91.
2016-11-27 05:16:58,034 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-27 05:16:58,034 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 139.5 138.6 137.8 [134.3]
2016-11-27 05:16:58,035 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 3.4 minutes. Best validation perplexity 134.29.
2016-11-27 05:17:00,371 _log_update: [35] (1.5 %) of epoch 13 -- lr = 0.6, cost = 3.03, duration = 6.5 ms
2016-11-27 05:17:13,629 _log_update: [235] (9.9 %) of epoch 13 -- lr = 0.6, cost = 3.15, duration = 6.5 ms
2016-11-27 05:17:26,877 _log_update: [435] (18.3 %) of epoch 13 -- lr = 0.6, cost = 2.89, duration = 6.5 ms
2016-11-27 05:17:40,125 _log_update: [635] (26.8 %) of epoch 13 -- lr = 0.6, cost = 3.29, duration = 6.5 ms
2016-11-27 05:17:53,368 _log_update: [835] (35.2 %) of epoch 13 -- lr = 0.6, cost = 3.08, duration = 6.5 ms
2016-11-27 05:18:06,631 _log_update: [1035] (43.7 %) of epoch 13 -- lr = 0.6, cost = 3.25, duration = 6.5 ms
2016-11-27 05:18:19,874 _log_update: [1235] (52.1 %) of epoch 13 -- lr = 0.6, cost = 3.28, duration = 6.5 ms
2016-11-27 05:18:33,135 _log_update: [1435] (60.5 %) of epoch 13 -- lr = 0.6, cost = 3.08, duration = 6.5 ms
2016-11-27 05:18:46,429 _log_update: [1635] (69.0 %) of epoch 13 -- lr = 0.6, cost = 3.29, duration = 6.5 ms
2016-11-27 05:18:59,682 _log_update: [1835] (77.4 %) of epoch 13 -- lr = 0.6, cost = 3.23, duration = 6.5 ms
2016-11-27 05:19:12,947 _log_update: [2035] (85.8 %) of epoch 13 -- lr = 0.6, cost = 3.15, duration = 6.5 ms
2016-11-27 05:19:26,203 _log_update: [2235] (94.3 %) of epoch 13 -- lr = 0.6, cost = 3.30, duration = 6.6 ms
2016-11-27 05:19:41,760 _validate: [2365] First validation sample, perplexity 135.28.
2016-11-27 05:20:02,799 _validate: [2368] Center of validation, perplexity 135.09.
2016-11-27 05:20:23,934 _validate: [2371] Last validation sample, perplexity 135.35.
2016-11-27 05:20:23,934 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 139.5 138.6 137.8 [134.3] 135.3
2016-11-27 05:20:23,935 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-27 05:20:23,935 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-27 05:20:23,936 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-27 05:20:23,937 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-27 05:20:23,940 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-27 05:20:23,940 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-27 05:20:23,942 _reset_state: [2368] (99.87 %) of epoch 12
2016-11-27 05:20:23,942 _log_validation: [2368] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 139.5 138.6 137.8 [134.3]
2016-11-27 05:20:23,942 set_state: Restored iterator to line 42024 of 42068.
2016-11-27 05:20:23,945 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-27 05:20:23,946 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-27 05:20:23,946 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-27 05:20:23,947 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-27 05:20:23,948 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-27 05:20:23,949 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 0.625 to 0.3125 and resetting state to 100 % of epoch 12.
2016-11-27 05:20:23,950 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 3.4 minutes. Best validation perplexity 134.29.
2016-11-27 05:20:28,202 _log_update: [64] (2.7 %) of epoch 13 -- lr = 0.3, cost = 3.16, duration = 6.8 ms
2016-11-27 05:20:41,461 _log_update: [264] (11.1 %) of epoch 13 -- lr = 0.3, cost = 3.03, duration = 6.9 ms
2016-11-27 05:20:54,734 _log_update: [464] (19.6 %) of epoch 13 -- lr = 0.3, cost = 3.23, duration = 6.6 ms
2016-11-27 05:21:07,991 _log_update: [664] (28.0 %) of epoch 13 -- lr = 0.3, cost = 3.47, duration = 6.5 ms
2016-11-27 05:21:21,247 _log_update: [864] (36.4 %) of epoch 13 -- lr = 0.3, cost = 3.02, duration = 6.5 ms
2016-11-27 05:21:34,494 _log_update: [1064] (44.9 %) of epoch 13 -- lr = 0.3, cost = 3.23, duration = 6.5 ms
2016-11-27 05:21:47,744 _log_update: [1264] (53.3 %) of epoch 13 -- lr = 0.3, cost = 3.12, duration = 6.6 ms
2016-11-27 05:22:01,006 _log_update: [1464] (61.7 %) of epoch 13 -- lr = 0.3, cost = 3.09, duration = 6.5 ms
2016-11-27 05:22:14,251 _log_update: [1664] (70.2 %) of epoch 13 -- lr = 0.3, cost = 3.06, duration = 6.5 ms
2016-11-27 05:22:27,512 _log_update: [1864] (78.6 %) of epoch 13 -- lr = 0.3, cost = 3.18, duration = 6.5 ms
2016-11-27 05:22:40,761 _log_update: [2064] (87.1 %) of epoch 13 -- lr = 0.3, cost = 3.25, duration = 6.5 ms
2016-11-27 05:22:54,013 _log_update: [2264] (95.5 %) of epoch 13 -- lr = 0.3, cost = 3.10, duration = 6.5 ms
2016-11-27 05:23:07,651 _validate: [2365] First validation sample, perplexity 135.53.
2016-11-27 05:23:28,718 _validate: [2368] Center of validation, perplexity 135.84.
2016-11-27 05:23:49,770 _validate: [2371] Last validation sample, perplexity 135.01.
2016-11-27 05:23:49,770 _log_validation: [2371] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 139.5 138.6 137.8 [134.3] 135.6
2016-11-27 05:23:49,771 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-27 05:23:49,771 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-27 05:23:49,772 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-27 05:23:49,773 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-27 05:23:49,776 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-27 05:23:49,777 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-27 05:23:49,778 _reset_state: [2368] (99.87 %) of epoch 12
2016-11-27 05:23:49,778 _log_validation: [2368] Validation set cost history: 344.8 244.6 201.0 185.5 167.3 160.1 144.9 142.0 139.5 138.6 137.8 [134.3]
2016-11-27 05:23:49,778 set_state: Restored iterator to line 42024 of 42068.
2016-11-27 05:23:49,781 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-27 05:23:49,782 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-27 05:23:49,782 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-27 05:23:49,783 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-27 05:23:49,784 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-27 05:23:49,785 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 0.3125 to 0.15625 and resetting state to 100 % of epoch 12.
Finished training epoch 12 in 0 hours 3.4 minutes. Best validation perplexity 134.29.
Training finished in 0 hours 58.5 minutes.
2016-11-27 05:23:49,787 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-27 05:23:49,787 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-27 05:23:49,789 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-27 05:23:49,789 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-27 05:23:49,793 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-27 05:23:49,794 set_state: layers/output_layer/input/b <- array(10001,)
Best validation set perplexity: 134.070758632
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of predicted probabilities: 82430
Cross entropy (base e): 4.862664262582123
Perplexity: 129.3684147941217
