/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-22 09:34:15,044 train: TRAINING OPTIONS
2016-11-22 09:34:15,044 train: patience: 0
2016-11-22 09:34:15,044 train: batch_size: 24
2016-11-22 09:34:15,044 train: sequence_length: 25
2016-11-22 09:34:15,044 train: stopping_criterion: no-improvement
2016-11-22 09:34:15,044 train: strategy: local-mean
2016-11-22 09:34:15,044 train: max_annealing_count: 0
2016-11-22 09:34:15,044 train: min_epochs: 1
2016-11-22 09:34:15,044 train: validation_frequency: 1
2016-11-22 09:34:15,044 train: max_epochs: 15
2016-11-22 09:34:15,045 train: OPTIMIZATION OPTIONS
2016-11-22 09:34:15,045 train: epsilon: 1e-06
2016-11-22 09:34:15,045 train: ignore_unk: False
2016-11-22 09:34:15,045 train: gradient_decay_rate: 0.9
2016-11-22 09:34:15,045 train: cost_function: nce
2016-11-22 09:34:15,045 train: momentum: 0.9
2016-11-22 09:34:15,045 train: sqr_gradient_decay_rate: 0.999
2016-11-22 09:34:15,045 train: unk_penalty: None
2016-11-22 09:34:15,045 train: weights: [ 1.]
2016-11-22 09:34:15,045 train: max_gradient_norm: 5.0
2016-11-22 09:34:15,045 train: method: sgd
2016-11-22 09:34:15,045 train: learning_rate: 20.0
2016-11-22 09:34:15,045 train: num_noise_samples: 25
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-22 09:34:16,612 __init__: One epoch of training data contains 2371 mini-batch updates.
2016-11-22 09:34:16,612 __init__: Class unigram probabilities are in the range [0.000001, 0.052329].
2016-11-22 09:34:16,613 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-22 09:34:16,636 _reset: Generating a random order of input lines.
Building neural network.
2016-11-22 09:34:16,643 __init__: Creating layers.
2016-11-22 09:34:16,643 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-22 09:34:16,643 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-22 09:34:16,682 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-22 09:34:16,832 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-22 09:34:16,953 __init__: Initializing parameters.
2016-11-22 09:34:16,953 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-22 09:34:16,953 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-22 09:34:16,953 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-22 09:34:16,953 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-22 09:34:16,953 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-22 09:34:16,953 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-22 09:34:16,953 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer.
Training neural network.
2016-11-22 09:34:42,641 _log_update: [200] (8.4 %) of epoch 1 -- lr = 2e+01, cost = 2.57, duration = 7.9 ms
2016-11-22 09:34:58,589 _log_update: [400] (16.9 %) of epoch 1 -- lr = 2e+01, cost = 2.24, duration = 7.9 ms
2016-11-22 09:35:14,545 _log_update: [600] (25.3 %) of epoch 1 -- lr = 2e+01, cost = 2.23, duration = 7.9 ms
2016-11-22 09:35:30,496 _log_update: [800] (33.7 %) of epoch 1 -- lr = 2e+01, cost = 2.12, duration = 7.9 ms
2016-11-22 09:35:46,447 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 2e+01, cost = 1.90, duration = 7.9 ms
2016-11-22 09:36:02,417 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 2e+01, cost = 1.90, duration = 7.9 ms
2016-11-22 09:36:18,386 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 2e+01, cost = 2.06, duration = 7.9 ms
2016-11-22 09:36:34,354 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 2e+01, cost = 2.07, duration = 7.9 ms
2016-11-22 09:36:50,328 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 2e+01, cost = 1.87, duration = 7.9 ms
2016-11-22 09:37:06,299 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 2e+01, cost = 1.93, duration = 7.9 ms
2016-11-22 09:37:22,260 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 2e+01, cost = 1.78, duration = 7.9 ms
2016-11-22 09:37:42,135 _validate: [2362] First validation sample, perplexity 325.13.
2016-11-22 09:38:10,268 _validate: [2366] Center of validation, perplexity 313.08.
2016-11-22 09:38:45,471 _validate: [2371] Last validation sample, perplexity 359.57.
2016-11-22 09:38:45,499 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 09:38:45,499 _log_validation: [2371] Validation set cost history: [320.6]
2016-11-22 09:38:45,500 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 4.3 minutes. Best validation perplexity 320.56.
2016-11-22 09:38:47,821 _log_update: [29] (1.2 %) of epoch 2 -- lr = 2e+01, cost = 1.79, duration = 7.9 ms
2016-11-22 09:39:03,797 _log_update: [229] (9.7 %) of epoch 2 -- lr = 2e+01, cost = 1.89, duration = 7.9 ms
2016-11-22 09:39:19,760 _log_update: [429] (18.1 %) of epoch 2 -- lr = 2e+01, cost = 1.91, duration = 7.9 ms
2016-11-22 09:39:35,724 _log_update: [629] (26.5 %) of epoch 2 -- lr = 2e+01, cost = 1.58, duration = 7.9 ms
2016-11-22 09:39:51,684 _log_update: [829] (35.0 %) of epoch 2 -- lr = 2e+01, cost = 1.80, duration = 7.9 ms
2016-11-22 09:40:07,717 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 2e+01, cost = 1.94, duration = 8.0 ms
2016-11-22 09:40:23,778 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 2e+01, cost = 1.89, duration = 7.9 ms
2016-11-22 09:40:39,825 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 2e+01, cost = 1.65, duration = 8.0 ms
2016-11-22 09:40:55,911 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 2e+01, cost = 1.84, duration = 7.9 ms
2016-11-22 09:41:11,909 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 2e+01, cost = 1.70, duration = 7.8 ms
2016-11-22 09:41:27,876 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 2e+01, cost = 1.68, duration = 7.8 ms
2016-11-22 09:41:43,840 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 2e+01, cost = 1.70, duration = 7.9 ms
2016-11-22 09:42:01,415 _validate: [2362] First validation sample, perplexity 248.43.
2016-11-22 09:42:29,454 _validate: [2366] Center of validation, perplexity 242.35.
2016-11-22 09:43:04,523 _validate: [2371] Last validation sample, perplexity 247.02.
2016-11-22 09:43:04,540 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 09:43:04,541 _log_validation: [2371] Validation set cost history: 320.6 [246.2]
2016-11-22 09:43:04,542 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 4.3 minutes. Best validation perplexity 246.15.
2016-11-22 09:43:09,179 _log_update: [58] (2.4 %) of epoch 3 -- lr = 2e+01, cost = 1.69, duration = 7.9 ms
2016-11-22 09:43:25,137 _log_update: [258] (10.9 %) of epoch 3 -- lr = 2e+01, cost = 1.53, duration = 7.9 ms
2016-11-22 09:43:41,096 _log_update: [458] (19.3 %) of epoch 3 -- lr = 2e+01, cost = 1.57, duration = 7.9 ms
2016-11-22 09:43:57,054 _log_update: [658] (27.8 %) of epoch 3 -- lr = 2e+01, cost = 1.66, duration = 7.9 ms
2016-11-22 09:44:13,025 _log_update: [858] (36.2 %) of epoch 3 -- lr = 2e+01, cost = 1.43, duration = 7.9 ms
2016-11-22 09:44:28,985 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 2e+01, cost = 1.57, duration = 7.9 ms
2016-11-22 09:44:44,955 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 2e+01, cost = 1.36, duration = 7.9 ms
2016-11-22 09:45:01,007 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 2e+01, cost = 1.49, duration = 7.8 ms
2016-11-22 09:45:16,966 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 2e+01, cost = 1.72, duration = 7.9 ms
2016-11-22 09:45:33,177 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 2e+01, cost = 1.40, duration = 7.9 ms
2016-11-22 09:45:49,131 _log_update: [2058] (86.8 %) of epoch 3 -- lr = 2e+01, cost = 1.47, duration = 7.9 ms
2016-11-22 09:46:05,133 _log_update: [2258] (95.2 %) of epoch 3 -- lr = 2e+01, cost = 1.49, duration = 7.9 ms
2016-11-22 09:46:20,423 _validate: [2362] First validation sample, perplexity 216.25.
2016-11-22 09:46:48,466 _validate: [2366] Center of validation, perplexity 219.94.
2016-11-22 09:47:23,581 _validate: [2371] Last validation sample, perplexity 235.77.
2016-11-22 09:47:23,597 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 09:47:23,597 _log_validation: [2371] Validation set cost history: 320.6 246.2 [224.5]
2016-11-22 09:47:23,598 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 4.3 minutes. Best validation perplexity 224.52.
2016-11-22 09:47:30,542 _log_update: [87] (3.7 %) of epoch 4 -- lr = 2e+01, cost = 1.37, duration = 7.9 ms
2016-11-22 09:47:46,491 _log_update: [287] (12.1 %) of epoch 4 -- lr = 2e+01, cost = 1.66, duration = 7.9 ms
2016-11-22 09:48:02,471 _log_update: [487] (20.5 %) of epoch 4 -- lr = 2e+01, cost = 1.44, duration = 7.9 ms
2016-11-22 09:48:18,532 _log_update: [687] (29.0 %) of epoch 4 -- lr = 2e+01, cost = 1.61, duration = 7.9 ms
2016-11-22 09:48:34,569 _log_update: [887] (37.4 %) of epoch 4 -- lr = 2e+01, cost = 1.45, duration = 7.9 ms
2016-11-22 09:48:50,618 _log_update: [1087] (45.8 %) of epoch 4 -- lr = 2e+01, cost = 1.40, duration = 7.9 ms
2016-11-22 09:49:06,638 _log_update: [1287] (54.3 %) of epoch 4 -- lr = 2e+01, cost = 1.44, duration = 7.9 ms
2016-11-22 09:49:22,595 _log_update: [1487] (62.7 %) of epoch 4 -- lr = 2e+01, cost = 1.56, duration = 7.9 ms
2016-11-22 09:49:38,550 _log_update: [1687] (71.2 %) of epoch 4 -- lr = 2e+01, cost = 1.62, duration = 7.9 ms
2016-11-22 09:49:54,501 _log_update: [1887] (79.6 %) of epoch 4 -- lr = 2e+01, cost = 1.42, duration = 7.9 ms
2016-11-22 09:50:10,455 _log_update: [2087] (88.0 %) of epoch 4 -- lr = 2e+01, cost = 1.43, duration = 7.9 ms
2016-11-22 09:50:26,401 _log_update: [2287] (96.5 %) of epoch 4 -- lr = 2e+01, cost = 1.35, duration = 7.9 ms
2016-11-22 09:50:39,302 _validate: [2362] First validation sample, perplexity 218.49.
2016-11-22 09:51:07,384 _validate: [2366] Center of validation, perplexity 217.85.
2016-11-22 09:51:42,481 _validate: [2371] Last validation sample, perplexity 218.69.
2016-11-22 09:51:42,497 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 09:51:42,497 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 [216.7]
2016-11-22 09:51:42,498 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 4.3 minutes. Best validation perplexity 216.70.
2016-11-22 09:51:51,763 _log_update: [116] (4.9 %) of epoch 5 -- lr = 2e+01, cost = 1.60, duration = 7.9 ms
2016-11-22 09:52:07,722 _log_update: [316] (13.3 %) of epoch 5 -- lr = 2e+01, cost = 1.26, duration = 7.9 ms
2016-11-22 09:52:23,680 _log_update: [516] (21.8 %) of epoch 5 -- lr = 2e+01, cost = 1.49, duration = 7.9 ms
2016-11-22 09:52:39,634 _log_update: [716] (30.2 %) of epoch 5 -- lr = 2e+01, cost = 1.26, duration = 7.9 ms
2016-11-22 09:52:55,589 _log_update: [916] (38.6 %) of epoch 5 -- lr = 2e+01, cost = 1.52, duration = 7.9 ms
2016-11-22 09:53:11,621 _log_update: [1116] (47.1 %) of epoch 5 -- lr = 2e+01, cost = 1.41, duration = 7.9 ms
2016-11-22 09:53:27,655 _log_update: [1316] (55.5 %) of epoch 5 -- lr = 2e+01, cost = 1.36, duration = 7.9 ms
2016-11-22 09:53:43,680 _log_update: [1516] (63.9 %) of epoch 5 -- lr = 2e+01, cost = 1.45, duration = 7.9 ms
2016-11-22 09:53:59,698 _log_update: [1716] (72.4 %) of epoch 5 -- lr = 2e+01, cost = 1.37, duration = 8.0 ms
2016-11-22 09:54:15,630 _log_update: [1916] (80.8 %) of epoch 5 -- lr = 2e+01, cost = 1.36, duration = 7.9 ms
2016-11-22 09:54:31,557 _log_update: [2116] (89.2 %) of epoch 5 -- lr = 2e+01, cost = 1.23, duration = 7.8 ms
2016-11-22 09:54:47,482 _log_update: [2316] (97.7 %) of epoch 5 -- lr = 2e+01, cost = 1.35, duration = 7.9 ms
2016-11-22 09:54:58,045 _validate: [2362] First validation sample, perplexity 222.49.
2016-11-22 09:55:26,070 _validate: [2366] Center of validation, perplexity 223.86.
2016-11-22 09:56:01,107 _validate: [2371] Last validation sample, perplexity 208.60.
2016-11-22 09:56:01,121 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 09:56:01,122 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 [215.5]
2016-11-22 09:56:01,123 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 4.3 minutes. Best validation perplexity 215.54.
2016-11-22 09:56:12,672 _log_update: [145] (6.1 %) of epoch 6 -- lr = 2e+01, cost = 1.27, duration = 7.9 ms
2016-11-22 09:56:28,587 _log_update: [345] (14.6 %) of epoch 6 -- lr = 2e+01, cost = 1.30, duration = 7.9 ms
2016-11-22 09:56:44,499 _log_update: [545] (23.0 %) of epoch 6 -- lr = 2e+01, cost = 1.45, duration = 7.9 ms
2016-11-22 09:57:00,420 _log_update: [745] (31.4 %) of epoch 6 -- lr = 2e+01, cost = 1.33, duration = 7.8 ms
2016-11-22 09:57:16,331 _log_update: [945] (39.9 %) of epoch 6 -- lr = 2e+01, cost = 1.51, duration = 7.9 ms
2016-11-22 09:57:32,248 _log_update: [1145] (48.3 %) of epoch 6 -- lr = 2e+01, cost = 1.26, duration = 7.9 ms
2016-11-22 09:57:48,154 _log_update: [1345] (56.7 %) of epoch 6 -- lr = 2e+01, cost = 1.09, duration = 7.8 ms
2016-11-22 09:58:04,078 _log_update: [1545] (65.2 %) of epoch 6 -- lr = 2e+01, cost = 1.50, duration = 7.9 ms
2016-11-22 09:58:19,991 _log_update: [1745] (73.6 %) of epoch 6 -- lr = 2e+01, cost = 1.44, duration = 7.9 ms
2016-11-22 09:58:35,904 _log_update: [1945] (82.0 %) of epoch 6 -- lr = 2e+01, cost = 1.56, duration = 7.9 ms
2016-11-22 09:58:51,810 _log_update: [2145] (90.5 %) of epoch 6 -- lr = 2e+01, cost = 1.25, duration = 7.9 ms
2016-11-22 09:59:07,734 _log_update: [2345] (98.9 %) of epoch 6 -- lr = 2e+01, cost = 1.35, duration = 7.9 ms
2016-11-22 09:59:16,005 _validate: [2362] First validation sample, perplexity 211.60.
2016-11-22 09:59:44,040 _validate: [2366] Center of validation, perplexity 216.93.
2016-11-22 10:00:19,030 _validate: [2371] Last validation sample, perplexity 206.19.
2016-11-22 10:00:19,045 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 10:00:19,045 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 [208.8]
2016-11-22 10:00:19,046 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 4.3 minutes. Best validation perplexity 208.81.
2016-11-22 10:00:32,893 _log_update: [174] (7.3 %) of epoch 7 -- lr = 2e+01, cost = 1.13, duration = 7.8 ms
2016-11-22 10:00:48,809 _log_update: [374] (15.8 %) of epoch 7 -- lr = 2e+01, cost = 1.31, duration = 7.9 ms
2016-11-22 10:01:04,752 _log_update: [574] (24.2 %) of epoch 7 -- lr = 2e+01, cost = 1.25, duration = 7.8 ms
2016-11-22 10:01:20,659 _log_update: [774] (32.6 %) of epoch 7 -- lr = 2e+01, cost = 1.22, duration = 7.8 ms
2016-11-22 10:01:36,567 _log_update: [974] (41.1 %) of epoch 7 -- lr = 2e+01, cost = 1.37, duration = 7.9 ms
2016-11-22 10:01:52,473 _log_update: [1174] (49.5 %) of epoch 7 -- lr = 2e+01, cost = 1.26, duration = 7.8 ms
2016-11-22 10:02:08,394 _log_update: [1374] (58.0 %) of epoch 7 -- lr = 2e+01, cost = 1.31, duration = 7.9 ms
2016-11-22 10:02:24,305 _log_update: [1574] (66.4 %) of epoch 7 -- lr = 2e+01, cost = 1.20, duration = 7.9 ms
2016-11-22 10:02:40,217 _log_update: [1774] (74.8 %) of epoch 7 -- lr = 2e+01, cost = 1.37, duration = 7.9 ms
2016-11-22 10:02:56,127 _log_update: [1974] (83.3 %) of epoch 7 -- lr = 2e+01, cost = 1.28, duration = 7.9 ms
2016-11-22 10:03:12,047 _log_update: [2174] (91.7 %) of epoch 7 -- lr = 2e+01, cost = 1.47, duration = 7.9 ms
2016-11-22 10:03:33,933 _validate: [2362] First validation sample, perplexity 226.56.
2016-11-22 10:04:01,967 _validate: [2366] Center of validation, perplexity 219.82.
2016-11-22 10:04:36,988 _validate: [2371] Last validation sample, perplexity 217.97.
2016-11-22 10:04:36,989 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 [208.8] 221.9
2016-11-22 10:04:36,989 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 10:04:36,990 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 10:04:36,990 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 10:04:36,990 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 10:04:36,993 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 10:04:36,995 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 10:04:36,996 _reset_state: [2366] (99.79 %) of epoch 6
2016-11-22 10:04:36,996 _log_validation: [2366] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 [208.8]
2016-11-22 10:04:36,997 set_state: Restored iterator to line 41992 of 42068.
2016-11-22 10:04:36,997 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 10:04:36,998 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 10:04:37,001 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 10:04:37,002 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 10:04:37,002 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-22 10:04:37,003 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 20.0 to 10.0 and resetting state to 100 % of epoch 6.
2016-11-22 10:04:37,004 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 4.3 minutes. Best validation perplexity 208.81.
2016-11-22 10:04:37,250 _log_update: [3] (0.1 %) of epoch 7 -- lr = 1e+01, cost = 1.19, duration = 8.0 ms
2016-11-22 10:04:53,161 _log_update: [203] (8.6 %) of epoch 7 -- lr = 1e+01, cost = 1.13, duration = 7.9 ms
2016-11-22 10:05:09,081 _log_update: [403] (17.0 %) of epoch 7 -- lr = 1e+01, cost = 1.16, duration = 8.0 ms
2016-11-22 10:05:24,987 _log_update: [603] (25.4 %) of epoch 7 -- lr = 1e+01, cost = 1.21, duration = 8.0 ms
2016-11-22 10:05:40,894 _log_update: [803] (33.9 %) of epoch 7 -- lr = 1e+01, cost = 1.35, duration = 7.9 ms
2016-11-22 10:05:56,806 _log_update: [1003] (42.3 %) of epoch 7 -- lr = 1e+01, cost = 1.20, duration = 7.9 ms
2016-11-22 10:06:12,725 _log_update: [1203] (50.7 %) of epoch 7 -- lr = 1e+01, cost = 1.24, duration = 8.0 ms
2016-11-22 10:06:28,635 _log_update: [1403] (59.2 %) of epoch 7 -- lr = 1e+01, cost = 1.32, duration = 7.9 ms
2016-11-22 10:06:44,540 _log_update: [1603] (67.6 %) of epoch 7 -- lr = 1e+01, cost = 1.11, duration = 7.9 ms
2016-11-22 10:07:00,456 _log_update: [1803] (76.0 %) of epoch 7 -- lr = 1e+01, cost = 1.12, duration = 7.9 ms
2016-11-22 10:07:16,367 _log_update: [2003] (84.5 %) of epoch 7 -- lr = 1e+01, cost = 1.17, duration = 8.0 ms
2016-11-22 10:07:32,271 _log_update: [2203] (92.9 %) of epoch 7 -- lr = 1e+01, cost = 1.22, duration = 7.9 ms
2016-11-22 10:07:51,836 _validate: [2362] First validation sample, perplexity 189.07.
2016-11-22 10:08:19,849 _validate: [2366] Center of validation, perplexity 187.27.
2016-11-22 10:08:54,865 _validate: [2371] Last validation sample, perplexity 188.09.
2016-11-22 10:08:54,880 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 10:08:54,880 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 [187.5]
2016-11-22 10:08:54,881 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 4.3 minutes. Best validation perplexity 187.54.
2016-11-22 10:08:57,432 _log_update: [32] (1.3 %) of epoch 8 -- lr = 1e+01, cost = 1.03, duration = 7.9 ms
2016-11-22 10:09:13,439 _log_update: [232] (9.8 %) of epoch 8 -- lr = 1e+01, cost = 1.06, duration = 8.0 ms
2016-11-22 10:09:29,438 _log_update: [432] (18.2 %) of epoch 8 -- lr = 1e+01, cost = 1.00, duration = 8.0 ms
2016-11-22 10:09:45,434 _log_update: [632] (26.7 %) of epoch 8 -- lr = 1e+01, cost = 1.07, duration = 8.0 ms
2016-11-22 10:10:01,435 _log_update: [832] (35.1 %) of epoch 8 -- lr = 1e+01, cost = 0.97, duration = 8.0 ms
2016-11-22 10:10:17,441 _log_update: [1032] (43.5 %) of epoch 8 -- lr = 1e+01, cost = 1.15, duration = 8.0 ms
2016-11-22 10:10:33,434 _log_update: [1232] (52.0 %) of epoch 8 -- lr = 1e+01, cost = 1.10, duration = 8.0 ms
2016-11-22 10:10:49,420 _log_update: [1432] (60.4 %) of epoch 8 -- lr = 1e+01, cost = 1.15, duration = 8.0 ms
2016-11-22 10:11:05,412 _log_update: [1632] (68.8 %) of epoch 8 -- lr = 1e+01, cost = 1.15, duration = 8.0 ms
2016-11-22 10:11:21,327 _log_update: [1832] (77.3 %) of epoch 8 -- lr = 1e+01, cost = 1.02, duration = 8.0 ms
2016-11-22 10:11:37,244 _log_update: [2032] (85.7 %) of epoch 8 -- lr = 1e+01, cost = 1.32, duration = 8.0 ms
2016-11-22 10:11:53,158 _log_update: [2232] (94.1 %) of epoch 8 -- lr = 1e+01, cost = 1.17, duration = 8.0 ms
2016-11-22 10:12:10,427 _validate: [2362] First validation sample, perplexity 190.06.
2016-11-22 10:12:38,460 _validate: [2366] Center of validation, perplexity 190.97.
2016-11-22 10:13:13,516 _validate: [2371] Last validation sample, perplexity 191.89.
2016-11-22 10:13:13,516 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 [187.5] 190.3
2016-11-22 10:13:13,517 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 10:13:13,517 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 10:13:13,517 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 10:13:13,518 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 10:13:13,521 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 10:13:13,522 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 10:13:13,523 _reset_state: [2366] (99.79 %) of epoch 7
2016-11-22 10:13:13,523 _log_validation: [2366] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 [187.5]
2016-11-22 10:13:13,524 set_state: Restored iterator to line 41989 of 42068.
2016-11-22 10:13:13,524 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 10:13:13,525 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 10:13:13,528 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 10:13:13,529 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 10:13:13,529 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-22 10:13:13,530 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 10.0 to 5.0 and resetting state to 100 % of epoch 7.
2016-11-22 10:13:13,531 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 4.3 minutes. Best validation perplexity 187.54.
2016-11-22 10:13:18,390 _log_update: [61] (2.6 %) of epoch 8 -- lr = 5, cost = 1.26, duration = 7.9 ms
2016-11-22 10:13:34,307 _log_update: [261] (11.0 %) of epoch 8 -- lr = 5, cost = 1.05, duration = 8.0 ms
2016-11-22 10:13:50,224 _log_update: [461] (19.4 %) of epoch 8 -- lr = 5, cost = 1.02, duration = 7.9 ms
2016-11-22 10:14:06,144 _log_update: [661] (27.9 %) of epoch 8 -- lr = 5, cost = 1.05, duration = 8.0 ms
2016-11-22 10:14:22,060 _log_update: [861] (36.3 %) of epoch 8 -- lr = 5, cost = 1.11, duration = 8.0 ms
2016-11-22 10:14:37,979 _log_update: [1061] (44.7 %) of epoch 8 -- lr = 5, cost = 1.09, duration = 7.9 ms
2016-11-22 10:14:53,895 _log_update: [1261] (53.2 %) of epoch 8 -- lr = 5, cost = 1.16, duration = 8.0 ms
2016-11-22 10:15:09,815 _log_update: [1461] (61.6 %) of epoch 8 -- lr = 5, cost = 1.08, duration = 7.9 ms
2016-11-22 10:15:25,723 _log_update: [1661] (70.1 %) of epoch 8 -- lr = 5, cost = 1.05, duration = 7.9 ms
2016-11-22 10:15:41,643 _log_update: [1861] (78.5 %) of epoch 8 -- lr = 5, cost = 0.98, duration = 8.0 ms
2016-11-22 10:15:57,566 _log_update: [2061] (86.9 %) of epoch 8 -- lr = 5, cost = 0.97, duration = 7.9 ms
2016-11-22 10:16:13,487 _log_update: [2261] (95.4 %) of epoch 8 -- lr = 5, cost = 1.16, duration = 8.0 ms
2016-11-22 10:16:28,446 _validate: [2362] First validation sample, perplexity 176.81.
2016-11-22 10:16:56,484 _validate: [2366] Center of validation, perplexity 176.03.
2016-11-22 10:17:31,549 _validate: [2371] Last validation sample, perplexity 175.80.
2016-11-22 10:17:31,564 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 10:17:31,564 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 [176.2]
2016-11-22 10:17:31,565 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 4.3 minutes. Best validation perplexity 176.17.
2016-11-22 10:17:38,739 _log_update: [90] (3.8 %) of epoch 9 -- lr = 5, cost = 0.99, duration = 8.0 ms
2016-11-22 10:17:54,657 _log_update: [290] (12.2 %) of epoch 9 -- lr = 5, cost = 0.90, duration = 7.9 ms
2016-11-22 10:18:10,644 _log_update: [490] (20.7 %) of epoch 9 -- lr = 5, cost = 1.07, duration = 8.0 ms
2016-11-22 10:18:26,651 _log_update: [690] (29.1 %) of epoch 9 -- lr = 5, cost = 0.96, duration = 8.0 ms
2016-11-22 10:18:42,694 _log_update: [890] (37.5 %) of epoch 9 -- lr = 5, cost = 1.07, duration = 8.0 ms
2016-11-22 10:18:58,690 _log_update: [1090] (46.0 %) of epoch 9 -- lr = 5, cost = 1.04, duration = 8.0 ms
2016-11-22 10:19:14,623 _log_update: [1290] (54.4 %) of epoch 9 -- lr = 5, cost = 1.10, duration = 7.9 ms
2016-11-22 10:19:30,535 _log_update: [1490] (62.8 %) of epoch 9 -- lr = 5, cost = 0.94, duration = 7.9 ms
2016-11-22 10:19:46,442 _log_update: [1690] (71.3 %) of epoch 9 -- lr = 5, cost = 1.02, duration = 7.9 ms
2016-11-22 10:20:02,357 _log_update: [1890] (79.7 %) of epoch 9 -- lr = 5, cost = 1.16, duration = 8.0 ms
2016-11-22 10:20:18,273 _log_update: [2090] (88.1 %) of epoch 9 -- lr = 5, cost = 0.98, duration = 8.1 ms
2016-11-22 10:20:34,180 _log_update: [2290] (96.6 %) of epoch 9 -- lr = 5, cost = 1.13, duration = 8.0 ms
2016-11-22 10:20:46,806 _validate: [2362] First validation sample, perplexity 178.68.
2016-11-22 10:21:14,826 _validate: [2366] Center of validation, perplexity 178.88.
2016-11-22 10:21:49,759 _validate: [2371] Last validation sample, perplexity 179.61.
2016-11-22 10:21:49,759 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 [176.2] 179.2
2016-11-22 10:21:49,760 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 10:21:49,760 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 10:21:49,761 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 10:21:49,761 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 10:21:49,764 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 10:21:49,765 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 10:21:49,767 _reset_state: [2366] (99.79 %) of epoch 8
2016-11-22 10:21:49,767 _log_validation: [2366] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 [176.2]
2016-11-22 10:21:49,767 set_state: Restored iterator to line 41991 of 42068.
2016-11-22 10:21:49,768 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 10:21:49,768 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 10:21:49,772 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 10:21:49,772 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 10:21:49,773 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-22 10:21:49,774 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 8.
2016-11-22 10:21:49,775 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 4.3 minutes. Best validation perplexity 176.17.
2016-11-22 10:21:59,250 _log_update: [119] (5.0 %) of epoch 9 -- lr = 2, cost = 0.91, duration = 8.0 ms
2016-11-22 10:22:15,160 _log_update: [319] (13.5 %) of epoch 9 -- lr = 2, cost = 1.01, duration = 8.0 ms
2016-11-22 10:22:31,071 _log_update: [519] (21.9 %) of epoch 9 -- lr = 2, cost = 0.97, duration = 8.0 ms
2016-11-22 10:22:46,980 _log_update: [719] (30.3 %) of epoch 9 -- lr = 2, cost = 0.81, duration = 8.0 ms
2016-11-22 10:23:02,912 _log_update: [919] (38.8 %) of epoch 9 -- lr = 2, cost = 1.02, duration = 7.9 ms
2016-11-22 10:23:18,823 _log_update: [1119] (47.2 %) of epoch 9 -- lr = 2, cost = 0.95, duration = 7.9 ms
2016-11-22 10:23:34,744 _log_update: [1319] (55.6 %) of epoch 9 -- lr = 2, cost = 1.08, duration = 8.0 ms
2016-11-22 10:23:50,655 _log_update: [1519] (64.1 %) of epoch 9 -- lr = 2, cost = 1.00, duration = 8.0 ms
2016-11-22 10:24:06,573 _log_update: [1719] (72.5 %) of epoch 9 -- lr = 2, cost = 0.96, duration = 7.9 ms
2016-11-22 10:24:22,481 _log_update: [1919] (80.9 %) of epoch 9 -- lr = 2, cost = 0.95, duration = 7.9 ms
2016-11-22 10:24:38,399 _log_update: [2119] (89.4 %) of epoch 9 -- lr = 2, cost = 0.95, duration = 8.0 ms
2016-11-22 10:24:54,314 _log_update: [2319] (97.8 %) of epoch 9 -- lr = 2, cost = 1.14, duration = 8.0 ms
2016-11-22 10:25:04,648 _validate: [2362] First validation sample, perplexity 173.44.
2016-11-22 10:25:32,679 _validate: [2366] Center of validation, perplexity 172.66.
2016-11-22 10:26:07,722 _validate: [2371] Last validation sample, perplexity 172.75.
2016-11-22 10:26:07,737 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 10:26:07,737 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 176.2 [172.8]
2016-11-22 10:26:07,738 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 4.3 minutes. Best validation perplexity 172.81.
2016-11-22 10:26:19,527 _log_update: [148] (6.2 %) of epoch 10 -- lr = 2, cost = 0.97, duration = 8.0 ms
2016-11-22 10:26:35,450 _log_update: [348] (14.7 %) of epoch 10 -- lr = 2, cost = 1.04, duration = 7.9 ms
2016-11-22 10:26:51,362 _log_update: [548] (23.1 %) of epoch 10 -- lr = 2, cost = 0.97, duration = 7.9 ms
2016-11-22 10:27:07,289 _log_update: [748] (31.5 %) of epoch 10 -- lr = 2, cost = 0.91, duration = 7.9 ms
2016-11-22 10:27:23,204 _log_update: [948] (40.0 %) of epoch 10 -- lr = 2, cost = 1.05, duration = 7.9 ms
2016-11-22 10:27:39,120 _log_update: [1148] (48.4 %) of epoch 10 -- lr = 2, cost = 0.90, duration = 7.9 ms
2016-11-22 10:27:55,030 _log_update: [1348] (56.9 %) of epoch 10 -- lr = 2, cost = 1.00, duration = 8.0 ms
2016-11-22 10:28:10,962 _log_update: [1548] (65.3 %) of epoch 10 -- lr = 2, cost = 0.98, duration = 7.9 ms
2016-11-22 10:28:26,890 _log_update: [1748] (73.7 %) of epoch 10 -- lr = 2, cost = 0.96, duration = 8.0 ms
2016-11-22 10:28:42,813 _log_update: [1948] (82.2 %) of epoch 10 -- lr = 2, cost = 0.97, duration = 7.9 ms
2016-11-22 10:28:58,723 _log_update: [2148] (90.6 %) of epoch 10 -- lr = 2, cost = 1.02, duration = 7.9 ms
2016-11-22 10:29:14,660 _log_update: [2348] (99.0 %) of epoch 10 -- lr = 2, cost = 0.92, duration = 8.0 ms
2016-11-22 10:29:22,692 _validate: [2362] First validation sample, perplexity 174.72.
2016-11-22 10:29:50,740 _validate: [2366] Center of validation, perplexity 174.90.
2016-11-22 10:30:25,794 _validate: [2371] Last validation sample, perplexity 174.56.
2016-11-22 10:30:25,794 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 176.2 [172.8] 174.6
2016-11-22 10:30:25,794 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 10:30:25,795 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 10:30:25,795 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 10:30:25,796 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 10:30:25,799 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 10:30:25,800 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 10:30:25,801 _reset_state: [2366] (99.79 %) of epoch 9
2016-11-22 10:30:25,802 _log_validation: [2366] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 176.2 [172.8]
2016-11-22 10:30:25,802 set_state: Restored iterator to line 41979 of 42068.
2016-11-22 10:30:25,803 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 10:30:25,803 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 10:30:25,806 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 10:30:25,807 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 10:30:25,807 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-22 10:30:25,809 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 9.
2016-11-22 10:30:25,810 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 4.3 minutes. Best validation perplexity 172.81.
2016-11-22 10:30:39,901 _log_update: [177] (7.5 %) of epoch 10 -- lr = 1, cost = 1.05, duration = 7.9 ms
2016-11-22 10:30:55,834 _log_update: [377] (15.9 %) of epoch 10 -- lr = 1, cost = 0.99, duration = 8.0 ms
2016-11-22 10:31:11,834 _log_update: [577] (24.3 %) of epoch 10 -- lr = 1, cost = 1.07, duration = 8.0 ms
2016-11-22 10:31:27,845 _log_update: [777] (32.8 %) of epoch 10 -- lr = 1, cost = 0.91, duration = 8.0 ms
2016-11-22 10:31:43,867 _log_update: [977] (41.2 %) of epoch 10 -- lr = 1, cost = 0.86, duration = 8.0 ms
2016-11-22 10:31:59,868 _log_update: [1177] (49.6 %) of epoch 10 -- lr = 1, cost = 1.04, duration = 8.0 ms
2016-11-22 10:32:15,792 _log_update: [1377] (58.1 %) of epoch 10 -- lr = 1, cost = 1.24, duration = 8.0 ms
2016-11-22 10:32:31,700 _log_update: [1577] (66.5 %) of epoch 10 -- lr = 1, cost = 1.08, duration = 8.0 ms
2016-11-22 10:32:47,617 _log_update: [1777] (74.9 %) of epoch 10 -- lr = 1, cost = 1.07, duration = 8.1 ms
2016-11-22 10:33:03,538 _log_update: [1977] (83.4 %) of epoch 10 -- lr = 1, cost = 0.91, duration = 7.9 ms
2016-11-22 10:33:19,453 _log_update: [2177] (91.8 %) of epoch 10 -- lr = 1, cost = 1.09, duration = 8.0 ms
2016-11-22 10:33:41,091 _validate: [2362] First validation sample, perplexity 171.90.
2016-11-22 10:34:09,056 _validate: [2366] Center of validation, perplexity 171.75.
2016-11-22 10:34:44,020 _validate: [2371] Last validation sample, perplexity 171.86.
2016-11-22 10:34:44,035 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 10:34:44,036 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 176.2 172.8 [171.8]
2016-11-22 10:34:44,037 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 4.3 minutes. Best validation perplexity 171.78.
2016-11-22 10:34:44,522 _log_update: [6] (0.3 %) of epoch 11 -- lr = 1, cost = 0.89, duration = 7.9 ms
2016-11-22 10:35:00,441 _log_update: [206] (8.7 %) of epoch 11 -- lr = 1, cost = 1.09, duration = 8.0 ms
2016-11-22 10:35:16,359 _log_update: [406] (17.1 %) of epoch 11 -- lr = 1, cost = 1.00, duration = 7.9 ms
2016-11-22 10:35:32,274 _log_update: [606] (25.6 %) of epoch 11 -- lr = 1, cost = 0.92, duration = 7.9 ms
2016-11-22 10:35:48,186 _log_update: [806] (34.0 %) of epoch 11 -- lr = 1, cost = 0.91, duration = 8.0 ms
2016-11-22 10:36:04,169 _log_update: [1006] (42.4 %) of epoch 11 -- lr = 1, cost = 0.86, duration = 7.9 ms
2016-11-22 10:36:20,090 _log_update: [1206] (50.9 %) of epoch 11 -- lr = 1, cost = 0.90, duration = 7.9 ms
2016-11-22 10:36:36,009 _log_update: [1406] (59.3 %) of epoch 11 -- lr = 1, cost = 0.97, duration = 8.0 ms
2016-11-22 10:36:51,929 _log_update: [1606] (67.7 %) of epoch 11 -- lr = 1, cost = 0.96, duration = 7.9 ms
2016-11-22 10:37:07,848 _log_update: [1806] (76.2 %) of epoch 11 -- lr = 1, cost = 1.03, duration = 7.9 ms
2016-11-22 10:37:23,770 _log_update: [2006] (84.6 %) of epoch 11 -- lr = 1, cost = 0.87, duration = 7.9 ms
2016-11-22 10:37:39,679 _log_update: [2206] (93.0 %) of epoch 11 -- lr = 1, cost = 0.95, duration = 7.9 ms
2016-11-22 10:37:59,001 _validate: [2362] First validation sample, perplexity 171.90.
2016-11-22 10:38:26,978 _validate: [2366] Center of validation, perplexity 171.91.
2016-11-22 10:39:01,943 _validate: [2371] Last validation sample, perplexity 171.57.
2016-11-22 10:39:01,943 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 176.2 172.8 [171.8] 171.8
2016-11-22 10:39:01,944 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 10:39:01,944 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 10:39:01,945 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 10:39:01,945 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 10:39:01,948 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 10:39:01,950 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 10:39:01,951 _reset_state: [2366] (99.79 %) of epoch 10
2016-11-22 10:39:01,951 _log_validation: [2366] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 176.2 172.8 [171.8]
2016-11-22 10:39:01,951 set_state: Restored iterator to line 41990 of 42068.
2016-11-22 10:39:01,952 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 10:39:01,953 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 10:39:01,956 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 10:39:01,956 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 10:39:01,957 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-22 10:39:01,958 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 10.
2016-11-22 10:39:01,959 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 4.3 minutes. Best validation perplexity 171.78.
2016-11-22 10:39:04,757 _log_update: [35] (1.5 %) of epoch 11 -- lr = 0.6, cost = 0.93, duration = 8.0 ms
2016-11-22 10:39:20,681 _log_update: [235] (9.9 %) of epoch 11 -- lr = 0.6, cost = 0.99, duration = 7.9 ms
2016-11-22 10:39:36,588 _log_update: [435] (18.3 %) of epoch 11 -- lr = 0.6, cost = 0.75, duration = 8.0 ms
2016-11-22 10:39:52,506 _log_update: [635] (26.8 %) of epoch 11 -- lr = 0.6, cost = 1.02, duration = 7.9 ms
2016-11-22 10:40:08,491 _log_update: [835] (35.2 %) of epoch 11 -- lr = 0.6, cost = 0.98, duration = 8.0 ms
2016-11-22 10:40:24,488 _log_update: [1035] (43.7 %) of epoch 11 -- lr = 0.6, cost = 1.00, duration = 8.0 ms
2016-11-22 10:40:40,491 _log_update: [1235] (52.1 %) of epoch 11 -- lr = 0.6, cost = 0.95, duration = 8.0 ms
2016-11-22 10:40:56,499 _log_update: [1435] (60.5 %) of epoch 11 -- lr = 0.6, cost = 0.87, duration = 8.0 ms
2016-11-22 10:41:12,448 _log_update: [1635] (69.0 %) of epoch 11 -- lr = 0.6, cost = 1.04, duration = 8.0 ms
2016-11-22 10:41:28,362 _log_update: [1835] (77.4 %) of epoch 11 -- lr = 0.6, cost = 1.06, duration = 8.0 ms
2016-11-22 10:41:44,270 _log_update: [2035] (85.8 %) of epoch 11 -- lr = 0.6, cost = 0.90, duration = 8.0 ms
2016-11-22 10:42:00,198 _log_update: [2235] (94.3 %) of epoch 11 -- lr = 0.6, cost = 0.96, duration = 7.9 ms
2016-11-22 10:42:17,215 _validate: [2362] First validation sample, perplexity 170.76.
2016-11-22 10:42:45,199 _validate: [2366] Center of validation, perplexity 170.79.
2016-11-22 10:43:20,185 _validate: [2371] Last validation sample, perplexity 170.87.
2016-11-22 10:43:20,200 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 10:43:20,200 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 176.2 172.8 171.8 [170.8]
2016-11-22 10:43:20,201 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 4.3 minutes. Best validation perplexity 170.81.
2016-11-22 10:43:25,305 _log_update: [64] (2.7 %) of epoch 12 -- lr = 0.6, cost = 0.93, duration = 8.0 ms
2016-11-22 10:43:41,223 _log_update: [264] (11.1 %) of epoch 12 -- lr = 0.6, cost = 0.91, duration = 7.9 ms
2016-11-22 10:43:57,140 _log_update: [464] (19.6 %) of epoch 12 -- lr = 0.6, cost = 1.04, duration = 7.9 ms
2016-11-22 10:44:13,069 _log_update: [664] (28.0 %) of epoch 12 -- lr = 0.6, cost = 1.09, duration = 7.9 ms
2016-11-22 10:44:28,986 _log_update: [864] (36.4 %) of epoch 12 -- lr = 0.6, cost = 0.88, duration = 7.9 ms
2016-11-22 10:44:44,917 _log_update: [1064] (44.9 %) of epoch 12 -- lr = 0.6, cost = 1.01, duration = 7.9 ms
2016-11-22 10:45:00,914 _log_update: [1264] (53.3 %) of epoch 12 -- lr = 0.6, cost = 0.97, duration = 8.0 ms
2016-11-22 10:45:16,840 _log_update: [1464] (61.7 %) of epoch 12 -- lr = 0.6, cost = 0.94, duration = 8.0 ms
2016-11-22 10:45:33,040 _log_update: [1664] (70.2 %) of epoch 12 -- lr = 0.6, cost = 0.94, duration = 8.0 ms
2016-11-22 10:45:48,944 _log_update: [1864] (78.6 %) of epoch 12 -- lr = 0.6, cost = 0.96, duration = 8.1 ms
2016-11-22 10:46:04,889 _log_update: [2064] (87.1 %) of epoch 12 -- lr = 0.6, cost = 1.00, duration = 8.0 ms
2016-11-22 10:46:20,797 _log_update: [2264] (95.5 %) of epoch 12 -- lr = 0.6, cost = 0.91, duration = 8.0 ms
2016-11-22 10:46:35,503 _validate: [2362] First validation sample, perplexity 170.94.
2016-11-22 10:47:03,524 _validate: [2366] Center of validation, perplexity 170.99.
2016-11-22 10:47:38,531 _validate: [2371] Last validation sample, perplexity 171.06.
2016-11-22 10:47:38,531 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 176.2 172.8 171.8 [170.8] 171.0
2016-11-22 10:47:38,532 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 10:47:38,532 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 10:47:38,533 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 10:47:38,533 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 10:47:38,536 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 10:47:38,538 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 10:47:38,539 _reset_state: [2366] (99.79 %) of epoch 11
2016-11-22 10:47:38,539 _log_validation: [2366] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 176.2 172.8 171.8 [170.8]
2016-11-22 10:47:38,540 set_state: Restored iterator to line 41988 of 42068.
2016-11-22 10:47:38,540 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 10:47:38,541 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 10:47:38,544 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 10:47:38,545 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 10:47:38,545 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-22 10:47:38,546 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 0.625 to 0.3125 and resetting state to 100 % of epoch 11.
2016-11-22 10:47:38,547 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 4.3 minutes. Best validation perplexity 170.81.
2016-11-22 10:47:45,960 _log_update: [93] (3.9 %) of epoch 12 -- lr = 0.3, cost = 0.98, duration = 7.9 ms
2016-11-22 10:48:01,874 _log_update: [293] (12.4 %) of epoch 12 -- lr = 0.3, cost = 1.04, duration = 7.9 ms
2016-11-22 10:48:17,792 _log_update: [493] (20.8 %) of epoch 12 -- lr = 0.3, cost = 0.98, duration = 8.0 ms
2016-11-22 10:48:33,701 _log_update: [693] (29.2 %) of epoch 12 -- lr = 0.3, cost = 1.14, duration = 8.0 ms
2016-11-22 10:48:49,616 _log_update: [893] (37.7 %) of epoch 12 -- lr = 0.3, cost = 1.07, duration = 7.9 ms
2016-11-22 10:49:05,531 _log_update: [1093] (46.1 %) of epoch 12 -- lr = 0.3, cost = 0.98, duration = 8.0 ms
2016-11-22 10:49:21,451 _log_update: [1293] (54.5 %) of epoch 12 -- lr = 0.3, cost = 1.00, duration = 8.0 ms
2016-11-22 10:49:37,360 _log_update: [1493] (63.0 %) of epoch 12 -- lr = 0.3, cost = 0.88, duration = 8.0 ms
2016-11-22 10:49:53,275 _log_update: [1693] (71.4 %) of epoch 12 -- lr = 0.3, cost = 1.00, duration = 7.9 ms
2016-11-22 10:50:09,201 _log_update: [1893] (79.8 %) of epoch 12 -- lr = 0.3, cost = 0.83, duration = 8.0 ms
2016-11-22 10:50:25,118 _log_update: [2093] (88.3 %) of epoch 12 -- lr = 0.3, cost = 0.95, duration = 7.9 ms
2016-11-22 10:50:41,031 _log_update: [2293] (96.7 %) of epoch 12 -- lr = 0.3, cost = 0.92, duration = 8.0 ms
2016-11-22 10:50:53,454 _validate: [2362] First validation sample, perplexity 170.96.
2016-11-22 10:51:21,542 _validate: [2366] Center of validation, perplexity 170.94.
2016-11-22 10:51:56,567 _validate: [2371] Last validation sample, perplexity 170.96.
2016-11-22 10:51:56,568 _log_validation: [2371] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 176.2 172.8 171.8 [170.8] 171.0
2016-11-22 10:51:56,568 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 10:51:56,569 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 10:51:56,569 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 10:51:56,569 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 10:51:56,572 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 10:51:56,574 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 10:51:56,575 _reset_state: [2366] (99.79 %) of epoch 11
2016-11-22 10:51:56,575 _log_validation: [2366] Validation set cost history: 320.6 246.2 224.5 216.7 215.5 208.8 187.5 176.2 172.8 171.8 [170.8]
2016-11-22 10:51:56,576 set_state: Restored iterator to line 41988 of 42068.
2016-11-22 10:51:56,576 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 10:51:56,577 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 10:51:56,580 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 10:51:56,580 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 10:51:56,581 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-22 10:51:56,582 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 0.3125 to 0.15625 and resetting state to 100 % of epoch 11.
Finished training epoch 11 in 0 hours 4.3 minutes. Best validation perplexity 170.81.
Training finished in 1 hours 17.5 minutes.
2016-11-22 10:51:56,584 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 10:51:56,584 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 10:51:56,585 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 10:51:56,585 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 10:51:56,589 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 10:51:56,591 set_state: layers/projection_layer/W <- array(10001, 100)
Best validation set perplexity: 170.786120402
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Scoring text.
Number of sentences: 3761
Number of words: 86191
Number of predicted probabilities: 82430
Cross entropy (base e): 5.1032013663728515
Perplexity: 164.54784292547393
