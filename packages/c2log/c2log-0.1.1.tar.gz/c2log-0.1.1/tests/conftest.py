import binascii
import pytest

from c2log.structures import FixedWorkout
from c2log.structures import IntervalWorkout
from c2log.structures import VariableIntervalWorkout
from c2log.structures import User


@pytest.fixture
def just_row_with_splits_workout():

    workout_hex = (
        b'f0010000a60500007b20586b02001327f4000001ffffffff72000200ef4'
        b'5e47f9501000119a4982a207b0f1000af01000000960000001327000005'
        b'a61382044c000000000000003a000000000b00000080970d6000157a000'
        b'0ff00000000000000000000007a003a00002f411d480e361def05c7000f'
        b'660000ff00000000000000000000007a001100002f411d480e361def'
    )
    data = binascii.unhexlify(workout_hex)
    return FixedWorkout.from_data(data)


@pytest.fixture
def fixed_distance_workout():
    workout_hex = (
        b'F0030000C93E00007521BC8E0500157C00000001FFFFFFFFD200010008396A61'
        b'9503000119A4982A2175141200AF00FFFFFF960000003EC90000157C1585044C'
        b'000000000000013000002F411D480E36127A0C790014730000FF000000000000'
        b'00000000006C003D00002F411D480E36127A0CAC0014730000FF000000000000'
        b'00000000006E003C00002F411D480E36127A0C870015720000FF000000000000'
        b'000000000071003D00002F411D480E36127A0C990016720000FF000000000000'
        b'000000000074003D00002F411D480E36127A0C850016720000FF000000000000'
        b'000000000075003D00002F411D480E36127A'
    )
    data = binascii.unhexlify(workout_hex)
    return FixedWorkout.from_data(data)


@pytest.fixture
def fixed_time_workout():
    workout_hex = (
        b'F0050000301000005520648C05002EE018020001FFFFFFFFD20004008E5426ED'
        b'9505000119A4982A2055133A00AF000001A4960000002EE00000103016050960'
        b'00000000000000E500002F411D480E3607E403400016730000FF000000000000'
        b'000000000057002E00002F411D480E3607E403360016720000FF000000000000'
        b'000000000058002D00002F411D480E3607E403330016720000FF000000000000'
        b'000000000059002D00002F411D480E3607E403400016720000FF000000000000'
        b'000000000059002E00002F411D480E3607E403480017720000FF000000000000'
        b'00000000005B002F00002F411D480E3607E4'
    )
    data = binascii.unhexlify(workout_hex)
    return FixedWorkout.from_data(data)


@pytest.fixture
def fixed_time_interval_workout():
    workout_hex = (
        b'F0067800F51000007520329102001770A4010001FFFFFFFF74000300FEEE820F'
        b'9506000119A4982A2075142700AF000000D2980217700078000010F500210000'
        b'000000000000000000002F411D480E360AAF0000089300001700720000FF0000'
        b'000000000000000000E200802F411D480E360AAF086100001600720000FF0000'
        b'000000000000000000DF007B2F411D480E360AAF'
    )
    data = binascii.unhexlify(workout_hex)
    return IntervalWorkout.from_data(data)


@pytest.fixture
def fixed_distance_interval_workout():
    workout_hex = (
        b'f00778009f1f00004b203a7a060001f400000001fffffffff4000100cb2'
        b'242239507000119a4982a204b111700af00ffffff980601f4007800001f'
        b'9f006b8000000000000000000000002f411d480e361def01ae055c00001'
        b'6007a0000ff000000000000000000000032001d2f411d480e361def0534'
        b'000016006d0000ff000000000000000000000031001d2f411d480e361de'
        b'f0522000016007e0000ff000000000000000000000031001e2f411d480e'
        b'361def04ec000017006c0000ff000000000000000000000030001f2f411'
        b'd480e361def05a2000015006c0000ff000000000000000000000032001c'
        b'2f411d480e361def0560000016007d0000ff00000000000000000000003'
        b'3001d2f411d480e361def'
    )
    data = binascii.unhexlify(workout_hex)
    return IntervalWorkout.from_data(data)


@pytest.fixture
def variable_interval_workout():
    workout_hex = (
        b'F0085A000B050000E4222D62830001F4DA010001FFFFFFFFC4000400920'
        b'AB7029508000119A4982A22E40D3900AF000001669A0300000C52000004'
        b'BD00000000000000000000000000000000000000000000001A001700000'
        b'50B000001F40000005A000E80640000FF00000000000000000000000031'
        b'001E040B000003E809B60000012F0018000004B0000001D00000005A000'
        b'900640000FF0000000000000000000000002F001C040B000003E809B600'
        b'00012F001800000297000000FA0000003C000E80640000FF00000000000'
        b'00000000000001A000F040B000003E809B60000012F'
    )
    data = binascii.unhexlify(workout_hex)
    return VariableIntervalWorkout.from_data(data)


@pytest.fixture
def user():
    user_hex = (
        b'91005279616e0000000000000000000000000000000000000000000000010'
        b'1200000000000000000000000af0000000000000000000000000000054882'
        b'0000002e88000000b100008c480007204b232400000000000001410000000'
        b'00000019d0000000000000000000000000000005400000000000000780000'
        b'00000000000000000422'
    )
    data = binascii.unhexlify(user_hex)
    return User.from_data(data)


@pytest.fixture
def logbook_header():
    workout_header = [
        b'ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff',
        b'0200000000000000000000000000000020000000000000002000000000000000',
        b'0100000000000000000000000000000000000000000000002000000000000000'
    ]

    return [binascii.unhexlify(w) for w in workout_header]


@pytest.fixture
def logbook_workouts():
    workout_records = [
        b'0B00000000000000000000000000000000000000000000000000000000000000',
        b'0A00000000000000000000000000000000000000000000000000000000000000',
    ]

    return [binascii.unhexlify(w) for w in workout_records]
