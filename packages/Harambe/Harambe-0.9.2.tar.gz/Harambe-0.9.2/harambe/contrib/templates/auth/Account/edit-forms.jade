
= html.include_js_file('contrib.js.imagepreview.js') | safe
= html.include_js_file('contrib.auth.user.js') | safe
= html.include_css_file('contrib.auth.user.css') | safe

.row
    .col-md-12
        + widget.accordion(id='edit-account')

            + widget.collapse()
                + widget.collapse_header(accordion_id="edit-account", body_id="edit-account-name")
                    = _("Edit Info")
                + widget.collapse_body(id="edit-account-name")
                    + forms.upload("auth.Account:update_info")
                        + forms.input(label=_("First Name"), name="first_name", value=current_user.first_name, data={"validation": "required"})
                        + forms.input(label=_("Last Name"), name="last_name", value=current_user.last_name, data={"validation": "required"})
                        .row
                            .col-sm-4
                                #profile-photo-preview.img-thumbnail
                                    img(src=current_user.profile_image.url, height=120, width=120)

                            .col-sm-8
                                + forms.input(label=_("Select Image to upload"), id="profile-photo-input", type='file', name='file')

                        + forms.button(_("Save Info"), type='submit', class='btn-primary')


            if current_user.login_method == "email"
                + widget.collapse()
                    + widget.collapse_header(accordion_id="edit-account", body_id="edit-account-login")
                        = _("Edit Login")
                    + widget.collapse_body(id="edit-account-login")
                        + forms.post("auth.Account:change_username")
                            + forms.input('username', label=_('Login Email'), value=current_user.username, type='email', data={"validation": "email"})
                            + forms.input('current_password', label="*" + _('Confirm your changes by entering  your current password'), type='password', data={"validation": "required"})
                            + forms.button(_("Save Login"), type='submit', class='btn btn-primary')

            elif current_user.login_method == "username"
                + widget.collapse()
                    + widget.collapse_header(accordion_id="edit-account", body_id="edit-account-login")
                        = _("Edit Login")
                    + widget.collapse_body(id="edit-account-login")
                        + forms.post("auth.Account:change_username")
                            + forms.input('username', label=_('Username'), value=current_user.username, data={"validation": "required"})
                            + forms.input('current_password', label="*" + _('Confirm your changes by entering  your current password'), type='password', data={"validation": "required"})
                            + forms.button(_("Save Login"), type='submit', class='btn btn-primary')


                + widget.collapse()
                    + widget.collapse_header(accordion_id="edit-account", body_id="edit-account-email")
                        = _("Edit Email")
                    + widget.collapse_body(id="edit-account-email")
                        + forms.post("auth.Account:change_email")
                            + forms.input('email', label=_('Email'), value=current_user.email, type='email', data={"validation": "email"})
                            + forms.input('current_password', label="*" + _('Confirm your changes by entering  your current password'), type='password', data={"validation": "required"})
                            + forms.button(_("Change Email"), type='submit', class='btn btn-primary')


            + widget.collapse()
                + widget.collapse_header(accordion_id="edit-account", body_id="edit-account-password")
                    = _("Edit Password")
                + widget.collapse_body(id="edit-account-password")
                    + forms.post("auth.Account:change_password")
                        + forms.input('password', label=_('New Password'), type='password', data={"validation": "email"})
                        + forms.input('password_confirm', label=_('Confirm New Password'),  type='password', data={"validation": "email"})
                        + forms.input('current_password', label="*" + _('Confirm your changes by entering  your current password'),  type='password', data={"validation": "required"})
                        + forms.button(_("Save Password"), type='submit', class='btn btn-primary')




