language: python

python:
  - '2.7'

before_install:
  - wget https://github.com/sstephenson/bats/archive/v0.4.0.tar.gz
  - tar xzf v0.4.0.tar.gz
  - export PATH=$PWD/bats-0.4.0/bin:$PATH
  - bats -v

install:
  - virtualenv .venv
  - . ./.venv/bin/activate
  - pip install -r requirements.txt
  - pip install -r test-requirements.txt
  - pip install -e .

script:
  - export PATH=$PWD/bats-0.4.0/bin:$PATH
  - tests/run_tests.sh

sudo: false

deploy:
  provider: pypi
  user: maxiterr
  password:
    secure: "2SVq6mhCDL/BuY+sGuq6H9ObnHo6xGsF65zqzB6x7L2rg5usNWJbzd97FDlT4aEeXbNxPNW/Y1tjWZd1sO6EgmCLM4ov7ZpZSFzlu9UmBRnvkgu79VjHcRczPz2jU+29eCIvOW0ho856ZbeNLjMo/zjTaypllk6ec7nOBQpRUws+zIT6l0RoNmJJQHOBBJyQfo8wOyEgBUnJxNfLMIrOaNPtxpAMIpQXGuIDsAkpTzwp/YEkPiaqe2rUY1qGpZI6RPiTraVsOCahssFwDpijb34+kv82w0VYxGU/D+wn9KV2kluCxxg3gQs9QJBwy+QYZc8pecrVXC6kcREA9egEMCF9FRkeI2iRXprZpFT6lH1ofgJBCBLskjH+EFMvztk8GmOhhDjw/URuoxd0Dt6uT600kcrsqu0huL20Q1YoM0NY3hep1HCYxU6N/wncFk4Br9ILkgDyMeWiE+dT1W5zLadD6cruShKczxQ5LzdpSGL+1btcbeFj8V9WUC3bvPQ/YTenThOYFtnd9g8oonlYkJT845/tnrFtpAZ9E6GWsnAiAkSP0NKqTii5MhKkaPFDgyZ5pGmvO0rLAFvvn9LUNZ0Eu05I5KFNarHaNVoSQXriN0uaZ1lLcr5tTBfZAll44hlMA9SHWJD1hk0c+uirfxEepStoLVXC/UrGBsWCois="
  on:
    tags: true
