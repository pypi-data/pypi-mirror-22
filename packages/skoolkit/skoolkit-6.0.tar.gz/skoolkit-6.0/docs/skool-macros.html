<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Skool macros &mdash; SkoolKit 6.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '6.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="SkoolKit 6.0 documentation" href="index.html" />
    <link rel="next" title="Ref files" href="ref-files.html" />
    <link rel="prev" title="Skool file templates" href="skool-file-templates.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ref-files.html" title="Ref files"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="skool-file-templates.html" title="Skool file templates"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">SkoolKit 6.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="skool-macros">
<span id="skoolmacros"></span><h1>Skool macros<a class="headerlink" href="#skool-macros" title="Permalink to this headline">¶</a></h1>
<p>Skool files and ref files may contain skool macros that are &#8216;expanded&#8217; to an
appropriate piece of HTML markup (when rendering in HTML mode), or to an
appropriate piece of plain text (when rendering in ASM mode).</p>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<p>Skool macros have the following general form:</p>
<div class="highlight-none"><div class="highlight"><pre>#MACROrparam1,rparam2,...[,oparam1,oparam2,...]
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">MACRO</span></tt> is the macro name</li>
<li><tt class="docutils literal"><span class="pre">rparam1</span></tt>, <tt class="docutils literal"><span class="pre">rparam2</span></tt> etc. are required parameters</li>
<li><tt class="docutils literal"><span class="pre">oparam1</span></tt>, <tt class="docutils literal"><span class="pre">oparam2</span></tt> etc. are optional parameters</li>
</ul>
<p>If an optional parameter is left blank or omitted entirely, it assumes its
default value. So, for example:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDG39144
</pre></div>
</div>
<p>is equivalent to:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDG39144,56,4,1,0,0,0,1
</pre></div>
</div>
<p>and:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDG30115,,2
</pre></div>
</div>
<p>is equivalent to:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDG30115,56,2
</pre></div>
</div>
</div>
<div class="section" id="numeric-parameters">
<span id="numericparameters"></span><h2>Numeric parameters<a class="headerlink" href="#numeric-parameters" title="Permalink to this headline">¶</a></h2>
<p>Numeric parameters may be written in decimal notation:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDG51673,17
</pre></div>
</div>
<p>or in hexadecimal notation (prefixed by <tt class="docutils literal"><span class="pre">$</span></tt>):</p>
<div class="highlight-none"><div class="highlight"><pre>#UDG$C9D9,$11
</pre></div>
</div>
<p>Wherever a sequence of numeric parameters appears in a macro, that sequence
may optionally be enclosed in parentheses: <tt class="docutils literal"><span class="pre">(</span></tt> and <tt class="docutils literal"><span class="pre">)</span></tt>. Parentheses are
<cite>required</cite> if any numeric parameter is written as an expression containing
arithmetic operations or skool macros:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDG(51672+1,#PEEK51672)
</pre></div>
</div>
<p>The following operators are permitted in an arithmetic expression:</p>
<ul class="simple">
<li>arithmetic operators: <tt class="docutils literal"><span class="pre">+</span></tt>, <tt class="docutils literal"><span class="pre">-</span></tt>, <tt class="docutils literal"><span class="pre">*</span></tt>, <tt class="docutils literal"><span class="pre">/</span></tt>, <tt class="docutils literal"><span class="pre">%</span></tt> (modulo), <tt class="docutils literal"><span class="pre">**</span></tt>
(power)</li>
<li>bitwise operators: <tt class="docutils literal"><span class="pre">&amp;</span></tt> (AND), <tt class="docutils literal"><span class="pre">|</span></tt> (OR), <tt class="docutils literal"><span class="pre">^</span></tt> (XOR)</li>
<li>bit shift operators: <tt class="docutils literal"><span class="pre">&gt;&gt;</span></tt>, <tt class="docutils literal"><span class="pre">&lt;&lt;</span></tt></li>
<li>Boolean operators: <tt class="docutils literal"><span class="pre">&amp;&amp;</span></tt> (and), <tt class="docutils literal"><span class="pre">||</span></tt> (or)</li>
<li>comparison operators: <tt class="docutils literal"><span class="pre">==</span></tt>, <tt class="docutils literal"><span class="pre">!=</span></tt>, <tt class="docutils literal"><span class="pre">&gt;</span></tt>, <tt class="docutils literal"><span class="pre">&lt;</span></tt>, <tt class="docutils literal"><span class="pre">&gt;=</span></tt>, <tt class="docutils literal"><span class="pre">&lt;=</span></tt></li>
</ul>
<p>Parentheses and spaces are also permitted in an arithmetic expression:</p>
<div class="highlight-none"><div class="highlight"><pre>#IF(1 == 2 || (1 &lt;= 2 &amp;&amp; 2 &lt; 3))(Yes,No)
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">expr</span></tt> parameter of the <a class="reference internal" href="#if"><em>#IF</em></a> macro and the <tt class="docutils literal"><span class="pre">key</span></tt> parameter of the
<a class="reference internal" href="#map"><em>#MAP</em></a> macro also recognise some replacement fields:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">asm</span></tt> - 1 if in ASM mode, 0 otherwise</li>
<li><tt class="docutils literal"><span class="pre">base</span></tt> - 10 if the <tt class="docutils literal"><span class="pre">--decimal</span></tt> option is used with <a class="reference internal" href="commands.html#skool2asm-py"><em>skool2asm.py</em></a>
or <a class="reference internal" href="commands.html#skool2html-py"><em>skool2html.py</em></a>, 16 if the <tt class="docutils literal"><span class="pre">--hex</span></tt> option is used, or 0 if neither
option is used</li>
<li><tt class="docutils literal"><span class="pre">case</span></tt> - 1 if the <tt class="docutils literal"><span class="pre">--lower</span></tt> option is used with <a class="reference internal" href="commands.html#skool2asm-py"><em>skool2asm.py</em></a>
or <a class="reference internal" href="commands.html#skool2html-py"><em>skool2html.py</em></a>, 2 if the <tt class="docutils literal"><span class="pre">--upper</span></tt> option is used, or 0 if neither
option is used</li>
<li><tt class="docutils literal"><span class="pre">html</span></tt> - 1 if in HTML mode, 0 otherwise</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>#IF({case}==1)(hl,HL)
</pre></div>
</div>
<p>expands to <tt class="docutils literal"><span class="pre">hl</span></tt> if in lower case mode, or <tt class="docutils literal"><span class="pre">HL</span></tt> otherwise.</p>
<p>Note that if a replacement field is used, the numeric parameter must be
enclosed in parentheses.</p>
</div>
<div class="section" id="string-parameters">
<span id="stringparameters"></span><h2>String parameters<a class="headerlink" href="#string-parameters" title="Permalink to this headline">¶</a></h2>
<p>Where a macro requires a single string parameter consisting of arbitrary text,
it must be enclosed in parentheses, square brackets or braces:</p>
<div class="highlight-none"><div class="highlight"><pre>(text)
[text]
{text}
</pre></div>
</div>
<p>If <tt class="docutils literal"><span class="pre">text</span></tt> contains unbalanced brackets, any non-whitespace character that is
not present in <tt class="docutils literal"><span class="pre">text</span></tt> may be used as an alternative delimiter. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>/text/
|text|
</pre></div>
</div>
<p>Where a macro requires multiple string parameters consisting of arbitrary text,
they must be enclosed in parentheses, square brackets or braces and be
separated by commas:</p>
<div class="highlight-none"><div class="highlight"><pre>(string1,string2)
[string1,string2]
{string1,string2}
</pre></div>
</div>
<p>Alternatively, an arbitrary delimiter - <tt class="docutils literal"><span class="pre">d</span></tt>, which cannot be whitespace - and
separator - <tt class="docutils literal"><span class="pre">s</span></tt>, which can be whitespace - may be used. (They can be the same
character.) The string parameters must open with <tt class="docutils literal"><span class="pre">ds</span></tt>, be separated by <tt class="docutils literal"><span class="pre">s</span></tt>,
and close with <tt class="docutils literal"><span class="pre">sd</span></tt>. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>//same/delimiter/and/separator//
| different delimiter and separator |
</pre></div>
</div>
<p>This form is required if any of the strings contain a comma.</p>
</div>
<div class="section" id="smpl-macros">
<h2>SMPL macros<a class="headerlink" href="#smpl-macros" title="Permalink to this headline">¶</a></h2>
<p>The macros described in this section constitute the Skool Macro Programming
Language (SMPL). They can be used to programmatically specify values in the
parameter string of any macro.</p>
<div class="section" id="hash">
<span id="id1"></span><h3>#()<a class="headerlink" href="#hash" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#()</span></tt> macro expands the skool macros in its sole string parameter.</p>
<div class="highlight-none"><div class="highlight"><pre>#(text)
</pre></div>
</div>
<p>It takes effect only when it immediately follows the opening token of another
skool macro, and is expanded <cite>before</cite> that macro. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDGARRAY#(2#FOR37159,37168,9||n|;(n+1),#PEEKn||)(item)
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#()</span></tt> macro expands the <tt class="docutils literal"><span class="pre">#FOR</span></tt> macro first, giving:</p>
<div class="highlight-none"><div class="highlight"><pre>2;(37159+1),#PEEK37159;(37168+1),#PEEK37168
</pre></div>
</div>
<p>It then expands the <tt class="docutils literal"><span class="pre">#PEEK</span></tt> macros, ultimately forming the parameters of the
<tt class="docutils literal"><span class="pre">#UDGARRAY</span></tt> macro.</p>
<p>See <a class="reference internal" href="#stringparameters"><em>String parameters</em></a> for details on alternative ways to supply the
<tt class="docutils literal"><span class="pre">text</span></tt> parameter. Note that if an alternative delimiter is used, it must not
be an alphanumeric character (A-Z, a-z, 0-9).</p>
</div>
<div class="section" id="eval">
<span id="id2"></span><h3>#EVAL<a class="headerlink" href="#eval" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#EVAL</span></tt> macro expands to the value of an arithmetic expression.</p>
<div class="highlight-none"><div class="highlight"><pre>#EVALexpr[,base,width]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">expr</span></tt> is the arithmetic expression</li>
<li><tt class="docutils literal"><span class="pre">base</span></tt> is the number base in which the value is expressed: <tt class="docutils literal"><span class="pre">2</span></tt>, <tt class="docutils literal"><span class="pre">10</span></tt>
(the default) or <tt class="docutils literal"><span class="pre">16</span></tt></li>
<li><tt class="docutils literal"><span class="pre">width</span></tt> is the minimum number of digits in the output (default: <tt class="docutils literal"><span class="pre">1</span></tt>);
the value will be padded with leading zeroes if necessary</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; The following mask byte is #EVAL(#PEEK29435,2,8).
 29435 DEFB 62
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#EVAL</span></tt> macro expands to &#8216;00111110&#8217; (62 in binary).</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="86%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>6.0</td>
<td>Hexadecimal values are rendered in lower case when the
<tt class="docutils literal"><span class="pre">--lower</span></tt> option is used</td>
</tr>
<tr class="row-odd"><td>5.1</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="for">
<span id="id3"></span><h3>#FOR<a class="headerlink" href="#for" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#FOR</span></tt> macro expands to a sequence of strings based on a range of
integers.</p>
<div class="highlight-none"><div class="highlight"><pre>#FORstart,stop[,step](var,string[,sep,fsep])
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">start</span></tt> is first integer in the range</li>
<li><tt class="docutils literal"><span class="pre">stop</span></tt> is the final integer in the range</li>
<li><tt class="docutils literal"><span class="pre">step</span></tt> is the gap between each integer in the range (default: <tt class="docutils literal"><span class="pre">1</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">var</span></tt> is the variable name; for each integer in the range, it evaluates to
that integer</li>
<li><tt class="docutils literal"><span class="pre">string</span></tt> is the output string that is evaluated for each integer in the
range; wherever the variable name (<tt class="docutils literal"><span class="pre">var</span></tt>) appears, its value is substituted</li>
<li><tt class="docutils literal"><span class="pre">sep</span></tt> is the separator placed between each output string (default: the
empty string)</li>
<li><tt class="docutils literal"><span class="pre">fsep</span></tt> is the separator placed between the final two output strings
(default: <tt class="docutils literal"><span class="pre">sep</span></tt>)</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; The next three bytes (#FOR31734,31736||n|#PEEKn|, | and ||) define the
; item locations.
 31734 DEFB 24,17,156
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#FOR</span></tt> macro expands to &#8216;24, 17 and 156&#8217;.</p>
<p>See <a class="reference internal" href="#stringparameters"><em>String parameters</em></a> for details on alternative ways to supply the
<tt class="docutils literal"><span class="pre">var</span></tt>, <tt class="docutils literal"><span class="pre">string</span></tt>, <tt class="docutils literal"><span class="pre">sep</span></tt> and <tt class="docutils literal"><span class="pre">fsep</span></tt> parameters.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="foreach">
<span id="id4"></span><h3>#FOREACH<a class="headerlink" href="#foreach" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#FOREACH</span></tt> macro expands to a sequence of output strings based on a
sequence of input strings.</p>
<div class="highlight-none"><div class="highlight"><pre>#FOREACH([s1,s2,...])(var,string[,sep,fsep])
</pre></div>
</div>
<p>or:</p>
<div class="highlight-none"><div class="highlight"><pre>#FOREACH(svar)(var,string[,sep,fsep])
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">s1</span></tt>, <tt class="docutils literal"><span class="pre">s2</span></tt>  etc. are the input strings</li>
<li><tt class="docutils literal"><span class="pre">svar</span></tt> is a special variable that expands to a specific sequence of input
strings (see below)</li>
<li><tt class="docutils literal"><span class="pre">var</span></tt> is the variable name; for each input string, it evaluates to that
string</li>
<li><tt class="docutils literal"><span class="pre">string</span></tt> is the output string that is evaluated for each input string;
wherever the variable name (<tt class="docutils literal"><span class="pre">var</span></tt>) appears, its value is substituted</li>
<li><tt class="docutils literal"><span class="pre">sep</span></tt> is the separator placed between each output string (default: the
empty string)</li>
<li><tt class="docutils literal"><span class="pre">fsep</span></tt> is the separator placed between the final two output strings
(default: <tt class="docutils literal"><span class="pre">sep</span></tt>)</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; The next three bytes (#FOREACH(31734,31735,31736)||n|#PEEKn|, | and ||)
; define the item locations.
 31734 DEFB 24,17,156
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#FOREACH</span></tt> macro expands to &#8216;24, 17 and 156&#8217;.</p>
<p>The <tt class="docutils literal"><span class="pre">#FOREACH</span></tt> macro recognises certain special variables, each one of which
expands to a specific sequence of strings. The special variables are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">ENTRY[types]</span></tt> - the addresses of every entry of the specified type(s) in
the memory map; if <tt class="docutils literal"><span class="pre">types</span></tt> is not given, every type is included</li>
<li><tt class="docutils literal"><span class="pre">EREFaddr</span></tt> - the addresses of the routines that jump to or call a given
instruction (at <tt class="docutils literal"><span class="pre">addr</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">REFaddr</span></tt> - the addresses of the routines that jump to or call a given
routine (at <tt class="docutils literal"><span class="pre">addr</span></tt>), or jump to or call any entry point within that routine</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; The messages can be found at #FOREACH(ENTRYt)||n|n|, | and ||.
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#FOREACH</span></tt> macro expands to a list of the addresses of
the entries of type <tt class="docutils literal"><span class="pre">t</span></tt> (text).</p>
<p>See <a class="reference internal" href="#stringparameters"><em>String parameters</em></a> for details on alternative ways to supply the
<tt class="docutils literal"><span class="pre">var</span></tt>, <tt class="docutils literal"><span class="pre">string</span></tt>, <tt class="docutils literal"><span class="pre">sep</span></tt> and <tt class="docutils literal"><span class="pre">fsep</span></tt> parameters.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="if">
<span id="id5"></span><h3>#IF<a class="headerlink" href="#if" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#IF</span></tt> macro expands to an arbitrary string based on the truth value of an
arithmetic expression.</p>
<div class="highlight-none"><div class="highlight"><pre>#IFexpr(true[,false])
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">expr</span></tt> is the arithmetic expression</li>
<li><tt class="docutils literal"><span class="pre">true</span></tt> is the output string when <tt class="docutils literal"><span class="pre">expr</span></tt> is true</li>
<li><tt class="docutils literal"><span class="pre">false</span></tt> is the output string when <tt class="docutils literal"><span class="pre">expr</span></tt> is false (default: the empty
string)</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; #FOR0,7||n|#IF(#PEEK47134 &amp; 2**(7-n))(X,O)||
 47134 DEFB 170
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#IF</span></tt> macro is used (in combination with a <tt class="docutils literal"><span class="pre">#FOR</span></tt>
macro and a <tt class="docutils literal"><span class="pre">#PEEK</span></tt> macro) to display the contents of the address 47134 in
the memory snapshot in binary format with &#8216;X&#8217; for one and &#8216;O&#8217; for zero:
XOXOXOXO.</p>
<p>See <a class="reference internal" href="#stringparameters"><em>String parameters</em></a> for details on alternative ways to supply the
<tt class="docutils literal"><span class="pre">true</span></tt> and <tt class="docutils literal"><span class="pre">false</span></tt> output strings.</p>
<p>See <a class="reference internal" href="#numericparameters"><em>Numeric parameters</em></a> for details on the replacement fields that may be
used in the <tt class="docutils literal"><span class="pre">expr</span></tt> parameter.</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>6.0</td>
<td>Added support for replacement fields in the <tt class="docutils literal"><span class="pre">expr</span></tt> parameter</td>
</tr>
<tr class="row-odd"><td>5.1</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="map">
<span id="id6"></span><h3>#MAP<a class="headerlink" href="#map" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#MAP</span></tt> macro expands to a value from a map of key-value pairs whose keys
are integers.</p>
<div class="highlight-none"><div class="highlight"><pre>#MAPkey(default[,k1:v1,k2:v2...])
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">key</span></tt> is the integer to look up in the map</li>
<li><tt class="docutils literal"><span class="pre">default</span></tt> is the default output string (used when <tt class="docutils literal"><span class="pre">key</span></tt> is not found in
the map)</li>
<li><tt class="docutils literal"><span class="pre">k1:v1</span></tt>, <tt class="docutils literal"><span class="pre">k2:v2</span></tt> etc. are the key-value pairs in the map</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; The next three bytes specify the directions that are available from here:
; #FOR56112,56114||q|#MAP(#PEEKq)(?,0:left,1:right,2:up,3:down)|, | and ||.
 56112 DEFB 0,1,3
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#MAP</span></tt> macro is used (in combination with a <tt class="docutils literal"><span class="pre">#FOR</span></tt>
macro and a <tt class="docutils literal"><span class="pre">#PEEK</span></tt> macro) to display a list of directions available based on
the contents of addresses 56112-56114: &#8216;left, right and down&#8217;.</p>
<p>Note that the keys (<tt class="docutils literal"><span class="pre">k1</span></tt>, <tt class="docutils literal"><span class="pre">k2</span></tt> etc.) may be expressed using arithmetic
operations. They may also be expressed using skool macros, but in that case the
<em>entire</em> parameter string of the <tt class="docutils literal"><span class="pre">#MAP</span></tt> macro must be enclosed by a
<a class="reference internal" href="#hash"><em>#()</em></a> macro.</p>
<p>See <a class="reference internal" href="#stringparameters"><em>String parameters</em></a> for details on alternative ways to supply the
default output string and the key-value pairs.</p>
<p>See <a class="reference internal" href="#numericparameters"><em>Numeric parameters</em></a> for details on the replacement fields that may be
used in the <tt class="docutils literal"><span class="pre">key</span></tt> parameter.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>6.0</td>
<td>Added support for replacement fields in the <tt class="docutils literal"><span class="pre">key</span></tt> parameter</td>
</tr>
<tr class="row-odd"><td>5.1</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="peek">
<span id="id7"></span><h3>#PEEK<a class="headerlink" href="#peek" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#PEEK</span></tt> macro expands to the contents of an address in the memory
snapshot.</p>
<div class="highlight-none"><div class="highlight"><pre>#PEEKaddr
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">addr</span></tt> is the address</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; At the start of the game, the number of lives remaining is #PEEK33879.
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#PEEK</span></tt> macro expands to the contents of the address
33879 in the memory snapshot.</p>
<p>See also <a class="reference internal" href="#pokes"><em>#POKES</em></a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="general-macros">
<h2>General macros<a class="headerlink" href="#general-macros" title="Permalink to this headline">¶</a></h2>
<div class="section" id="call">
<span id="id8"></span><h3>#CALL<a class="headerlink" href="#call" title="Permalink to this headline">¶</a></h3>
<p>In HTML mode, the <tt class="docutils literal"><span class="pre">#CALL</span></tt> macro expands to the return value of a method on
the <cite>HtmlWriter</cite> class or subclass that is being used to create the HTML
disassembly (as defined by the <tt class="docutils literal"><span class="pre">HtmlWriterClass</span></tt> parameter in the
<a class="reference internal" href="ref-files.html#ref-config"><em>[Config]</em></a> section of the ref file).</p>
<p>In ASM mode, the <tt class="docutils literal"><span class="pre">#CALL</span></tt> macro expands to the return value of a method on the
<cite>AsmWriter</cite> class or subclass that is being used to generate the ASM output (as
defined by the <a class="reference internal" href="asm.html#writer"><em>&#64;writer</em></a> ASM directive in the skool file).</p>
<div class="highlight-none"><div class="highlight"><pre>#CALL:methodName(args)
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">methodName</span></tt> is the name of the method to call</li>
<li><tt class="docutils literal"><span class="pre">args</span></tt> is a comma-separated list of arguments to pass to the method</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; The word at address 32768 is #CALL:word(32768).
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#CALL</span></tt> macro expands to the return value of the <cite>word</cite>
method (on the <cite>HtmlWriter</cite> or <cite>AsmWriter</cite> subclass being used) when called
with the argument <tt class="docutils literal"><span class="pre">32768</span></tt>.</p>
<p>For information on writing methods that may be called by a <tt class="docutils literal"><span class="pre">#CALL</span></tt> macro, see
the documentation on <a class="reference internal" href="extending.html#extendingskoolkit"><em>extending SkoolKit</em></a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>Added support for arithmetic expressions and skool macros in
numeric method arguments</td>
</tr>
<tr class="row-odd"><td>3.1</td>
<td>Added support for ASM mode</td>
</tr>
<tr class="row-even"><td>2.1</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="chr">
<span id="id9"></span><h3>#CHR<a class="headerlink" href="#chr" title="Permalink to this headline">¶</a></h3>
<p>In HTML mode, the <tt class="docutils literal"><span class="pre">#CHR</span></tt> macro expands to a numeric character reference
(<tt class="docutils literal"><span class="pre">&amp;#num;</span></tt>). In ASM mode, it expands to a unicode character in the UTF-8
encoding.</p>
<div class="highlight-none"><div class="highlight"><pre>#CHRnum
</pre></div>
</div>
<p>For example:</p>
<div class="nonexistent highlight-none"><div class="highlight"><pre> 26751 DEFB 127   ; This is the copyright symbol: #CHR169
</pre></div>
</div>
<p>In HTML mode, this instance of the <tt class="docutils literal"><span class="pre">#CHR</span></tt> macro expands to <tt class="docutils literal"><span class="pre">&amp;#169;</span></tt>. In ASM
mode, it expands to the copyright symbol.</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>Added support for arithmetic expressions and skool macros in the
<tt class="docutils literal"><span class="pre">num</span></tt> parameter</td>
</tr>
<tr class="row-odd"><td>3.1</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="d">
<span id="id10"></span><h3>#D<a class="headerlink" href="#d" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#D</span></tt> macro expands to the title of an entry (a routine or data block) in
the memory map.</p>
<div class="highlight-none"><div class="highlight"><pre>#Daddr
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">addr</span></tt> is the address of the entry.</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; Now we make an indirect jump to one of the following routines:
; .
; #TABLE(default,centre)
; { =h Address | =h Description }
; { #R27126    | #D27126 }
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#D</span></tt> macro expands to the title of the routine at 27126.</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>Added support for arithmetic expressions and skool macros in the
<tt class="docutils literal"><span class="pre">addr</span></tt> parameter</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="html">
<span id="id11"></span><h3>#HTML<a class="headerlink" href="#html" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#HTML</span></tt> macro expands to arbitrary text (in HTML mode) or to an empty
string (in ASM mode).</p>
<div class="highlight-none"><div class="highlight"><pre>#HTML(text)
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">#HTML</span></tt> macro may be used to render HTML (which would otherwise be
escaped) from a skool file. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; #HTML(For more information, go &lt;a href=&quot;http://example.com/&quot;&gt;here&lt;/a&gt;.)
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">text</span></tt> may contain other skool macros, which will be expanded before
rendering. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; #HTML[The UDG defined here (32768) looks like this: #UDG32768,4,1]
</pre></div>
</div>
<p>See <a class="reference internal" href="#stringparameters"><em>String parameters</em></a> for details on alternative ways to supply the
<tt class="docutils literal"><span class="pre">text</span></tt> parameter. Note that if an alternative delimiter is used, it must not
be an upper case letter.</p>
<p>See also <a class="reference internal" href="#udgtable"><em>#UDGTABLE</em></a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>3.1.2</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="include">
<span id="id12"></span><h3>#INCLUDE<a class="headerlink" href="#include" title="Permalink to this headline">¶</a></h3>
<p>In HTML mode, the <tt class="docutils literal"><span class="pre">#INCLUDE</span></tt> macro expands to the contents of a ref file
section; in ASM mode, it expands to an empty string.</p>
<div class="highlight-none"><div class="highlight"><pre>#INCLUDE[paragraphs](section)
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">paragraphs</span></tt> specifies how to format the contents of the ref file section:
verbatim (<tt class="docutils literal"><span class="pre">0</span></tt> - the default), or into paragraphs (<tt class="docutils literal"><span class="pre">1</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">section</span></tt> is the name of the ref file section</li>
</ul>
<p>The <tt class="docutils literal"><span class="pre">#INCLUDE</span></tt> macro can be used to insert the contents of one ref file
section into another. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>[MemoryMap:RoutinesMap]
Intro=#INCLUDE(RoutinesMapIntro)

[RoutinesMapIntro]
This is the intro to the &#39;Routines&#39; map page.
</pre></div>
</div>
<p>See <a class="reference internal" href="#stringparameters"><em>String parameters</em></a> for details on alternative ways to supply the
<tt class="docutils literal"><span class="pre">section</span></tt> parameter.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.3</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="link">
<span id="id13"></span><h3>#LINK<a class="headerlink" href="#link" title="Permalink to this headline">¶</a></h3>
<p>In HTML mode, the <tt class="docutils literal"><span class="pre">#LINK</span></tt> macro expands to a hyperlink (<tt class="docutils literal"><span class="pre">&lt;a&gt;</span></tt> element) to
another page.</p>
<div class="highlight-none"><div class="highlight"><pre>#LINK:PageId[#name](link text)
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">PageId</span></tt> is the ID of the page to link to</li>
<li><tt class="docutils literal"><span class="pre">name</span></tt> is the name of an anchor on the page to link to</li>
<li><tt class="docutils literal"><span class="pre">link</span> <span class="pre">text</span></tt> is the link text to use</li>
</ul>
<p>In HTML mode, if the link text is blank, it defaults either to the title of the
entry being linked to (if the page is a <a class="reference internal" href="ref-files.html#boxpages"><em>box page</em></a> and contains
an entry with the specified anchor), or to the page&#8217;s link text.</p>
<p>In ASM mode, the <tt class="docutils literal"><span class="pre">#LINK</span></tt> macro expands to the link text.</p>
<p>The page IDs that may be used are the same as the file IDs that may be used in
the <a class="reference internal" href="ref-files.html#paths"><em>[Paths]</em></a> section of a ref file, or the page IDs defined by <a class="reference internal" href="ref-files.html#page"><em>[Page:*]</em></a>
sections.</p>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; See the #LINK:Glossary(glossary) for a definition of &#39;chuntey&#39;.
</pre></div>
</div>
<p>In HTML mode, this instance of the <tt class="docutils literal"><span class="pre">#LINK</span></tt> macro expands to a hyperlink to
the &#8216;Glossary&#8217; page, with link text &#8216;glossary&#8217;.</p>
<p>In ASM mode, this instance of the <tt class="docutils literal"><span class="pre">#LINK</span></tt> macro expands to &#8216;glossary&#8217;.</p>
<p>To create a hyperlink to an entry on a memory map page, use the address of the
entry as the anchor. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; Now we update the #LINK:GameStatusBuffer#40000(number of lives).
</pre></div>
</div>
<p>In HTML mode, the anchor of this <tt class="docutils literal"><span class="pre">#LINK</span></tt> macro (40000) is converted to the
format specified by the <tt class="docutils literal"><span class="pre">AddressAnchor</span></tt> parameter in the <a class="reference internal" href="ref-files.html#ref-game"><em>[Game]</em></a>
section.</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.4</td>
<td>When linking to an entry on a <a class="reference internal" href="ref-files.html#boxpages"><em>box page</em></a>, the
link text, if left blank, defaults to the title of the entry (in
HTML mode)</td>
</tr>
<tr class="row-odd"><td>5.2</td>
<td>An entry address anchor in a link to a memory map page is
converted to the format specified by the <tt class="docutils literal"><span class="pre">AddressAnchor</span></tt>
parameter</td>
</tr>
<tr class="row-even"><td>3.1.3</td>
<td>If left blank, the link text defaults to the page&#8217;s link text in
HTML mode</td>
</tr>
<tr class="row-odd"><td>2.1</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="list">
<span id="id14"></span><h3>#LIST<a class="headerlink" href="#list" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#LIST</span></tt> macro marks the beginning of a list of bulleted items; <tt class="docutils literal"><span class="pre">LIST#</span></tt>
is used to mark the end. Between these markers, the list items are defined.</p>
<div class="highlight-none"><div class="highlight"><pre>#LIST[(class)]&lt;items&gt;LIST#
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">class</span></tt> is the CSS class to use for the <tt class="docutils literal"><span class="pre">&lt;ul&gt;</span></tt> element</li>
</ul>
<p>Each item in a list must start with <tt class="docutils literal"><span class="pre">{</span></tt> followed by a whitespace character,
and end with <tt class="docutils literal"><span class="pre">}</span></tt> preceded by a whitespace character.</p>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; #LIST(data)
; { Item 1 }
; { Item 2 }
; LIST#
</pre></div>
</div>
<p>This list has two items, and will have the CSS class &#8216;data&#8217;.</p>
<p>In ASM mode, lists are rendered as plain text, with each item on its own line,
and an asterisk as the bullet character. The bullet character can be changed by
using a <a class="reference internal" href="asm.html#set"><em>&#64;set</em></a> directive to set the <tt class="docutils literal"><span class="pre">bullet</span></tt> property on the ASM writer.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>3.2</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="n">
<span id="id15"></span><h3>#N<a class="headerlink" href="#n" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#N</span></tt> macro renders a numeric value in hexadecimal format when the
<tt class="docutils literal"><span class="pre">--hex</span></tt> option is used with <a class="reference internal" href="commands.html#skool2asm-py"><em>skool2asm.py</em></a> or <a class="reference internal" href="commands.html#skool2html-py"><em>skool2html.py</em></a>, or in
decimal format otherwise. A hexadecimal number is rendered in lower case when
the <tt class="docutils literal"><span class="pre">--lower</span></tt> option is used, or in upper case otherwise.</p>
<div class="highlight-none"><div class="highlight"><pre>#Nvalue[,hwidth,dwidth,affix][(prefix[,suffix])]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">value</span></tt> is the numeric value</li>
<li><tt class="docutils literal"><span class="pre">hwidth</span></tt> is the minimum number of digits printed in hexadecimal output
(default: 2 for values &lt; 256, or 4 otherwise)</li>
<li><tt class="docutils literal"><span class="pre">dwidth</span></tt> is the minimum number of digits printed in decimal output
(default: 1)</li>
<li><tt class="docutils literal"><span class="pre">affix</span></tt> is 1 if <tt class="docutils literal"><span class="pre">prefix</span></tt> or <tt class="docutils literal"><span class="pre">suffix</span></tt> is specified, 0 if not (default:
0)</li>
<li><tt class="docutils literal"><span class="pre">prefix</span></tt> is the prefix for a hexadecimal number (default: empty string)</li>
<li><tt class="docutils literal"><span class="pre">suffix</span></tt> is the suffix for a hexadecimal number (default: empty string)</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>#N15,4,5,1(0x)
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#N</span></tt> macro expands to one of the following:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">00015</span></tt> (when <tt class="docutils literal"><span class="pre">--hex</span></tt> is not used)</li>
<li><tt class="docutils literal"><span class="pre">0x000F</span></tt> (when <tt class="docutils literal"><span class="pre">--hex</span></tt> is used without <tt class="docutils literal"><span class="pre">--lower</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">0x000f</span></tt> (when both <tt class="docutils literal"><span class="pre">--hex</span></tt> and <tt class="docutils literal"><span class="pre">--lower</span></tt> are used)</li>
</ul>
<p>See <a class="reference internal" href="#stringparameters"><em>String parameters</em></a> for details on alternative ways to supply the
<tt class="docutils literal"><span class="pre">prefix</span></tt> and <tt class="docutils literal"><span class="pre">suffix</span></tt> parameters.</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.2</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="r">
<span id="id16"></span><h3>#R<a class="headerlink" href="#r" title="Permalink to this headline">¶</a></h3>
<p>In HTML mode, the <tt class="docutils literal"><span class="pre">#R</span></tt> macro expands to a hyperlink (<tt class="docutils literal"><span class="pre">&lt;a&gt;</span></tt> element) to the
disassembly page for a routine or data block, or to a line at a given address
within that page.</p>
<div class="highlight-none"><div class="highlight"><pre>#Raddr[@code][#name][(link text)]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">addr</span></tt> is the address of the routine or data block (or entry point
thereof)</li>
<li><tt class="docutils literal"><span class="pre">code</span></tt> is the ID of the disassembly that contains the routine or data block
(if not given, the current disassembly is assumed; otherwise this must be an
ID defined in an <tt class="docutils literal"><span class="pre">[OtherCode:*]</span></tt> section of the ref file)</li>
<li><tt class="docutils literal"><span class="pre">#name</span></tt> is the named anchor of an item on the disassembly page</li>
<li><tt class="docutils literal"><span class="pre">link</span> <span class="pre">text</span></tt> is the link text to use (default: <tt class="docutils literal"><span class="pre">addr</span></tt>)</li>
</ul>
<p>The disassembly ID (<tt class="docutils literal"><span class="pre">code</span></tt>) and anchor name (<tt class="docutils literal"><span class="pre">name</span></tt>) must be limited to the
characters &#8216;$&#8217;, &#8216;#&#8217;, 0-9, A-Z and a-z.</p>
<p>In ASM mode, the <tt class="docutils literal"><span class="pre">#R</span></tt> macro expands to the link text if it is specified, or
to the label for <tt class="docutils literal"><span class="pre">addr</span></tt>, or to <tt class="docutils literal"><span class="pre">addr</span></tt> if no label is found.</p>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; Prepare for a new game
;
; Used by the routine at #R25820.
</pre></div>
</div>
<p>In HTML mode, this instance of the <tt class="docutils literal"><span class="pre">#R</span></tt> macro expands to a hyperlink to the
disassembly page for the routine at 25820.</p>
<p>In ASM mode, this instance of the <tt class="docutils literal"><span class="pre">#R</span></tt> macro expands to the label for the
routine at 25820 (or simply <tt class="docutils literal"><span class="pre">25820</span></tt> if that routine has no label).</p>
<p>To create a hyperlink to the first instruction in a routine or data block, use
an anchor that evaluates to the address of that instruction. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; See the #R40000#40000(first item) in the data table at 40000.
</pre></div>
</div>
<p>In HTML mode, the anchor of this <tt class="docutils literal"><span class="pre">#R</span></tt> macro (40000) is converted to the
format specified by the <tt class="docutils literal"><span class="pre">AddressAnchor</span></tt> parameter in the <a class="reference internal" href="ref-files.html#ref-game"><em>[Game]</em></a>
section.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>An anchor that matches the entry address is converted to the
format specified by the <tt class="docutils literal"><span class="pre">AddressAnchor</span></tt> parameter; added
support for arithmetic expressions and skool macros in the
<tt class="docutils literal"><span class="pre">addr</span></tt> parameter</td>
</tr>
<tr class="row-odd"><td>3.5</td>
<td>Added the ability to resolve (in HTML mode) the address of an
entry point in another disassembly when an appropriate
<a class="reference internal" href="skool-files.html#rentry"><em>remote entry</em></a> is defined</td>
</tr>
<tr class="row-even"><td>2.0</td>
<td>Added support for the <tt class="docutils literal"><span class="pre">&#64;code</span></tt> notation</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="reg">
<span id="id17"></span><h3>#REG<a class="headerlink" href="#reg" title="Permalink to this headline">¶</a></h3>
<p>In HTML mode, the <tt class="docutils literal"><span class="pre">#REG</span></tt> macro expands to a styled <tt class="docutils literal"><span class="pre">&lt;span&gt;</span></tt> element
containing a register name or arbitrary text (with case adjusted as
appropriate).</p>
<div class="highlight-none"><div class="highlight"><pre>#REGreg
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">reg</span></tt> is the name of the register, or:</p>
<div class="highlight-none"><div class="highlight"><pre>#REG(text)
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">text</span></tt> is arbitrary text (e.g. <tt class="docutils literal"><span class="pre">hlh'l'</span></tt>).</p>
<p>See <a class="reference internal" href="#stringparameters"><em>String parameters</em></a> for details on alternative ways to supply the
<tt class="docutils literal"><span class="pre">text</span></tt> parameter. Note that if an alternative delimiter is used, it must not
be a letter.</p>
<p>In ASM mode, the <tt class="docutils literal"><span class="pre">#REG</span></tt> macro expands to either <tt class="docutils literal"><span class="pre">reg</span></tt> or <tt class="docutils literal"><span class="pre">text</span></tt> (with
case adjusted as appropriate).</p>
<p>The register name (<tt class="docutils literal"><span class="pre">reg</span></tt>) must be one of the following:</p>
<div class="highlight-none"><div class="highlight"><pre>a b c d e f h l
a&#39; b&#39; c&#39; d&#39; e&#39; f&#39; h&#39; l&#39;
af bc de hl
af&#39; bc&#39; de&#39; hl&#39;
ix iy ixh iyh ixl iyl
i r sp pc
</pre></div>
</div>
<p>For example:</p>
<div class="nonexistent highlight-none"><div class="highlight"><pre> 24623 LD C,31       ; #REGbc&#39;=31
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.4</td>
<td>Added support for an arbitrary text parameter</td>
</tr>
<tr class="row-odd"><td>5.3</td>
<td>Added support for the F and F&#8217; registers</td>
</tr>
<tr class="row-even"><td>5.1</td>
<td>The <tt class="docutils literal"><span class="pre">reg</span></tt> parameter must be a valid register name</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="space">
<span id="id18"></span><h3>#SPACE<a class="headerlink" href="#space" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#SPACE</span></tt> macro expands to one or more <tt class="docutils literal"><span class="pre">&amp;#160;</span></tt> expressions (in HTML
mode) or spaces (in ASM mode).</p>
<div class="highlight-none"><div class="highlight"><pre>#SPACE[num]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">num</span></tt> is the number of spaces required (default: 1)</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; &#39;#SPACE8&#39; (8 spaces)
t56832 DEFM &quot;        &quot;
</pre></div>
</div>
<p>In HTML mode, this instance of the <tt class="docutils literal"><span class="pre">#SPACE</span></tt> macro expands to:</p>
<div class="highlight-none"><div class="highlight"><pre>&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;&amp;#160;
</pre></div>
</div>
<p>In ASM mode, this instance of the <tt class="docutils literal"><span class="pre">#SPACE</span></tt> macro expands to a string
containing 8 spaces.</p>
<p>The form <tt class="docutils literal"><span class="pre">SPACE([num])</span></tt> may be used to distinguish the macro from adjacent
text where necessary. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; &#39;Score:#SPACE(5)0&#39;
t49152 DEFM &quot;Score:     0&quot;
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>Added support for arithmetic expressions and skool macros in the
<tt class="docutils literal"><span class="pre">num</span></tt> parameter</td>
</tr>
<tr class="row-odd"><td>2.4.1</td>
<td>Added support for the <tt class="docutils literal"><span class="pre">#SPACE([num])</span></tt> syntax</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="table">
<span id="id19"></span><h3>#TABLE<a class="headerlink" href="#table" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#TABLE</span></tt> macro marks the beginning of a table; <tt class="docutils literal"><span class="pre">TABLE#</span></tt> is used to mark
the end. Between these markers, the rows of the table are defined.</p>
<div class="highlight-none"><div class="highlight"><pre>#TABLE[([class[,class1[:w][,class2[:w]...]]])]&lt;rows&gt;TABLE#
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">class</span></tt> is the CSS class to use for the <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt> element</li>
<li><tt class="docutils literal"><span class="pre">class1</span></tt>, <tt class="docutils literal"><span class="pre">class2</span></tt> etc. are the CSS classes to use for the <tt class="docutils literal"><span class="pre">&lt;td&gt;</span></tt>
elements in columns 1, 2 etc.</li>
</ul>
<p>Each row in a table must start with <tt class="docutils literal"><span class="pre">{</span></tt> followed by a whitespace character,
and end with <tt class="docutils literal"><span class="pre">}</span></tt> preceded by a whitespace character. The cells in a row must
be separated by <tt class="docutils literal"><span class="pre">|</span></tt> with a whitespace character on each side.</p>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; #TABLE(default,centre)
; { 0 | Off }
; { 1 | On }
; TABLE#
</pre></div>
</div>
<p>This table has two rows and two columns, and will have the CSS class &#8216;default&#8217;.
The cells in the first column will have the CSS class &#8216;centre&#8217;.</p>
<p>By default, cells will be rendered as <tt class="docutils literal"><span class="pre">&lt;td&gt;</span></tt> elements. To render a cell as a
<tt class="docutils literal"><span class="pre">&lt;th&gt;</span></tt> element, use the <tt class="docutils literal"><span class="pre">=h</span></tt> indicator before the cell contents:</p>
<div class="highlight-none"><div class="highlight"><pre>; #TABLE
; { =h Header 1  | =h Header 2 }
; { Regular cell | Another one }
; TABLE#
</pre></div>
</div>
<p>It is also possible to specify <tt class="docutils literal"><span class="pre">colspan</span></tt> and <tt class="docutils literal"><span class="pre">rowspan</span></tt> attributes using the
<tt class="docutils literal"><span class="pre">=c</span></tt> and <tt class="docutils literal"><span class="pre">=r</span></tt> indicators:</p>
<div class="highlight-none"><div class="highlight"><pre>; #TABLE
; { =r2 2 rows  | X | Y }
; { =c2           2 columns }
; TABLE#
</pre></div>
</div>
<p>Finally, the <tt class="docutils literal"><span class="pre">=t</span></tt> indicator makes a cell transparent (i.e. gives it the same
background colour as the page body).</p>
<p>If a cell requires more than one indicator, separate the indicators by commas:</p>
<div class="highlight-none"><div class="highlight"><pre>; #TABLE
; { =h,c2 Wide header }
; { Column 1 | Column 2 }
; TABLE#
</pre></div>
</div>
<p>The CSS files included in SkoolKit provide two classes that may be used when
defining tables:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">default</span></tt> - a class for <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt> elements that provides a background
colour to make the table stand out from the page body</li>
<li><tt class="docutils literal"><span class="pre">centre</span></tt> - a class for <tt class="docutils literal"><span class="pre">&lt;td&gt;</span></tt> elements that centres their contents</li>
</ul>
<p>In ASM mode, tables are rendered as plain text, using dashes (<tt class="docutils literal"><span class="pre">-</span></tt>) and pipes
(<tt class="docutils literal"><span class="pre">|</span></tt>) for the borders, and plus signs (<tt class="docutils literal"><span class="pre">+</span></tt>) where a horizontal border meets
a vertical border.</p>
<p>ASM mode also supports the <tt class="docutils literal"><span class="pre">:w</span></tt> indicator in the <tt class="docutils literal"><span class="pre">#TABLE</span></tt> macro&#8217;s
parameters. The <tt class="docutils literal"><span class="pre">:w</span></tt> indicator marks a column as a candidate for having its
width reduced (by wrapping the text it contains) so that the table will be no
more than 79 characters wide when rendered. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; #TABLE(default,centre,:w)
; { =h X | =h Description }
; { 0    | Text in this column will be wrapped in ASM mode to make the table less than 80 characters wide }
; TABLE#
</pre></div>
</div>
<p>See also <a class="reference internal" href="#udgtable"><em>#UDGTABLE</em></a>.</p>
</div>
<div class="section" id="udgtable">
<span id="id20"></span><h3>#UDGTABLE<a class="headerlink" href="#udgtable" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#UDGTABLE</span></tt> macro behaves in exactly the same way as the <tt class="docutils literal"><span class="pre">#TABLE</span></tt>
macro, except that the resulting table will not be rendered in ASM mode. Its
intended use is to contain images that will be rendered in HTML mode only.</p>
<p>See <a class="reference internal" href="#table"><em>#TABLE</em></a>, and also <a class="reference internal" href="#html"><em>#HTML</em></a>.</p>
</div>
<div class="section" id="version">
<span id="id21"></span><h3>#VERSION<a class="headerlink" href="#version" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#VERSION</span></tt> macro expands to the version of SkoolKit.</p>
<div class="highlight-none"><div class="highlight"><pre>#VERSION
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>6.0</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="image-macros">
<span id="imagemacros"></span><h2>Image macros<a class="headerlink" href="#image-macros" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#font"><em>#FONT</em></a>, <a class="reference internal" href="#scr"><em>#SCR</em></a>, <a class="reference internal" href="#udg"><em>#UDG</em></a> and <a class="reference internal" href="#udgarray"><em>#UDGARRAY</em></a> macros (described
in the following sections) may be used to create images based on graphic data
in the memory snapshot. They are not supported in ASM mode.</p>
<p>These macros have several numeric parameters, most of which are optional. This
can give rise to a long sequence of commas in a macro parameter string, making
it hard to read (and write); for example:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDG32768,,,,,,1
</pre></div>
</div>
<p>To alleviate this problem, the image macros accept keyword arguments at any
position in the parameter string; the <tt class="docutils literal"><span class="pre">#UDG</span></tt> macro above could be rewritten
as follows:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDG32768,rotate=1
</pre></div>
</div>
<div class="section" id="font">
<span id="id22"></span><h3>#FONT<a class="headerlink" href="#font" title="Permalink to this headline">¶</a></h3>
<p>In HTML mode, the <tt class="docutils literal"><span class="pre">#FONT</span></tt> macro expands to an <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt> element for an image
of text rendered in the game font.</p>
<div class="highlight-none"><div class="highlight"><pre>#FONT[:(text)]addr[,chars,attr,scale][{CROP}][(fname)]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">text</span></tt> is the text to render (default: the 96 characters from code 32 to
code 127)</li>
<li><tt class="docutils literal"><span class="pre">addr</span></tt> is the base address of the font graphic data</li>
<li><tt class="docutils literal"><span class="pre">chars</span></tt> is the number of characters to render (default: the length of
<tt class="docutils literal"><span class="pre">text</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">attr</span></tt> is the attribute byte to use (default: 56)</li>
<li><tt class="docutils literal"><span class="pre">scale</span></tt> is the scale of the image (default: 2)</li>
<li><tt class="docutils literal"><span class="pre">CROP</span></tt> is the cropping specification (see <a class="reference internal" href="#cropping"><em>Cropping</em></a>)</li>
<li><tt class="docutils literal"><span class="pre">fname</span></tt> is the name of the image file (default: &#8216;<cite>font</cite>&#8216;); &#8216;<cite>.png</cite>&#8216; or
&#8216;<cite>.gif</cite>&#8216; will be appended (depending on the default image format specified in
the <a class="reference internal" href="ref-files.html#ref-imagewriter"><em>[ImageWriter]</em></a> section of the ref file) if not present</li>
</ul>
<p>If an image with the given filename doesn&#8217;t already exist, it will be created.
If <tt class="docutils literal"><span class="pre">fname</span></tt> starts with a &#8216;/&#8217;, the filename is taken to be relative to the
root of the HTML disassembly; otherwise the filename is taken to be relative to
the directory defined by the <tt class="docutils literal"><span class="pre">FontImagePath</span></tt> parameter in the <a class="reference internal" href="ref-files.html#paths"><em>[Paths]</em></a>
section of the ref file.</p>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; Font graphic data
;
; #HTML[#FONT:(0123456789)49152]
</pre></div>
</div>
<p>In HTML mode, this instance of the <tt class="docutils literal"><span class="pre">#FONT</span></tt> macro expands to an <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt>
element for the image of the digits 0-9 in the 8x8 font whose graphic data
starts at 49152.</p>
<p>See <a class="reference internal" href="#stringparameters"><em>String parameters</em></a> for details on alternative ways to supply the
<tt class="docutils literal"><span class="pre">text</span></tt> parameter.</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>Added support for arithmetic expressions and skool macros in the
numeric parameters</td>
</tr>
<tr class="row-odd"><td>4.3</td>
<td>Added the ability to create frames</td>
</tr>
<tr class="row-even"><td>4.2</td>
<td>Added the ability to specify alt text for the <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt> element</td>
</tr>
<tr class="row-odd"><td>4.0</td>
<td>Added support for keyword arguments</td>
</tr>
<tr class="row-even"><td>3.6</td>
<td>Added the <tt class="docutils literal"><span class="pre">text</span></tt> parameter, and made the <tt class="docutils literal"><span class="pre">chars</span></tt> parameter
optional</td>
</tr>
<tr class="row-odd"><td>3.0</td>
<td>Added image-cropping capabilities</td>
</tr>
<tr class="row-even"><td>2.0.5</td>
<td>Added the <tt class="docutils literal"><span class="pre">fname</span></tt> parameter and support for regular 8x8 fonts</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="scr">
<span id="id23"></span><h3>#SCR<a class="headerlink" href="#scr" title="Permalink to this headline">¶</a></h3>
<p>In HTML mode, the <tt class="docutils literal"><span class="pre">#SCR</span></tt> macro expands to an <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt> element for an image
constructed from the display file and attribute file (or suitably arranged
graphic data and attribute bytes elsewhere in memory) of the current memory
snapshot (in turn constructed from the contents of the skool file).</p>
<div class="highlight-none"><div class="highlight"><pre>#SCR[scale,x,y,w,h,df,af][{CROP}][(fname)]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">scale</span></tt> is the scale of the image (default: 1)</li>
<li><tt class="docutils literal"><span class="pre">x</span></tt> is the x-coordinate of the top-left tile of the screen to include in
the screenshot (default: 0)</li>
<li><tt class="docutils literal"><span class="pre">y</span></tt> is the y-coordinate of the top-left tile of the screen to include in
the screenshot (default: 0)</li>
<li><tt class="docutils literal"><span class="pre">w</span></tt> is the width of the screenshot in tiles (default: 32)</li>
<li><tt class="docutils literal"><span class="pre">h</span></tt> is the height of the screenshot in tiles (default: 24)</li>
<li><tt class="docutils literal"><span class="pre">df</span></tt> is the base address of the display file (default: 16384)</li>
<li><tt class="docutils literal"><span class="pre">af</span></tt> is the base address of the attribute file (default: 22528)</li>
<li><tt class="docutils literal"><span class="pre">CROP</span></tt> is the cropping specification (see <a class="reference internal" href="#cropping"><em>Cropping</em></a>)</li>
<li><tt class="docutils literal"><span class="pre">fname</span></tt> is the name of the image file (default: &#8216;<cite>scr</cite>&#8216;); &#8216;<cite>.png</cite>&#8216; or
&#8216;<cite>.gif</cite>&#8216; will be appended (depending on the default image format specified in
the <a class="reference internal" href="ref-files.html#ref-imagewriter"><em>[ImageWriter]</em></a> section of the ref file) if not present</li>
</ul>
<p>If an image with the given filename doesn&#8217;t already exist, it will be created.
If <tt class="docutils literal"><span class="pre">fname</span></tt> starts with a &#8216;/&#8217;, the filename is taken to be relative to the
root of the HTML disassembly; otherwise the filename is taken to be relative to
the directory defined by the <tt class="docutils literal"><span class="pre">ScreenshotImagePath</span></tt> parameter in the
<a class="reference internal" href="ref-files.html#paths"><em>[Paths]</em></a> section of the ref file.</p>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; #UDGTABLE
; { #SCR(loading) | This is the loading screen. }
; TABLE#
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In SkoolKit 5.0 and earlier versions, <tt class="docutils literal"><span class="pre">#SCR(2)</span></tt> would create an image file
named <cite>2.png</cite> using the default parameter values. However, since the
introduction in version 5.1 of support for arithmetic expressions in numeric
parameters, <tt class="docutils literal"><span class="pre">#SCR(2)</span></tt> creates an image file with the default name and
scale 2; to create an image file named <cite>2.png</cite> with the default parameter
values in SkoolKit 5.1+, write <tt class="docutils literal"><span class="pre">#SCR()(2)</span></tt> instead.</p>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>Added support for arithmetic expressions and skool macros in the
numeric parameters</td>
</tr>
<tr class="row-odd"><td>4.3</td>
<td>Added the ability to create frames</td>
</tr>
<tr class="row-even"><td>4.2</td>
<td>Added the ability to specify alt text for the <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt> element</td>
</tr>
<tr class="row-odd"><td>4.0</td>
<td>Added support for keyword arguments</td>
</tr>
<tr class="row-even"><td>3.0</td>
<td>Added image-cropping capabilities and the <tt class="docutils literal"><span class="pre">df</span></tt> and <tt class="docutils literal"><span class="pre">af</span></tt>
parameters</td>
</tr>
<tr class="row-odd"><td>2.0.5</td>
<td>Added the <tt class="docutils literal"><span class="pre">scale</span></tt>, <tt class="docutils literal"><span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">y</span></tt>, <tt class="docutils literal"><span class="pre">w</span></tt>, <tt class="docutils literal"><span class="pre">h</span></tt> and <tt class="docutils literal"><span class="pre">fname</span></tt>
parameters</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="udg">
<span id="id24"></span><h3>#UDG<a class="headerlink" href="#udg" title="Permalink to this headline">¶</a></h3>
<p>In HTML mode, the <tt class="docutils literal"><span class="pre">#UDG</span></tt> macro expands to an <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt> element for the image
of a UDG (an 8x8 block of pixels).</p>
<div class="highlight-none"><div class="highlight"><pre>#UDGaddr[,attr,scale,step,inc,flip,rotate,mask][:MASK][{CROP}][(fname)]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">addr</span></tt> is the base address of the UDG bytes</li>
<li><tt class="docutils literal"><span class="pre">attr</span></tt> is the attribute byte to use (default: 56)</li>
<li><tt class="docutils literal"><span class="pre">scale</span></tt> is the scale of the image (default: 4)</li>
<li><tt class="docutils literal"><span class="pre">step</span></tt> is the interval between successive bytes of the UDG (default: 1)</li>
<li><tt class="docutils literal"><span class="pre">inc</span></tt> is added to each UDG byte before constructing the image (default: 0)</li>
<li><tt class="docutils literal"><span class="pre">flip</span></tt> is 1 to flip the UDG horizontally, 2 to flip it vertically, 3 to
flip it both ways, or 0 to leave it as it is (default: 0)</li>
<li><tt class="docutils literal"><span class="pre">rotate</span></tt> is 1 to rotate the UDG 90 degrees clockwise, 2 to rotate it 180
degrees, 3 to rotate it 90 degrees anticlockwise, or 0 to leave it as it is
(default: 0)</li>
<li><tt class="docutils literal"><span class="pre">mask</span></tt> is the type of mask to apply (see <a class="reference internal" href="#masks"><em>Masks</em></a>)</li>
<li><tt class="docutils literal"><span class="pre">MASK</span></tt> is the mask specification (see below)</li>
<li><tt class="docutils literal"><span class="pre">CROP</span></tt> is the cropping specification (see <a class="reference internal" href="#cropping"><em>Cropping</em></a>)</li>
<li><tt class="docutils literal"><span class="pre">fname</span></tt> is the name of the image file (if not given, a name specified by
the <tt class="docutils literal"><span class="pre">UDGFilename</span></tt> parameter in the <a class="reference internal" href="ref-files.html#ref-game"><em>[Game]</em></a> section will be used);
&#8216;<cite>.png</cite>&#8216; or &#8216;<cite>.gif</cite>&#8216; will be appended (depending on the default image format
specified in the <a class="reference internal" href="ref-files.html#ref-imagewriter"><em>[ImageWriter]</em></a> section) if not present</li>
</ul>
<p>The mask specification (<tt class="docutils literal"><span class="pre">MASK</span></tt>) takes the form:</p>
<div class="highlight-none"><div class="highlight"><pre>addr[,step]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">addr</span></tt> is the base address of the mask bytes to use for the UDG</li>
<li><tt class="docutils literal"><span class="pre">step</span></tt> is the interval between successive mask bytes (defaults to the value
of <tt class="docutils literal"><span class="pre">step</span></tt> for the UDG)</li>
</ul>
<p>Note that if any of the parameters in the mask specification is expressed using
arithmetic operations or skool macros, then the entire specification must be
enclosed in parentheses.</p>
<p>If an image with the given filename (<tt class="docutils literal"><span class="pre">fname</span></tt>) doesn&#8217;t already exist, it will
be created.  If <tt class="docutils literal"><span class="pre">fname</span></tt> starts with a &#8216;/&#8217;, the filename is taken to be
relative to the root of the HTML disassembly; otherwise the filename is taken
to be relative to the directory defined by the <tt class="docutils literal"><span class="pre">UDGImagePath</span></tt> parameter in
the <a class="reference internal" href="ref-files.html#paths"><em>[Paths]</em></a> section of the ref file.</p>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; Safe key UDG
;
; #HTML[#UDG39144,6(safe_key)]
</pre></div>
</div>
<p>In HTML mode, this instance of the <tt class="docutils literal"><span class="pre">#UDG</span></tt> macro expands to an <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt>
element for the image of the UDG at 39144 (which will be named <cite>safe_key.png</cite>
or <cite>safe_key.gif</cite>), with attribute byte 6 (INK 6: PAPER 0).</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>Added support for arithmetic expressions and skool macros in the
numeric parameters</td>
</tr>
<tr class="row-odd"><td>4.3</td>
<td>Added the ability to create frames</td>
</tr>
<tr class="row-even"><td>4.2</td>
<td>Added the ability to specify alt text for the <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt> element</td>
</tr>
<tr class="row-odd"><td>4.0</td>
<td>Added the <tt class="docutils literal"><span class="pre">mask</span></tt> parameter and support for AND-OR masking;
added support for keyword arguments</td>
</tr>
<tr class="row-even"><td>3.1.2</td>
<td>Made the <tt class="docutils literal"><span class="pre">attr</span></tt> parameter optional</td>
</tr>
<tr class="row-odd"><td>3.0</td>
<td>Added image-cropping capabilities</td>
</tr>
<tr class="row-even"><td>2.4</td>
<td>Added the <tt class="docutils literal"><span class="pre">rotate</span></tt> parameter</td>
</tr>
<tr class="row-odd"><td>2.3.1</td>
<td>Added the <tt class="docutils literal"><span class="pre">flip</span></tt> parameter</td>
</tr>
<tr class="row-even"><td>2.1</td>
<td>Added support for masks</td>
</tr>
<tr class="row-odd"><td>2.0.5</td>
<td>Added the <tt class="docutils literal"><span class="pre">fname</span></tt> parameter</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="udgarray">
<span id="id25"></span><h3>#UDGARRAY<a class="headerlink" href="#udgarray" title="Permalink to this headline">¶</a></h3>
<p>In HTML mode, the <tt class="docutils literal"><span class="pre">#UDGARRAY</span></tt> macro expands to an <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt> element for the
image of an array of UDGs (8x8 blocks of pixels).</p>
<div class="highlight-none"><div class="highlight"><pre>#UDGARRAYwidth[,attr,scale,step,inc,flip,rotate,mask];SPEC1[;SPEC2;...][{CROP}](fname)
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">width</span></tt> is the width of the image (in UDGs)</li>
<li><tt class="docutils literal"><span class="pre">attr</span></tt> is the default attribute byte of each UDG (default: 56)</li>
<li><tt class="docutils literal"><span class="pre">scale</span></tt> is the scale of the image (default: 2)</li>
<li><tt class="docutils literal"><span class="pre">step</span></tt> is the default interval between successive bytes of each UDG
(default: 1)</li>
<li><tt class="docutils literal"><span class="pre">inc</span></tt> is added to each UDG byte before constructing the image (default: 0)</li>
<li><tt class="docutils literal"><span class="pre">flip</span></tt> is 1 to flip the array of UDGs horizontally, 2 to flip it
vertically, 3 to flip it both ways, or 0 to leave it as it is (default: 0)</li>
<li><tt class="docutils literal"><span class="pre">rotate</span></tt> is 1 to rotate the array of UDGs 90 degrees clockwise, 2 to rotate
it 180 degrees, 3 to rotate it 90 degrees anticlockwise, or 0 to leave it as
it is (default: 0)</li>
<li><tt class="docutils literal"><span class="pre">mask</span></tt> is the type of mask to apply (see <a class="reference internal" href="#masks"><em>Masks</em></a>)</li>
<li><tt class="docutils literal"><span class="pre">CROP</span></tt> is the cropping specification (see <a class="reference internal" href="#cropping"><em>Cropping</em></a>)</li>
<li><tt class="docutils literal"><span class="pre">fname</span></tt> is the name of the image file; &#8216;<cite>.png</cite>&#8216; or &#8216;<cite>.gif</cite>&#8216; will be
appended (depending on the default image format specified in the
<a class="reference internal" href="ref-files.html#ref-imagewriter"><em>[ImageWriter]</em></a> section of the ref file) if not present</li>
</ul>
<p><tt class="docutils literal"><span class="pre">SPEC1</span></tt>, <tt class="docutils literal"><span class="pre">SPEC2</span></tt> etc. are UDG specifications for the sets of UDGs that make
up the array. Each UDG specification has the form:</p>
<div class="highlight-none"><div class="highlight"><pre>addr[,attr,step,inc][:MASK]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">addr</span></tt> is the address range specification for the set of UDGs (see below)</li>
<li><tt class="docutils literal"><span class="pre">attr</span></tt> is the attribute byte of each UDG in the set (defaults to the value
of <tt class="docutils literal"><span class="pre">attr</span></tt> for the UDG array)</li>
<li><tt class="docutils literal"><span class="pre">step</span></tt> is the interval between successive bytes of each UDG in the set
(defaults to the value of <tt class="docutils literal"><span class="pre">step</span></tt> for the UDG array)</li>
<li><tt class="docutils literal"><span class="pre">inc</span></tt> is added to each byte of every UDG in the set before constructing the
image (defaults to the value of <tt class="docutils literal"><span class="pre">inc</span></tt> for the UDG array)</li>
<li><tt class="docutils literal"><span class="pre">MASK</span></tt> is the mask specification</li>
</ul>
<p>The mask specification (<tt class="docutils literal"><span class="pre">MASK</span></tt>) takes the form:</p>
<div class="highlight-none"><div class="highlight"><pre>addr[,step]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">addr</span></tt> is the address range specification for the set of mask UDGs (see
below)</li>
<li><tt class="docutils literal"><span class="pre">step</span></tt> is the interval between successive bytes of each mask UDG in the set
(defaults to the value of <tt class="docutils literal"><span class="pre">step</span></tt> for the set of UDGs)</li>
</ul>
<p>Address range specifications (<tt class="docutils literal"><span class="pre">addr</span></tt>) may be given in one of the following
forms:</p>
<ul class="simple">
<li>a single address (e.g. <tt class="docutils literal"><span class="pre">39144</span></tt>)</li>
<li>a simple address range (e.g. <tt class="docutils literal"><span class="pre">33008-33015</span></tt>)</li>
<li>an address range with a step (e.g. <tt class="docutils literal"><span class="pre">32768-33792-256</span></tt>)</li>
<li>an address range with a horizontal and a vertical step (e.g.
<tt class="docutils literal"><span class="pre">63476-63525-1-16</span></tt>; this form specifies the step between the base addresses
of adjacent UDGs in each row as 1, and the step between the base addresses of
adjacent UDGs in each column as 16)</li>
</ul>
<p>Any of these forms of address ranges can be repeated by appending <tt class="docutils literal"><span class="pre">xN</span></tt>, where
<tt class="docutils literal"><span class="pre">N</span></tt> is the desired number of repetitions. For example:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">39648x3</span></tt> is equivalent to <tt class="docutils literal"><span class="pre">39648;39648;39648</span></tt></li>
<li><tt class="docutils literal"><span class="pre">32768-32769x2</span></tt> is equivalent to <tt class="docutils literal"><span class="pre">32768;32769;32768;32769</span></tt></li>
</ul>
<p>As many UDG specifications as required may be supplied, separated by
semicolons; the UDGs will be arranged in a rectangular array with the given
width.</p>
<p>Note that, like the main parameters of a <tt class="docutils literal"><span class="pre">#UDGARRAY</span></tt> macro (up to but not
including the first semicolon), if any of the following parts of the parameter
string is expressed using arithmetic operations or skool macros, then that part
must be enclosed in parentheses:</p>
<ul class="simple">
<li>any of the 1-5 parts of a UDG address range specification (separated by <tt class="docutils literal"><span class="pre">-</span></tt>
and <tt class="docutils literal"><span class="pre">x</span></tt>)</li>
<li>the part of a UDG specification after the comma that follows the address
range</li>
<li>any of the 1-5 parts of a mask address range specification (separated by
<tt class="docutils literal"><span class="pre">-</span></tt> and <tt class="docutils literal"><span class="pre">x</span></tt>)</li>
<li>the part of a mask specification after the comma that follows the address
range</li>
</ul>
<p>If an image with the given filename (<tt class="docutils literal"><span class="pre">fname</span></tt>) doesn&#8217;t already exist, it will
be created.  If <tt class="docutils literal"><span class="pre">fname</span></tt> starts with a &#8216;/&#8217;, the filename is taken to be
relative to the root of the HTML disassembly; otherwise the filename is taken
to be relative to the directory defined by the <tt class="docutils literal"><span class="pre">UDGImagePath</span></tt> parameter in
the <a class="reference internal" href="ref-files.html#paths"><em>[Paths]</em></a> section of the ref file.</p>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; Base sprite
;
; #HTML[#UDGARRAY4;32768-32888-8(base_sprite.png)]
</pre></div>
</div>
<p>In HTML mode, this instance of the <tt class="docutils literal"><span class="pre">#UDGARRAY</span></tt> macro expands to an <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt>
element for the image of the 4x4 sprite formed by the 16 UDGs with base
addresses 32768, 32776, 32784 and so on up to 32888; the image file will be
named <cite>base_sprite.png</cite>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>Added support for arithmetic expressions and skool macros in the
numeric parameters</td>
</tr>
<tr class="row-odd"><td>4.2</td>
<td>Added the ability to specify alt text for the <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt> element</td>
</tr>
<tr class="row-even"><td>4.0</td>
<td>Added the <tt class="docutils literal"><span class="pre">mask</span></tt> parameter and support for AND-OR masking;
added support for keyword arguments</td>
</tr>
<tr class="row-odd"><td>3.6</td>
<td>Added support for creating an animated image from an arbitrary
sequence of frames</td>
</tr>
<tr class="row-even"><td>3.1.1</td>
<td>Added support for UDG address ranges with horizontal and vertical
steps</td>
</tr>
<tr class="row-odd"><td>3.0</td>
<td>Added image-cropping capabilities</td>
</tr>
<tr class="row-even"><td>2.4</td>
<td>Added the <tt class="docutils literal"><span class="pre">rotate</span></tt> parameter</td>
</tr>
<tr class="row-odd"><td>2.3.1</td>
<td>Added the <tt class="docutils literal"><span class="pre">flip</span></tt> parameter</td>
</tr>
<tr class="row-even"><td>2.2.5</td>
<td>Added support for masks</td>
</tr>
<tr class="row-odd"><td>2.0.5</td>
<td>New</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="alt-text">
<h3>Alt text<a class="headerlink" href="#alt-text" title="Permalink to this headline">¶</a></h3>
<p>The value of the <tt class="docutils literal"><span class="pre">alt</span></tt> attribute in the <tt class="docutils literal"><span class="pre">&lt;img&gt;</span></tt> element created by an image
macro can be specified by appending a <tt class="docutils literal"><span class="pre">|</span></tt> character and the required text to
the filename. For example:</p>
<div class="highlight-none"><div class="highlight"><pre>#SCR(screenshot1|Screenshot 1)
</pre></div>
</div>
<p>This <tt class="docutils literal"><span class="pre">#SCR</span></tt> macro creates an image named <cite>screenshot1.png</cite> with alt text
&#8216;Screenshot 1&#8217;.</p>
</div>
<div class="section" id="animation">
<h3>Animation<a class="headerlink" href="#animation" title="Permalink to this headline">¶</a></h3>
<p>The image macros may be used to create the frames of an animated image. To
create a frame, the <tt class="docutils literal"><span class="pre">fname</span></tt> parameter must have one of the following forms:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">name*</span></tt> - writes an image file with this name, and also creates a frame
with the same name</li>
<li><tt class="docutils literal"><span class="pre">name1*name2</span></tt> - writes an image file named <cite>name1</cite>, and also creates a
frame named <cite>name2</cite></li>
<li><tt class="docutils literal"><span class="pre">*name</span></tt> - writes no image file, but creates a frame with this name</li>
</ul>
<p>Then a special form of the <tt class="docutils literal"><span class="pre">#UDGARRAY</span></tt> macro creates the animated image from
a set of frames:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDGARRAY*FRAME1[;FRAME2;...](fname)
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">FRAME1</span></tt>, <tt class="docutils literal"><span class="pre">FRAME2</span></tt> etc. are frame specifications; each one has the form:</p>
<div class="highlight-none"><div class="highlight"><pre>name[,delay]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">name</span></tt> is the name of the frame</li>
<li><tt class="docutils literal"><span class="pre">delay</span></tt> is the delay between this frame and the next in 1/100ths of a
second; it also sets the default delay for any frames that follow (default:
32)</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>; #UDGTABLE {
; #FONT:(hello)$3D00(hello*) |
; #FONT:(there)$3D00(there*) |
; #FONT:(peeps)$3D00(peeps*) |
; #UDGARRAY*hello,50;there;peeps(hello_there_peeps.gif)
; } TABLE#
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">#FONT</span></tt> macros create the required frames (and write images of them); the
<tt class="docutils literal"><span class="pre">#UDGARRAY</span></tt> macro combines the three frames into a single animated image,
with a delay of 0.5s between each frame.</p>
</div>
<div class="section" id="cropping">
<span id="id26"></span><h3>Cropping<a class="headerlink" href="#cropping" title="Permalink to this headline">¶</a></h3>
<p>Each image macro accepts a cropping specification (<tt class="docutils literal"><span class="pre">CROP</span></tt>) which takes the
form:</p>
<div class="highlight-none"><div class="highlight"><pre>x,y,width,height
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">x</span></tt> is the x-coordinate of the leftmost pixel column of the constructed
image to include in the final image (default: 0); if greater than 0, the
image will be cropped on the left</li>
<li><tt class="docutils literal"><span class="pre">y</span></tt> is the y-coordinate of the topmost pixel row of the constructed image
to include in the final image (default: 0); if greater than 0, the image will
be cropped on the top</li>
<li><tt class="docutils literal"><span class="pre">width</span></tt> is the width of the final image in pixels (default: width of the
constructed image)</li>
<li><tt class="docutils literal"><span class="pre">height</span></tt> is the height of the final image in pixels (default: height of the
constructed image)</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDG40000,scale=2{2,2,12,12}
</pre></div>
</div>
<p>This <tt class="docutils literal"><span class="pre">#UDG</span></tt> macro creates an image of the UDG at 40000, at scale 2, with the
top two rows and bottom two rows of pixels removed, and the leftmost two
columns and rightmost two columns of pixels removed.</p>
</div>
<div class="section" id="masks">
<span id="id27"></span><h3>Masks<a class="headerlink" href="#masks" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#udg"><em>#UDG</em></a> and <a class="reference internal" href="#udgarray"><em>#UDGARRAY</em></a> macros accept a <tt class="docutils literal"><span class="pre">mask</span></tt> parameter that
determines what kind of mask to apply to each UDG. The supported values are:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">0</span></tt> - no mask</li>
<li><tt class="docutils literal"><span class="pre">1</span></tt> - OR-AND mask (this is the default)</li>
<li><tt class="docutils literal"><span class="pre">2</span></tt> - AND-OR mask</li>
</ul>
<p>Given a &#8216;background&#8217; bit (B), a UDG bit (U), and a mask bit (M), the OR-AND
mask works as follows:</p>
<ul class="simple">
<li>OR the UDG bit (U) onto the background bit (B)</li>
<li>AND the mask bit (M) onto the result</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">U</th>
<th class="head">M</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
<td>0 (paper)</td>
</tr>
<tr class="row-odd"><td>0</td>
<td>1</td>
<td>B (transparent)</td>
</tr>
<tr class="row-even"><td>1</td>
<td>0</td>
<td>0 (paper)</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>1</td>
<td>1 (ink)</td>
</tr>
</tbody>
</table>
<p>The AND-OR mask works as follows:</p>
<ul class="simple">
<li>AND the mask bit (M) onto the background bit (B)</li>
<li>OR the UDG bit (U) onto the result</li>
</ul>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="6%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">U</th>
<th class="head">M</th>
<th class="head">Result</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
<td>0 (paper)</td>
</tr>
<tr class="row-odd"><td>0</td>
<td>1</td>
<td>B (transparent)</td>
</tr>
<tr class="row-even"><td>1</td>
<td>0</td>
<td>1 (ink)</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>1</td>
<td>1 (ink)</td>
</tr>
</tbody>
</table>
<p>By default, transparent bits in masked images are rendered in bright green
(#00fe00); this colour can be changed by modifying the <tt class="docutils literal"><span class="pre">TRANSPARENT</span></tt>
parameter in the <a class="reference internal" href="ref-files.html#ref-colours"><em>[Colours]</em></a> section. To make the transparent bits in
masked images actually transparent, set <tt class="docutils literal"><span class="pre">GIFTransparency=1</span></tt> or <tt class="docutils literal"><span class="pre">PNGAlpha=0</span></tt>
in the <a class="reference internal" href="ref-files.html#ref-imagewriter"><em>[ImageWriter]</em></a> section.</p>
</div>
</div>
<div class="section" id="snapshot-macros">
<h2>Snapshot macros<a class="headerlink" href="#snapshot-macros" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#pokes"><em>#POKES</em></a>, <a class="reference internal" href="#pops"><em>#POPS</em></a> and <a class="reference internal" href="#pushs"><em>#PUSHS</em></a> macros (described in the
following sections) may be used to manipulate the memory snapshot that is built
from the <tt class="docutils literal"><span class="pre">DEFB</span></tt>, <tt class="docutils literal"><span class="pre">DEFM</span></tt>, <tt class="docutils literal"><span class="pre">DEFS</span></tt> and <tt class="docutils literal"><span class="pre">DEFW</span></tt> statements in the skool
file. Each macro expands to an empty string.</p>
<div class="section" id="pokes">
<span id="id28"></span><h3>#POKES<a class="headerlink" href="#pokes" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#POKES</span></tt> macro POKEs values into the current memory snapshot.</p>
<div class="highlight-none"><div class="highlight"><pre>#POKESaddr,byte[,length,step][;addr,byte[,length,step];...]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">addr</span></tt> is the address to POKE</li>
<li><tt class="docutils literal"><span class="pre">byte</span></tt> is the value to POKE <tt class="docutils literal"><span class="pre">addr</span></tt> with</li>
<li><tt class="docutils literal"><span class="pre">length</span></tt> is the number of addresses to POKE (default: 1)</li>
<li><tt class="docutils literal"><span class="pre">step</span></tt> is the address increment to use after each POKE (if <tt class="docutils literal"><span class="pre">length</span></tt>&gt;1;
default: 1)</li>
</ul>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>The UDG looks like this:

#UDG32768(udg_orig)

But it&#39;s supposed to look like this:

#PUSHS
#POKES32772,254;32775,136
#UDG32768(udg_fixed)
#POPS
</pre></div>
</div>
<p>This instance of the <tt class="docutils literal"><span class="pre">#POKES</span></tt> macro does <tt class="docutils literal"><span class="pre">POKE</span> <span class="pre">32772,254</span></tt> and
<tt class="docutils literal"><span class="pre">POKE</span> <span class="pre">32775,136</span></tt>, which fixes a graphic glitch in the UDG at 32768.</p>
<p>See also <a class="reference internal" href="#peek"><em>#PEEK</em></a>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>5.1</td>
<td>Added support for arithmetic expressions and skool macros in the
numeric parameters</td>
</tr>
<tr class="row-odd"><td>3.1</td>
<td>Added support for ASM mode</td>
</tr>
<tr class="row-even"><td>2.3.1</td>
<td>Added support for multiple addresses</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pops">
<span id="id29"></span><h3>#POPS<a class="headerlink" href="#pops" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#POPS</span></tt> macro removes the current memory snapshot and replaces it with
the one that was previously saved by a <tt class="docutils literal"><span class="pre">#PUSHS</span></tt> macro.</p>
<div class="highlight-none"><div class="highlight"><pre>#POPS
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>3.1</td>
<td>Added support for ASM mode</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="pushs">
<span id="id30"></span><h3>#PUSHS<a class="headerlink" href="#pushs" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">#PUSHS</span></tt> macro saves the current memory snapshot, and replaces it with an
identical copy with a given name.</p>
<div class="highlight-none"><div class="highlight"><pre>#PUSHS[name]
</pre></div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">name</span></tt> is the snapshot name (defaults to an empty string)</li>
</ul>
<p>The snapshot name must be limited to the characters &#8216;$&#8217;, &#8216;#&#8217;, 0-9, A-Z and a-z;
it must not start with a capital letter. The name can be retrieved by using the
<a class="reference internal" href="extending.html#skoolkit.skoolhtml.HtmlWriter.get_snapshot_name" title="skoolkit.skoolhtml.HtmlWriter.get_snapshot_name"><tt class="xref py py-meth docutils literal"><span class="pre">get_snapshot_name()</span></tt></a> method on HtmlWriter.</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Version</th>
<th class="head">Changes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>3.1</td>
<td>Added support for ASM mode</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="defining-macros-with-replace">
<span id="definingmacroswithreplace"></span><h2>Defining macros with &#64;replace<a class="headerlink" href="#defining-macros-with-replace" title="Permalink to this headline">¶</a></h2>
<p>By using the <a class="reference internal" href="asm.html#replace"><em>&#64;replace</em></a> directive, it is possible to define new macros
based on existing ones without writing any Python code. Some examples are given
below.</p>
<div class="section" id="asm">
<h3>#asm<a class="headerlink" href="#asm" title="Permalink to this headline">¶</a></h3>
<p>There is the <a class="reference internal" href="#html"><em>#HTML</em></a> macro for inserting content in HTML mode only, but
there is no corresponding macro for inserting content in ASM mode only. The
following <tt class="docutils literal"><span class="pre">&#64;replace</span></tt> directive defines an <tt class="docutils literal"><span class="pre">#asm</span></tt> macro to fill that gap:</p>
<div class="highlight-none"><div class="highlight"><pre>@replace=/#asm(\(.*\))/#IF({asm})\1
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-none"><div class="highlight"><pre>#asm(This text appears only in ASM mode.)
</pre></div>
</div>
</div>
<div class="section" id="tile">
<h3>#tile<a class="headerlink" href="#tile" title="Permalink to this headline">¶</a></h3>
<p>Suppose the game you&#8217;re disassembling arranges tiles in groups of nine bytes:
the attribute byte first, followed by the eight graphic bytes. If there is a
tile at 32768, then:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDG(32769,#PEEK32768)
</pre></div>
</div>
<p>will create an image of it. If you want to create several tile images, this
syntax can get cumbersome; it would be easier if you could supply just the
address of the attribute byte. The following <tt class="docutils literal"><span class="pre">&#64;replace</span></tt> directive defines a
<tt class="docutils literal"><span class="pre">#tile</span></tt> macro that creates a tile image given an attribute byte address:</p>
<div class="highlight-none"><div class="highlight"><pre>@replace=/#tile\i/#UDG(\1+1,#PEEK\1)
</pre></div>
</div>
<p>Now you can create an image of the tile at 32768 like this:</p>
<div class="highlight-none"><div class="highlight"><pre>#tile32768
</pre></div>
</div>
</div>
<div class="section" id="tiles">
<h3>#tiles<a class="headerlink" href="#tiles" title="Permalink to this headline">¶</a></h3>
<p>If you have several nine-byte tiles arranged one after the other, you might
want to create images of all of them in a single row of a <tt class="docutils literal"><span class="pre">#UDGTABLE</span></tt>. The
following <tt class="docutils literal"><span class="pre">&#64;replace</span></tt> directive defines a <tt class="docutils literal"><span class="pre">#tiles</span></tt> macro for this purpose:</p>
<div class="highlight-none"><div class="highlight"><pre>@replace=/#tiles\i,\i/#FOR(\1,\1+9*(\2-1),9);;n;#UDG(n+1,#PEEKn); | ;;
</pre></div>
</div>
<p>Now you can create a <tt class="docutils literal"><span class="pre">#UDGTABLE</span></tt> of images of a series of 10 tiles starting
at 32768 like this:</p>
<div class="highlight-none"><div class="highlight"><pre>#UDGTABLE { #tiles32768,10 } TABLE#
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Skool macros</a><ul>
<li><a class="reference internal" href="#syntax">Syntax</a></li>
<li><a class="reference internal" href="#numeric-parameters">Numeric parameters</a></li>
<li><a class="reference internal" href="#string-parameters">String parameters</a></li>
<li><a class="reference internal" href="#smpl-macros">SMPL macros</a><ul>
<li><a class="reference internal" href="#hash">#()</a></li>
<li><a class="reference internal" href="#eval">#EVAL</a></li>
<li><a class="reference internal" href="#for">#FOR</a></li>
<li><a class="reference internal" href="#foreach">#FOREACH</a></li>
<li><a class="reference internal" href="#if">#IF</a></li>
<li><a class="reference internal" href="#map">#MAP</a></li>
<li><a class="reference internal" href="#peek">#PEEK</a></li>
</ul>
</li>
<li><a class="reference internal" href="#general-macros">General macros</a><ul>
<li><a class="reference internal" href="#call">#CALL</a></li>
<li><a class="reference internal" href="#chr">#CHR</a></li>
<li><a class="reference internal" href="#d">#D</a></li>
<li><a class="reference internal" href="#html">#HTML</a></li>
<li><a class="reference internal" href="#include">#INCLUDE</a></li>
<li><a class="reference internal" href="#link">#LINK</a></li>
<li><a class="reference internal" href="#list">#LIST</a></li>
<li><a class="reference internal" href="#n">#N</a></li>
<li><a class="reference internal" href="#r">#R</a></li>
<li><a class="reference internal" href="#reg">#REG</a></li>
<li><a class="reference internal" href="#space">#SPACE</a></li>
<li><a class="reference internal" href="#table">#TABLE</a></li>
<li><a class="reference internal" href="#udgtable">#UDGTABLE</a></li>
<li><a class="reference internal" href="#version">#VERSION</a></li>
</ul>
</li>
<li><a class="reference internal" href="#image-macros">Image macros</a><ul>
<li><a class="reference internal" href="#font">#FONT</a></li>
<li><a class="reference internal" href="#scr">#SCR</a></li>
<li><a class="reference internal" href="#udg">#UDG</a></li>
<li><a class="reference internal" href="#udgarray">#UDGARRAY</a></li>
<li><a class="reference internal" href="#alt-text">Alt text</a></li>
<li><a class="reference internal" href="#animation">Animation</a></li>
<li><a class="reference internal" href="#cropping">Cropping</a></li>
<li><a class="reference internal" href="#masks">Masks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#snapshot-macros">Snapshot macros</a><ul>
<li><a class="reference internal" href="#pokes">#POKES</a></li>
<li><a class="reference internal" href="#pops">#POPS</a></li>
<li><a class="reference internal" href="#pushs">#PUSHS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#defining-macros-with-replace">Defining macros with &#64;replace</a><ul>
<li><a class="reference internal" href="#asm">#asm</a></li>
<li><a class="reference internal" href="#tile">#tile</a></li>
<li><a class="reference internal" href="#tiles">#tiles</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="skool-file-templates.html"
                        title="previous chapter">Skool file templates</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ref-files.html"
                        title="next chapter">Ref files</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/skool-macros.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ref-files.html" title="Ref files"
             >next</a> |</li>
        <li class="right" >
          <a href="skool-file-templates.html" title="Skool file templates"
             >previous</a> |</li>
        <li><a href="index.html">SkoolKit 6.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2017, Richard Dymond.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>